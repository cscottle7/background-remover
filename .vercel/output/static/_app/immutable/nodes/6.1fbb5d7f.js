import{s as Ee,f as h,a as O,u as ke,g as p,d as T,c as P,h as B,v as y,j as r,E as J,w as l,i as re,F as Q,H as Ie,o as Me,p as De,l as Ce,m as we,n as Te,A as le}from"../chunks/scheduler.f95f0c95.js";import{S as Se,i as Fe,t as ge,c as Re,a as fe,g as ze,b as pe,d as ve,m as me,e as be}from"../chunks/index.a7b2bf40.js";import{g as He}from"../chunks/globals.7f7f1b26.js";import{g as _e}from"../chunks/navigation.9fa37e41.js";import{R as Ue,a as Be}from"../chunks/RefineToolbox.bd88cd4f.js";const{document:he}=He;function Le(t){let o,s,n,E,u,f,k,a,R=t[0]?"‚óÄ":"‚ñ∂",M,m,z,b,g,_,C,S={originalImage:t[1],processedImage:t[2],currentTool:t[6],brushSize:t[7],showComparison:t[8],showOriginal:t[9],toolboxWidth:t[14]};return n=new Ue({props:S}),t[30](n),n.$on("initialized",t[28]),n.$on("error",t[27]),n.$on("historyChanged",t[22]),f=new Be({props:{currentTool:t[6],brushSize:t[7],canUndo:t[10],canRedo:t[11],isCollapsed:t[0]}}),f.$on("toolChanged",t[15]),f.$on("brushSizeChanged",t[16]),f.$on("collapseToggled",t[17]),f.$on("undo",t[19]),f.$on("redo",t[20]),f.$on("reset",t[21]),{c(){o=h("div"),s=h("div"),pe(n.$$.fragment),E=O(),u=h("aside"),pe(f.$$.fragment),k=O(),a=h("button"),M=Ce(R),this.h()},l(i){o=p(i,"DIV",{class:!0});var c=B(o);s=p(c,"DIV",{class:!0});var I=B(s);ve(n.$$.fragment,I),I.forEach(T),E=P(c),u=p(c,"ASIDE",{class:!0});var v=B(u);ve(f.$$.fragment,v),v.forEach(T),k=P(c),a=p(c,"BUTTON",{class:!0,title:!0});var U=B(a);M=we(U,R),U.forEach(T),c.forEach(T),this.h()},h(){r(s,"class","canvas-area svelte-7gdb56"),r(u,"class","toolbox-area svelte-7gdb56"),r(a,"class",m="collapse-toggle "+(t[0]?"collapsed":"")+" svelte-7gdb56"),r(a,"title",z=t[0]?"Show Tools":"Hide Tools"),r(o,"class",b="workspace "+(t[0]?"tools-collapsed":"tools-expanded")+" svelte-7gdb56")},m(i,c){re(i,o,c),l(o,s),me(n,s,null),l(o,E),l(o,u),me(f,u,null),l(o,k),l(o,a),l(a,M),g=!0,_||(C=Q(a,"click",t[18]),_=!0)},p(i,c){const I={};c[0]&2&&(I.originalImage=i[1]),c[0]&4&&(I.processedImage=i[2]),c[0]&64&&(I.currentTool=i[6]),c[0]&128&&(I.brushSize=i[7]),c[0]&256&&(I.showComparison=i[8]),c[0]&512&&(I.showOriginal=i[9]),c[0]&16384&&(I.toolboxWidth=i[14]),n.$set(I);const v={};c[0]&64&&(v.currentTool=i[6]),c[0]&128&&(v.brushSize=i[7]),c[0]&1024&&(v.canUndo=i[10]),c[0]&2048&&(v.canRedo=i[11]),c[0]&1&&(v.isCollapsed=i[0]),f.$set(v),(!g||c[0]&1)&&R!==(R=i[0]?"‚óÄ":"‚ñ∂")&&Te(M,R),(!g||c[0]&1&&m!==(m="collapse-toggle "+(i[0]?"collapsed":"")+" svelte-7gdb56"))&&r(a,"class",m),(!g||c[0]&1&&z!==(z=i[0]?"Show Tools":"Hide Tools"))&&r(a,"title",z),(!g||c[0]&1&&b!==(b="workspace "+(i[0]?"tools-collapsed":"tools-expanded")+" svelte-7gdb56"))&&r(o,"class",b)},i(i){g||(fe(n.$$.fragment,i),fe(f.$$.fragment,i),g=!0)},o(i){ge(n.$$.fragment,i),ge(f.$$.fragment,i),g=!1},d(i){i&&T(o),t[30](null),be(n),be(f),_=!1,C()}}}function Oe(t){let o,s,n="‚ö†Ô∏è",E,u,f="Test Error",k,a,R,M,m,z="Return to Main Page",b,g;return{c(){o=h("div"),s=h("div"),s.textContent=n,E=O(),u=h("h2"),u.textContent=f,k=O(),a=h("p"),R=Ce(t[4]),M=O(),m=h("button"),m.textContent=z,this.h()},l(_){o=p(_,"DIV",{class:!0});var C=B(o);s=p(C,"DIV",{class:!0,"data-svelte-h":!0}),y(s)!=="svelte-tecbtq"&&(s.textContent=n),E=P(C),u=p(C,"H2",{class:!0,"data-svelte-h":!0}),y(u)!=="svelte-1i9gb6y"&&(u.textContent=f),k=P(C),a=p(C,"P",{class:!0});var S=B(a);R=we(S,t[4]),S.forEach(T),M=P(C),m=p(C,"BUTTON",{class:!0,"data-svelte-h":!0}),y(m)!=="svelte-13rfp1f"&&(m.textContent=z),C.forEach(T),this.h()},h(){r(s,"class","error-icon svelte-7gdb56"),r(u,"class","error-title svelte-7gdb56"),r(a,"class","error-message svelte-7gdb56"),r(m,"class","error-retry-btn svelte-7gdb56"),r(o,"class","error-container svelte-7gdb56")},m(_,C){re(_,o,C),l(o,s),l(o,E),l(o,u),l(o,k),l(o,a),l(a,R),l(o,M),l(o,m),b||(g=Q(m,"click",t[29]),b=!0)},p(_,C){C[0]&16&&Te(R,_[4])},i:le,o:le,d(_){_&&T(o),b=!1,g()}}}function Pe(t){let o,s='<div class="loading-spinner svelte-7gdb56"></div> <p class="loading-text">Creating test images...</p>';return{c(){o=h("div"),o.innerHTML=s,this.h()},l(n){o=p(n,"DIV",{class:!0,"data-svelte-h":!0}),y(o)!=="svelte-v49ig8"&&(o.innerHTML=s),this.h()},h(){r(o,"class","loading-container svelte-7gdb56")},m(n,E){re(n,o,E)},p:le,i:le,o:le,d(n){n&&T(o)}}}function Ne(t){let o,s,n,E,u,f,k,a='<span class="breadcrumb-icon">‚Üê</span> <span class="breadcrumb-text">Back to Main</span>',R,M,m="Test Refine Image",z,b,g,_='<span class="view-icon">‚öñÔ∏è</span> <span class="view-text">Compare</span>',C,S,i='<span class="view-icon">üëÅÔ∏è</span> <span class="view-text">Original</span>',c,I,v,U,se,X,A,W,K='<span class="action-icon">‚úï</span> <span class="action-text">Cancel</span>',oe,L,j,ie="üíæ",ne,q,ce="Test Save",Z,N,e,w;const Y=[Pe,Oe,Le],D=[];function V(d,H){return d[3]?0:d[4]?1:2}return v=V(t),U=D[v]=Y[v](t),{c(){o=h("meta"),s=O(),n=h("div"),E=h("header"),u=h("div"),f=h("nav"),k=h("button"),k.innerHTML=a,R=O(),M=h("h1"),M.textContent=m,z=O(),b=h("div"),g=h("button"),g.innerHTML=_,C=O(),S=h("button"),S.innerHTML=i,c=O(),I=h("main"),U.c(),se=O(),X=h("footer"),A=h("div"),W=h("button"),W.innerHTML=K,oe=O(),L=h("button"),j=h("span"),j.textContent=ie,ne=O(),q=h("span"),q.textContent=ce,this.h()},l(d){const H=ke("svelte-1a2uugd",he.head);o=p(H,"META",{name:!0,content:!0}),H.forEach(T),s=P(d),n=p(d,"DIV",{class:!0});var F=B(n);E=p(F,"HEADER",{class:!0});var x=B(E);u=p(x,"DIV",{class:!0});var G=B(u);f=p(G,"NAV",{class:!0});var de=B(f);k=p(de,"BUTTON",{class:!0,"data-svelte-h":!0}),y(k)!=="svelte-24s13s"&&(k.innerHTML=a),de.forEach(T),R=P(G),M=p(G,"H1",{class:!0,"data-svelte-h":!0}),y(M)!=="svelte-1wp76ab"&&(M.textContent=m),z=P(G),b=p(G,"DIV",{class:!0});var $=B(b);g=p($,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),y(g)!=="svelte-sh0wz3"&&(g.innerHTML=_),C=P($),S=p($,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),y(S)!=="svelte-v5sg2j"&&(S.innerHTML=i),$.forEach(T),G.forEach(T),x.forEach(T),c=P(F),I=p(F,"MAIN",{class:!0});var ae=B(I);U.l(ae),ae.forEach(T),se=P(F),X=p(F,"FOOTER",{class:!0});var ee=B(X);A=p(ee,"DIV",{class:!0});var te=B(A);W=p(te,"BUTTON",{class:!0,"data-svelte-h":!0}),y(W)!=="svelte-1brmr41"&&(W.innerHTML=K),oe=P(te),L=p(te,"BUTTON",{class:!0});var ue=B(L);j=p(ue,"SPAN",{class:!0,"data-svelte-h":!0}),y(j)!=="svelte-kkg5zm"&&(j.textContent=ie),ne=P(ue),q=p(ue,"SPAN",{class:!0,"data-svelte-h":!0}),y(q)!=="svelte-1lcua1c"&&(q.textContent=ce),ue.forEach(T),te.forEach(T),ee.forEach(T),F.forEach(T),this.h()},h(){he.title="Test Refine Image - CharacterCut",r(o,"name","description"),r(o,"content","Test the new refine image components"),r(k,"class","breadcrumb-btn svelte-7gdb56"),r(f,"class","breadcrumb"),r(M,"class","page-title svelte-7gdb56"),r(g,"class","view-btn svelte-7gdb56"),r(g,"title","Compare original vs processed"),J(g,"active",t[8]),r(S,"class","view-btn svelte-7gdb56"),r(S,"title","Toggle original preview"),J(S,"active",t[9]),r(b,"class","view-controls svelte-7gdb56"),r(u,"class","header-content svelte-7gdb56"),r(E,"class","refine-header svelte-7gdb56"),r(I,"class","refine-main svelte-7gdb56"),r(W,"class","action-btn secondary svelte-7gdb56"),r(j,"class","action-icon"),r(q,"class","action-text"),r(L,"class","action-btn primary svelte-7gdb56"),L.disabled=Z=t[3]||!!t[4],r(A,"class","footer-content svelte-7gdb56"),r(X,"class","refine-footer svelte-7gdb56"),r(n,"class","refine-page svelte-7gdb56"),J(n,"mobile",t[12]),J(n,"desktop",t[13])},m(d,H){l(he.head,o),re(d,s,H),re(d,n,H),l(n,E),l(E,u),l(u,f),l(f,k),l(u,R),l(u,M),l(u,z),l(u,b),l(b,g),l(b,C),l(b,S),l(n,c),l(n,I),D[v].m(I,null),l(n,se),l(n,X),l(X,A),l(A,W),l(A,oe),l(A,L),l(L,j),l(L,ne),l(L,q),N=!0,e||(w=[Q(k,"click",t[26]),Q(g,"click",t[23]),Q(S,"click",t[24]),Q(W,"click",t[26]),Q(L,"click",t[25])],e=!0)},p(d,H){(!N||H[0]&256)&&J(g,"active",d[8]),(!N||H[0]&512)&&J(S,"active",d[9]);let F=v;v=V(d),v===F?D[v].p(d,H):(ze(),ge(D[F],1,1,()=>{D[F]=null}),Re(),U=D[v],U?U.p(d,H):(U=D[v]=Y[v](d),U.c()),fe(U,1),U.m(I,null)),(!N||H[0]&24&&Z!==(Z=d[3]||!!d[4]))&&(L.disabled=Z),(!N||H[0]&4096)&&J(n,"mobile",d[12]),(!N||H[0]&8192)&&J(n,"desktop",d[13])},i(d){N||(fe(U),N=!0)},o(d){ge(U),N=!1},d(d){d&&(T(s),T(n)),T(o),D[v].d(),e=!1,Ie(w)}}}function Ve(t,o,s){let n,E=null,u=null,f=!0,k=null,a,R="restore",M=20,m=!1,z=!1,b=!1,g=!1,_=!1,C=!1,S=!1;Me(async()=>{try{c(),window.addEventListener("resize",c),await i(),s(3,f=!1),console.log("‚úÖ Test refine page initialized")}catch(e){console.error("‚ùå Failed to initialize test refine page:",e),s(4,k=e instanceof Error?e.message:"Unknown error"),s(3,f=!1)}});async function i(){try{const e=new Image;e.crossOrigin="anonymous",await new Promise((F,x)=>{e.onload=F,e.onerror=x,e.src="/assets/icon-main-character.jpg"});const w=document.createElement("canvas");w.width=e.width,w.height=e.height,w.getContext("2d").drawImage(e,0,0),s(1,E=w.toDataURL());const D=document.createElement("canvas");D.width=e.width,D.height=e.height;const V=D.getContext("2d");V.drawImage(e,0,0);const d=V.getImageData(0,0,e.width,e.height),H=d.data;for(let F=0;F<H.length;F+=4){const x=F/4%e.width,G=Math.floor(F/4/e.width),de=e.width/2,$=e.height/2,ae=Math.sqrt((x-de)**2+(G-$)**2),ee=Math.min(e.width,e.height)/2;if(ae>ee*.7){const te=Math.max(0,1-(ae-ee*.7)/(ee*.3));H[F+3]=H[F+3]*te}}V.putImageData(d,0,0),s(2,u=D.toDataURL()),console.log("‚úÖ Loaded actual image:",e.width+"x"+e.height),console.log("üì∏ Original image data:",E.substring(0,50)+"..."),console.log("üì∏ Processed image data:",u.substring(0,50)+"...")}catch(e){console.warn("‚ö†Ô∏è Could not load actual image, creating simple mock:",e);const w=400,Y=document.createElement("canvas");Y.width=w,Y.height=w;const D=Y.getContext("2d");D.fillStyle="#87CEEB",D.fillRect(0,0,w,w),D.fillStyle="#FF6B6B",D.beginPath(),D.arc(w/2,w/2,80,0,2*Math.PI),D.fill(),s(1,E=Y.toDataURL());const V=document.createElement("canvas");V.width=w,V.height=w;const d=V.getContext("2d");d.fillStyle="#FF6B6B",d.beginPath(),d.arc(w/2,w/2,80,0,2*Math.PI),d.fill(),s(2,u=V.toDataURL())}}function c(){s(12,C=window.innerWidth<768),s(13,S=window.innerWidth>=1024),C&&!_&&s(0,_=!0)}function I(e){s(6,R=e.detail.tool),console.log("üîß Tool changed to:",R)}function v(e){s(7,M=e.detail.size),console.log("üñåÔ∏è Brush size changed to:",M)}function U(e){s(0,_=e.detail.collapsed)}function se(){s(0,_=!_),setTimeout(()=>{a&&window.dispatchEvent(new Event("resize"))},300),console.log("üîß Tools collapse toggled:",_?"collapsed":"expanded")}function X(){if(a){const e=a.undo();console.log("‚Ü∂ Undo:",e?"success":"failed"),K()}}function A(){if(a){const e=a.redo();console.log("‚Ü∑ Redo:",e?"success":"failed"),K()}}function W(){a&&(a.reset(),console.log("üîÑ Canvas reset"),K())}function K(){if(a){const e=a.getHistoryState();s(10,b=e.canUndo),s(11,g=e.canRedo),console.log("üìù History state updated:",{canUndo:b,canRedo:g})}else s(10,b=!1),s(11,g=!1)}function oe(e){s(10,b=e.detail.canUndo),s(11,g=e.detail.canRedo),console.log("üìù History changed:",e.detail)}function L(){if(s(8,m=!m),s(9,z=!1),a){const e=m?"comparison":"processed";a.setViewMode(e)}console.log("üîÑ Comparison mode:",m)}function j(){if(s(9,z=!z),s(8,m=!1),a){const e=z?"original":"processed";a.setViewMode(e)}console.log("üîÑ Original preview:",z)}function ie(){if(!a){console.error("‚ùå Canvas component not available");return}try{const e=a.exportProcessedImage();if(!e){console.error("‚ùå No processed image data available");return}const w=document.createElement("a");w.download="refined-character.png",w.href=e,w.click(),console.log("‚úÖ Image saved successfully")}catch(e){console.error("‚ùå Save failed:",e)}}function ne(){_e("/")}function q(e){s(4,k=e.detail.message),console.error("‚ùå Canvas error:",k)}function ce(){K(),console.log("‚úÖ Canvas initialized successfully")}const Z=()=>_e("/");function N(e){De[e?"unshift":"push"](()=>{a=e,s(5,a)})}return t.$$.update=()=>{t.$$.dirty[0]&1&&s(14,n=_?0:250)},[_,E,u,f,k,a,R,M,m,z,b,g,C,S,n,I,v,U,se,X,A,W,oe,L,j,ie,ne,q,ce,Z,N]}class Xe extends Se{constructor(o){super(),Fe(this,o,Ve,Ne,Ee,{},null,[-1,-1])}}export{Xe as component};
