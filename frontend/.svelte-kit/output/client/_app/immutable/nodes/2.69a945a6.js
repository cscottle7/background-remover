var Xo=Object.defineProperty;var $o=(s,e,t)=>e in s?Xo(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Le=(s,e,t)=>($o(s,typeof e!="symbol"?e+"":e,t),t);import{A as Ce,s as nt,r as en,C as Ws,f as g,a as I,g as p,h as v,c as x,d as f,j as c,k as ne,D as yi,E as be,i as q,w as n,F as ce,G as Lt,x as tn,y as sn,z as rn,H as Qe,I as wi,J as zt,K as Mr,L as an,p as Fs,l as N,m as z,n as de,B as ze,o as Ut,M as Te,v as Z,N as Me,O as on,P as wr,Q as Vs,e as ot,R as gs,S as nn,u as ln}from"../chunks/scheduler.64c0ae6a.js";import{S as lt,i as ct,a as Se,t as Fe,b as ht,d as vt,m as bt,e as _t,c as kr,g as Er}from"../chunks/index.5f42ba5d.js";import{a as Ae,b as cn}from"../chunks/appState.a823ac89.js";import{d as Ya,w as Rr}from"../chunks/index.675a9ea6.js";const Wo=typeof window<"u";let un=Wo?()=>window.performance.now():()=>Date.now(),Yo=Wo?s=>requestAnimationFrame(s):Ce;const As=new Set;function Ko(s){As.forEach(e=>{e.c(s)||(As.delete(e),e.f())}),As.size!==0&&Yo(Ko)}function dn(s){let e;return As.size===0&&Yo(Ko),{promise:new Promise(t=>{As.add(e={c:s,f:t})}),abort(){As.delete(e)}}}function Je(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function fn(s,e){const t={},r={},a={$$scope:1};let i=s.length;for(;i--;){const o=s[i],u=e[i];if(u){for(const l in o)l in u||(r[l]=1);for(const l in u)a[l]||(t[l]=u[l],a[l]=1);s[i]=u}else for(const l in o)a[l]=1}for(const o in r)o in t||(t[o]=void 0);return t}function Bs(s,e,t,r){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function u(m){try{d(r.next(m))}catch(h){o(h)}}function l(m){try{d(r.throw(m))}catch(h){o(h)}}function d(m){m.done?i(m.value):a(m.value).then(u,l)}d((r=r.apply(s,e||[])).next())})}function Os(s,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,a,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=u(0),o.throw=u(1),o.return=u(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(d){return function(m){return l([d,m])}}function l(d){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(t=0)),t;)try{if(r=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,a=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){t.label=d[1];break}if(d[0]===6&&t.label<i[1]){t.label=i[1],i=d;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(d);break}i[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(s,t)}catch(m){d=[6,m],a=0}finally{r=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function ki(s,e){var t=typeof Symbol=="function"&&s[Symbol.iterator];if(!t)return s;var r=t.call(s),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=r.next()).done;)i.push(a.value)}catch(u){o={error:u}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return i}function Ei(s,e,t){if(t||arguments.length===2)for(var r=0,a=e.length,i;r<a;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return s.concat(i||Array.prototype.slice.call(e))}var mn=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function Ys(s,e){var t=gn(s);if(typeof t.path!="string"){var r=s.webkitRelativePath;Object.defineProperty(t,"path",{value:typeof e=="string"?e:typeof r=="string"&&r.length>0?r:s.name,writable:!1,configurable:!1,enumerable:!0})}return t}function gn(s){var e=s.name,t=e&&e.lastIndexOf(".")!==-1;if(t&&!s.type){var r=e.split(".").pop().toLowerCase(),a=mn.get(r);a&&Object.defineProperty(s,"type",{value:a,writable:!1,configurable:!1,enumerable:!0})}return s}var pn=[".DS_Store","Thumbs.db"];function hn(s){return Bs(this,void 0,void 0,function(){return Os(this,function(e){return Sr(s)&&vn(s.dataTransfer)?[2,wn(s.dataTransfer,s.type)]:bn(s)?[2,_n(s)]:Array.isArray(s)&&s.every(function(t){return"getFile"in t&&typeof t.getFile=="function"})?[2,yn(s)]:[2,[]]})})}function vn(s){return Sr(s)}function bn(s){return Sr(s)&&Sr(s.target)}function Sr(s){return typeof s=="object"&&s!==null}function _n(s){return ja(s.target.files).map(function(e){return Ys(e)})}function yn(s){return Bs(this,void 0,void 0,function(){var e;return Os(this,function(t){switch(t.label){case 0:return[4,Promise.all(s.map(function(r){return r.getFile()}))];case 1:return e=t.sent(),[2,e.map(function(r){return Ys(r)})]}})})}function wn(s,e){return Bs(this,void 0,void 0,function(){var t,r;return Os(this,function(a){switch(a.label){case 0:return s.items?(t=ja(s.items).filter(function(i){return i.kind==="file"}),e!=="drop"?[2,t]:[4,Promise.all(t.map(kn))]):[3,2];case 1:return r=a.sent(),[2,Di(Jo(r))];case 2:return[2,Di(ja(s.files).map(function(i){return Ys(i)}))]}})})}function Di(s){return s.filter(function(e){return pn.indexOf(e.name)===-1})}function ja(s){if(s===null)return[];for(var e=[],t=0;t<s.length;t++){var r=s[t];e.push(r)}return e}function kn(s){if(typeof s.webkitGetAsEntry!="function")return Ci(s);var e=s.webkitGetAsEntry();return e&&e.isDirectory?Qo(e):Ci(s)}function Jo(s){return s.reduce(function(e,t){return Ei(Ei([],ki(e),!1),ki(Array.isArray(t)?Jo(t):[t]),!1)},[])}function Ci(s){var e=s.getAsFile();if(!e)return Promise.reject("".concat(s," is not a File"));var t=Ys(e);return Promise.resolve(t)}function En(s){return Bs(this,void 0,void 0,function(){return Os(this,function(e){return[2,s.isDirectory?Qo(s):Dn(s)]})})}function Qo(s){var e=s.createReader();return new Promise(function(t,r){var a=[];function i(){var o=this;e.readEntries(function(u){return Bs(o,void 0,void 0,function(){var l,d,m;return Os(this,function(h){switch(h.label){case 0:if(u.length)return[3,5];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,Promise.all(a)];case 2:return l=h.sent(),t(l),[3,4];case 3:return d=h.sent(),r(d),[3,4];case 4:return[3,6];case 5:m=Promise.all(u.map(En)),a.push(m),i(),h.label=6;case 6:return[2]}})})},function(u){r(u)})}i()})}function Dn(s){return Bs(this,void 0,void 0,function(){return Os(this,function(e){return[2,new Promise(function(t,r){s.file(function(a){var i=Ys(a,s.fullPath);t(i)},function(a){r(a)})})]})})}function Cn(s,e){if(s&&e){const t=Array.isArray(e)?e:e.split(","),r=s.name||"",a=(s.type||"").toLowerCase(),i=a.replace(/\/.*$/,"");return t.some(o=>{const u=o.trim().toLowerCase();return u.charAt(0)==="."?r.toLowerCase().endsWith(u):u.endsWith("/*")?i===u.replace(/\/.*$/,""):a===u})}return!0}const In="file-invalid-type",xn="file-too-large",Sn="file-too-small",Pn="too-many-files",Tn=s=>{s=Array.isArray(s)&&s.length===1?s[0]:s;const e=Array.isArray(s)?`one of ${s.join(", ")}`:s;return{code:In,message:`File type must be ${e}`}},Ii=s=>({code:xn,message:`File is larger than ${s} bytes`}),xi=s=>({code:Sn,message:`File is smaller than ${s} bytes`}),Mn={code:Pn,message:"Too many files"};function Rn(s,e){const t=s.type==="application/x-moz-file"||Cn(s,e);return[t,t?null:Tn(e)]}function An(s,e,t){if(Hs(s.size))if(Hs(e)&&Hs(t)){if(s.size>t)return[!1,Ii(t)];if(s.size<e)return[!1,xi(e)]}else{if(Hs(e)&&s.size<e)return[!1,xi(e)];if(Hs(t)&&s.size>t)return[!1,Ii(t)]}return[!0,null]}function Hs(s){return s!=null}function Si(s){return typeof s.isPropagationStopped=="function"?s.isPropagationStopped():typeof s.cancelBubble<"u"?s.cancelBubble:!1}function Dr(s){return s.dataTransfer?Array.prototype.some.call(s.dataTransfer.types,e=>e==="Files"||e==="application/x-moz-file"):!!s.target&&!!s.target.files}function Fn(s){return s.indexOf("MSIE")!==-1||s.indexOf("Trident/")!==-1}function Vn(s){return s.indexOf("Edge/")!==-1}function Bn(s=window.navigator.userAgent){return Fn(s)||Vn(s)}function On(s){let e,t;return{c(){e=g("p"),t=N(s[10])},l(r){e=p(r,"P",{});var a=v(e);t=z(a,s[10]),a.forEach(f)},m(r,a){q(r,e,a),n(e,t)},p(r,a){a[0]&1024&&de(t,r[10])},d(r){r&&f(e)}}}function jn(s){let e,t,r,a,i,o,u,l;const d=s[35].default,m=en(d,s,s[34],null),h=m||On(s);let b=[{tabindex:"0"},{role:"button"},{class:i=(s[5]?"":"dropzone")+" "+s[3]},{style:s[4]},s[24]],_={};for(let w=0;w<b.length;w+=1)_=Ws(_,b[w]);return{c(){e=g("div"),t=g("input"),a=I(),h&&h.c(),this.h()},l(w){e=p(w,"DIV",{tabindex:!0,role:!0,class:!0,style:!0});var y=v(e);t=p(y,"INPUT",{accept:!0,type:!0,name:!0,autocomplete:!0,tabindex:!0,style:!0}),a=x(y),h&&h.l(y),y.forEach(f),this.h()},h(){var w;c(t,"accept",r=(w=s[1])==null?void 0:w.toString()),t.multiple=s[2],t.required=s[7],c(t,"type","file"),c(t,"name",s[6]),c(t,"autocomplete","off"),c(t,"tabindex","-1"),ne(t,"display","none"),yi(e,_),be(e,"svelte-817dg2",!0)},m(w,y){q(w,e,y),n(e,t),s[36](t),n(e,a),h&&h.m(e,null),s[37](e),o=!0,u||(l=[ce(window,"focus",s[23]),ce(window,"dragover",s[21]),ce(window,"drop",s[22]),ce(t,"change",s[20]),ce(t,"click",Ln),ce(e,"keydown",function(){Lt(s[12](s[13]))&&s[12](s[13]).apply(this,arguments)}),ce(e,"focus",function(){Lt(s[12](s[14]))&&s[12](s[14]).apply(this,arguments)}),ce(e,"blur",function(){Lt(s[12](s[15]))&&s[12](s[15]).apply(this,arguments)}),ce(e,"click",function(){Lt(s[8](s[16]))&&s[8](s[16]).apply(this,arguments)}),ce(e,"dragenter",function(){Lt(s[11](s[17]))&&s[11](s[17]).apply(this,arguments)}),ce(e,"dragover",function(){Lt(s[11](s[18]))&&s[11](s[18]).apply(this,arguments)}),ce(e,"dragleave",function(){Lt(s[11](s[19]))&&s[11](s[19]).apply(this,arguments)}),ce(e,"drop",function(){Lt(s[11](s[20]))&&s[11](s[20]).apply(this,arguments)})],u=!0)},p(w,y){var T;s=w,(!o||y[0]&2&&r!==(r=(T=s[1])==null?void 0:T.toString()))&&c(t,"accept",r),(!o||y[0]&4)&&(t.multiple=s[2]),(!o||y[0]&128)&&(t.required=s[7]),(!o||y[0]&64)&&c(t,"name",s[6]),m?m.p&&(!o||y[1]&8)&&tn(m,d,s,s[34],o?rn(d,s[34],y,null):sn(s[34]),null):h&&h.p&&(!o||y[0]&1024)&&h.p(s,o?y:[-1,-1]),yi(e,_=fn(b,[{tabindex:"0"},{role:"button"},(!o||y[0]&40&&i!==(i=(s[5]?"":"dropzone")+" "+s[3]))&&{class:i},(!o||y[0]&16)&&{style:s[4]},y[0]&16777216&&s[24]])),be(e,"svelte-817dg2",!0)},i(w){o||(Se(h,w),o=!0)},o(w){Fe(h,w),o=!1},d(w){w&&f(e),s[36](null),h&&h.d(w),s[37](null),u=!1,Qe(l)}}}function Ln(s){s.stopPropagation()}function Nn(s,e,t){let r,a,i,o;const u=["accept","disabled","getFilesFromEvent","maxSize","minSize","multiple","preventDropOnDocument","noClick","noKeyboard","noDrag","noDragEventsBubbling","containerClasses","containerStyles","disableDefaultStyles","name","inputElement","required"];let l=wi(e,u),{$$slots:d={},$$scope:m}=e,{accept:h=void 0}=e,{disabled:b=!1}=e,{getFilesFromEvent:_=hn}=e,{maxSize:w=1/0}=e,{minSize:y=0}=e,{multiple:T=!0}=e,{preventDropOnDocument:M=!0}=e,{noClick:E=!1}=e,{noKeyboard:A=!1}=e,{noDrag:V=!1}=e,{noDragEventsBubbling:F=!1}=e,{containerClasses:W=""}=e,{containerStyles:R=""}=e,{disableDefaultStyles:D=!1}=e,{name:S=""}=e,{inputElement:k=void 0}=e,{required:L=!1}=e;const B=zt();let P={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]},C;function H(){P.isFileDialogActive=!1,P.isDragActive=!1,P.draggedFiles=[],P.acceptedFiles=[],P.fileRejections=[]}function ee(){k&&(t(0,k.value=null,k),P.isFileDialogActive=!0,k.click())}function re(j){!C||!C.isEqualNode(j.target)||(j.keyCode===32||j.keyCode===13)&&(j.preventDefault(),ee())}function Y(){P.isFocused=!0}function X(){P.isFocused=!1}function U(){E||(Bn()?setTimeout(ee,0):ee())}function J(j){j.preventDefault(),O(j),$=[...$,j.target],Dr(j)&&Promise.resolve(_(j)).then(_e=>{Si(j)&&!F||(P.draggedFiles=_e,P.isDragActive=!0,B("dragenter",{dragEvent:j}))})}function Q(j){if(j.preventDefault(),O(j),j.dataTransfer)try{j.dataTransfer.dropEffect="copy"}catch{}return Dr(j)&&B("dragover",{dragEvent:j}),!1}function K(j){j.preventDefault(),O(j);const _e=$.filter(Ee=>C&&C.contains(Ee)),Ie=_e.indexOf(j.target);Ie!==-1&&_e.splice(Ie,1),$=_e,!(_e.length>0)&&(P.isDragActive=!1,P.draggedFiles=[],Dr(j)&&B("dragleave",{dragEvent:j}))}function G(j){j.preventDefault(),O(j),$=[],Dr(j)&&(B("filedropped",{event:j}),Promise.resolve(_(j)).then(_e=>{if(Si(j)&&!F)return;const Ie=[],Ee=[];_e.forEach(ye=>{const[Ge,Ye]=Rn(ye,h),[Re,He]=An(ye,y,w);if(Ge&&Re)Ie.push(ye);else{const xe=[Ye,He].filter(he=>he);Ee.push({file:ye,errors:xe})}}),!T&&Ie.length>1&&(Ie.forEach(ye=>{Ee.push({file:ye,errors:[Mn]})}),Ie.splice(0)),j.dataTransfer&&t(0,k.files=j.dataTransfer.files,k),P.acceptedFiles=Ie,P.fileRejections=Ee,B("drop",{acceptedFiles:Ie,fileRejections:Ee,event:j}),Ee.length>0&&B("droprejected",{fileRejections:Ee,event:j}),Ie.length>0&&B("dropaccepted",{acceptedFiles:Ie,event:j})})),H()}function O(j){F&&j.stopPropagation()}function te(j){M&&j.preventDefault()}let $=[];function ae(j){M&&(C&&C.contains(j.target)||(j.preventDefault(),$=[]))}function se(){P.isFileDialogActive&&setTimeout(()=>{if(k){const{files:j}=k;j.length||(P.isFileDialogActive=!1,B("filedialogcancel"))}},300)}Mr(()=>{t(0,k=null)});function ie(j){Fs[j?"unshift":"push"](()=>{k=j,t(0,k)})}function ge(j){Fs[j?"unshift":"push"](()=>{C=j,t(9,C)})}return s.$$set=j=>{e=Ws(Ws({},e),an(j)),t(24,l=wi(e,u)),"accept"in j&&t(1,h=j.accept),"disabled"in j&&t(25,b=j.disabled),"getFilesFromEvent"in j&&t(26,_=j.getFilesFromEvent),"maxSize"in j&&t(27,w=j.maxSize),"minSize"in j&&t(28,y=j.minSize),"multiple"in j&&t(2,T=j.multiple),"preventDropOnDocument"in j&&t(29,M=j.preventDropOnDocument),"noClick"in j&&t(30,E=j.noClick),"noKeyboard"in j&&t(31,A=j.noKeyboard),"noDrag"in j&&t(32,V=j.noDrag),"noDragEventsBubbling"in j&&t(33,F=j.noDragEventsBubbling),"containerClasses"in j&&t(3,W=j.containerClasses),"containerStyles"in j&&t(4,R=j.containerStyles),"disableDefaultStyles"in j&&t(5,D=j.disableDefaultStyles),"name"in j&&t(6,S=j.name),"inputElement"in j&&t(0,k=j.inputElement),"required"in j&&t(7,L=j.required),"$$scope"in j&&t(34,m=j.$$scope)},s.$$.update=()=>{s.$$.dirty[0]&33554432&&t(8,r=j=>b?null:j),s.$$.dirty[0]&256|s.$$.dirty[1]&1&&t(12,a=j=>A?null:r(j)),s.$$.dirty[0]&256|s.$$.dirty[1]&2&&t(11,i=j=>V?null:r(j)),s.$$.dirty[0]&4&&t(10,o=T?"Drag 'n' drop some files here, or click to select files":"Drag 'n' drop a file here, or click to select a file")},[k,h,T,W,R,D,S,L,r,C,o,i,a,re,Y,X,U,J,Q,K,G,te,ae,se,l,b,_,w,y,M,E,A,V,F,m,d,ie,ge]}class zn extends lt{constructor(e){super(),ct(this,e,Nn,jn,nt,{accept:1,disabled:25,getFilesFromEvent:26,maxSize:27,minSize:28,multiple:2,preventDropOnDocument:29,noClick:30,noKeyboard:31,noDrag:32,noDragEventsBubbling:33,containerClasses:3,containerStyles:4,disableDefaultStyles:5,name:6,inputElement:0,required:7},null,[-1,-1])}}const qe=Rr({currentState:"idle",inputMethod:"none",isDragActive:!1,isClipboardReady:!1,errorMessage:null,successMessage:null,canAcceptInput:!0,showPasteHint:!0}),Un=Ya(qe,s=>({isIdle:s.currentState==="idle",isActive:s.currentState==="active"||s.isDragActive,isProcessing:s.currentState==="processing",hasError:s.currentState==="error",hasSuccess:s.currentState==="success",showDropZone:s.canAcceptInput&&["idle","hover","active"].includes(s.currentState)})),qs=Rr({dragEvents:0,pasteEvents:0,uploadEvents:0,successfulInputs:0,failedInputs:0,averageInputTime:0}),Hn=[{from:"idle",to:"hover",trigger:"DRAG_ENTER"},{from:"idle",to:"active",trigger:"PASTE_READY",method:"paste"},{from:"idle",to:"active",trigger:"UPLOAD_CLICK",method:"upload"},{from:"idle",to:"processing",trigger:"FILE_SELECTED"},{from:"hover",to:"idle",trigger:"DRAG_LEAVE"},{from:"hover",to:"active",trigger:"DRAG_OVER"},{from:"hover",to:"processing",trigger:"DROP",method:"drop"},{from:"active",to:"idle",trigger:"CANCEL"},{from:"active",to:"processing",trigger:"FILE_SELECTED"},{from:"active",to:"hover",trigger:"DRAG_LEAVE"},{from:"processing",to:"success",trigger:"PROCESS_COMPLETE"},{from:"processing",to:"error",trigger:"PROCESS_ERROR"},{from:"success",to:"idle",trigger:"RESET"},{from:"success",to:"processing",trigger:"PROCESS_ANOTHER"},{from:"error",to:"idle",trigger:"RESET"},{from:"error",to:"processing",trigger:"RETRY"}],me={transition(s,e,t){qe.update(r=>{const a=Hn.find(o=>o.from===r.currentState&&o.trigger===s);if(!a)return console.warn(`Invalid transition: ${r.currentState} -> ${s}`),r;const i={...r,currentState:a.to,inputMethod:a.method||e||r.inputMethod,errorMessage:a.to!=="error"?null:r.errorMessage,successMessage:a.to!=="success"?null:r.successMessage,...t};return console.log(`Input state: ${r.currentState} -> ${i.currentState} (${s})`),i})},dragEnter(){me.transition("DRAG_ENTER"),qe.update(s=>({...s,isDragActive:!0}))},dragLeave(){me.transition("DRAG_LEAVE"),qe.update(s=>({...s,isDragActive:!1}))},dragOver(){me.transition("DRAG_OVER")},drop(s){s.length!==0&&(me.transition("DROP","drop"),qe.update(e=>({...e,isDragActive:!1,canAcceptInput:!1})),qs.update(e=>({...e,dragEvents:e.dragEvents+1})))},pasteReady(){me.transition("PASTE_READY","paste")},paste(){me.transition("FILE_SELECTED","paste"),qe.update(s=>({...s,canAcceptInput:!1})),qs.update(s=>({...s,pasteEvents:s.pasteEvents+1}))},uploadClick(){me.transition("UPLOAD_CLICK","upload")},uploadSelected(s){me.transition("FILE_SELECTED","upload"),qe.update(e=>({...e,canAcceptInput:!1})),qs.update(e=>({...e,uploadEvents:e.uploadEvents+1}))},startProcessing(){me.transition("PROCESS_COMPLETE")},completeProcessing(s="Processing complete!"){me.transition("PROCESS_COMPLETE"),qe.update(e=>({...e,successMessage:s,canAcceptInput:!0})),qs.update(e=>({...e,successfulInputs:e.successfulInputs+1}))},errorProcessing(s){me.transition("PROCESS_ERROR"),qe.update(e=>({...e,errorMessage:s,canAcceptInput:!0})),qs.update(e=>({...e,failedInputs:e.failedInputs+1}))},reset(){me.transition("RESET"),qe.update(s=>({...s,inputMethod:"none",isDragActive:!1,errorMessage:null,successMessage:null,canAcceptInput:!0}))},processAnother(){me.transition("PROCESS_ANOTHER"),qe.update(s=>({...s,inputMethod:"none",isDragActive:!1,errorMessage:null,successMessage:null,canAcceptInput:!0}))},retry(){me.transition("RETRY"),qe.update(s=>({...s,errorMessage:null,canAcceptInput:!0}))},setClipboardReady(s){qe.update(e=>({...e,isClipboardReady:s,showPasteHint:s}))},validateInput(s){const t=["image/jpeg","image/png","image/webp","image/bmp","image/tiff"];return s.size>10485760?{valid:!1,error:"File size too large (max 10MB)"}:t.includes(s.type.toLowerCase())?{valid:!0}:{valid:!1,error:"Unsupported file type"}}};if(typeof window<"u"){const s=!!(navigator.clipboard&&navigator.clipboard.read);me.setClipboardReady(s)}const ls=class ls{constructor(){}static getInstance(){return ls.instance||(ls.instance=new ls),ls.instance}isSupported(){return!!(navigator.clipboard&&navigator.clipboard.read&&typeof navigator.clipboard.read=="function")}async readImage(){try{if(!this.isSupported())return{success:!1,error:"Clipboard API not supported in this browser"};if(!await this.requestPermission())return{success:!1,error:"Clipboard permission denied"};const t=await navigator.clipboard.read();if(!t||t.length===0)return{success:!1,error:"No items found in clipboard"};for(const r of t){const a=r.types.filter(u=>u.startsWith("image/"));if(a.length===0)continue;const i=a[0],o=await r.getType(i);if(o&&o.size>0)return{success:!0,file:new File([o],`clipboard-image.${this.getExtensionFromMimeType(i)}`,{type:i})}}return{success:!1,error:"No valid images found in clipboard"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to read clipboard"}}}async requestPermission(){try{if(!navigator.permissions)return!0;const e=await navigator.permissions.query({name:"clipboard-read"});return e.state==="granted"||e.state==="prompt"}catch{return!0}}async copyImage(e){try{if(!navigator.clipboard||!navigator.clipboard.write)return!1;const t=new ClipboardItem({[e.type]:e});return await navigator.clipboard.write([t]),!0}catch(t){return console.warn("Failed to copy image to clipboard:",t),!1}}setupKeyboardListener(e){const t=async r=>{if(!((r.metaKey||r.ctrlKey)&&r.key==="v"))return;const i=r.target;if(i.tagName==="INPUT"||i.tagName==="TEXTAREA"||i.isContentEditable)return;r.preventDefault();const o=await this.readImage();o.success&&o.file&&e(o.file)};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}}getExtensionFromMimeType(e){return{"image/jpeg":"jpg","image/jpg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[e.toLowerCase()]||"png"}getCapabilities(){return{read:!!(navigator.clipboard&&navigator.clipboard.read),write:!!(navigator.clipboard&&navigator.clipboard.write),readText:!!(navigator.clipboard&&navigator.clipboard.readText),writeText:!!(navigator.clipboard&&navigator.clipboard.writeText),permissions:!!navigator.permissions}}};Le(ls,"instance");let La=ls;const Na=La.getInstance();class qn{constructor(){Le(this,"testResults",null)}async runFullCompatibilityTest(){console.log("Starting comprehensive browser compatibility test...");const e=this.detectBrowser(),t=this.detectCapabilities(),r={browser:e.name+" "+e.version,timestamp:new Date().toISOString(),overallCompatibility:"poor",score:0,capabilities:{browser:e.name,version:e.version,...t},tests:{clipboardTests:await this.testClipboardFunctionality(),dragDropTests:await this.testDragDropFunctionality(),imageProcessingTests:await this.testImageProcessing()},recommendations:[],fallbacksNeeded:[]};return r.score=this.calculateCompatibilityScore(r),r.overallCompatibility=this.determineCompatibilityLevel(r.score),r.recommendations=this.generateRecommendations(r),r.fallbacksNeeded=this.identifyFallbacksNeeded(r),this.testResults=r,console.log("Browser compatibility test completed:",r),r}async testClipboardFunctionality(){const e={basicSupport:!1,readPermission:!1,writePermission:!1,imageHandling:!1,keyboardShortcuts:!1,crossOrigin:!1,errors:[]};try{if(e.basicSupport=!!navigator.clipboard,e.basicSupport){try{if(navigator.permissions){const t=await navigator.permissions.query({name:"clipboard-read"});e.readPermission=t.state!=="denied";const r=await navigator.permissions.query({name:"clipboard-write"});e.writePermission=r.state!=="denied"}else e.readPermission=!0,e.writePermission=!0}catch(t){e.errors.push(`Permission query failed: ${t}`),e.readPermission=!0,e.writePermission=!0}try{const t=document.createElement("canvas");t.width=100,t.height=100;const r=t.getContext("2d");r&&(r.fillStyle="red",r.fillRect(0,0,100,100),t.toBlob(async a=>{if(a)try{const i=new ClipboardItem({[a.type]:a});await navigator.clipboard.write([i]),e.imageHandling=!0}catch(i){e.errors.push(`Image clipboard write failed: ${i}`)}}))}catch(t){e.errors.push(`Image handling test failed: ${t}`)}e.keyboardShortcuts=this.testKeyboardEventHandling()}else e.errors.push("Clipboard API not supported");e.crossOrigin=window.location.protocol==="https:"||window.location.hostname==="localhost"}catch(t){e.errors.push(`Clipboard test failed: ${t}`)}return e}async testDragDropFunctionality(){const e={basicDragDrop:!1,fileHandling:!1,multipleFiles:!1,imageTypes:!1,visualFeedback:!1,errors:[]};try{const t=document.createElement("div");e.basicDragDrop="ondragstart"in t&&"ondrop"in t&&"ondragover"in t,e.basicDragDrop?(e.fileHandling=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),typeof DataTransfer<"u"?(e.multipleFiles=!0,e.imageTypes=this.testImageTypeSupport(),e.visualFeedback=this.testDragVisualFeedback()):e.errors.push("DataTransfer API not supported")):e.errors.push("Basic drag and drop not supported")}catch(t){e.errors.push(`Drag and drop test failed: ${t}`)}return e}async testImageProcessing(){const e={canvasManipulation:!1,blobProcessing:!1,fileReaderAPI:!1,imageFormats:[],performanceOK:!1,errors:[]};try{const t=document.createElement("canvas"),r=t.getContext("2d");e.canvasManipulation=!!(t&&r),e.blobProcessing=!!(window.Blob&&URL.createObjectURL),e.fileReaderAPI=!!window.FileReader,e.imageFormats=await this.testImageFormats(),e.performanceOK=await this.testImageProcessingPerformance()}catch(t){e.errors.push(`Image processing test failed: ${t}`)}return e}detectBrowser(){const e=navigator.userAgent;if(e.includes("Chrome")&&!e.includes("Edg")){const t=e.match(/Chrome\/(\d+)/);return{name:"Chrome",version:t?t[1]:"unknown"}}if(e.includes("Firefox")){const t=e.match(/Firefox\/(\d+)/);return{name:"Firefox",version:t?t[1]:"unknown"}}if(e.includes("Safari")&&!e.includes("Chrome")){const t=e.match(/Version\/(\d+)/);return{name:"Safari",version:t?t[1]:"unknown"}}if(e.includes("Edg")){const t=e.match(/Edg\/(\d+)/);return{name:"Edge",version:t?t[1]:"unknown"}}return{name:"Unknown",version:"unknown"}}detectCapabilities(){return{clipboardAPI:{read:!!(navigator.clipboard&&navigator.clipboard.read),write:!!(navigator.clipboard&&navigator.clipboard.write),readText:!!(navigator.clipboard&&navigator.clipboard.readText),writeText:!!(navigator.clipboard&&navigator.clipboard.writeText),permissions:!!navigator.permissions},dragAndDrop:{supported:"ondragstart"in document.createElement("div"),fileAPI:!!(window.File&&window.FileReader&&window.FileList&&window.Blob),dataTransfer:typeof DataTransfer<"u",dragEvents:"ondragenter"in document.createElement("div")},imageProcessing:{canvas:!!document.createElement("canvas").getContext,blob:!!window.Blob,fileReader:!!window.FileReader,createObjectURL:!!(URL&&URL.createObjectURL)},modernFeatures:{asyncAwait:this.testAsyncAwait(),modules:"noModule"in document.createElement("script"),fetch:!!window.fetch,promises:!!window.Promise},performance:{performanceAPI:!!window.performance,webWorkers:!!window.Worker,offscreenCanvas:!!window.OffscreenCanvas}}}testAsyncAwait(){try{return new Function("return (async () => {})")(),!0}catch{return!1}}testKeyboardEventHandling(){try{return new KeyboardEvent("keydown",{key:"v",ctrlKey:!0})instanceof KeyboardEvent}catch{return!1}}testImageTypeSupport(){return["image/jpeg","image/png","image/gif","image/webp","image/bmp"].length>0}testDragVisualFeedback(){return"dropEffect"in document.createElement("div").style}async testImageFormats(){const e=["jpeg","png","webp","gif"],t=[];for(const r of e)try{const a=document.createElement("canvas");a.width=1,a.height=1,a.toDataURL(`image/${r}`).startsWith(`data:image/${r}`)&&t.push(r)}catch{}return t}async testImageProcessingPerformance(){try{const e=performance.now(),t=document.createElement("canvas");t.width=500,t.height=500;const r=t.getContext("2d");if(!r)return!1;for(let o=0;o<100;o++)r.fillStyle=`rgb(${o*2}, 100, 150)`,r.fillRect(o,o,100,100);return performance.now()-e<100}catch{return!1}}calculateCompatibilityScore(e){let t=0;const r={clipboard:30,dragDrop:25,imageProcessing:25,modernFeatures:20},a=e.tests.clipboardTests,i=((a.basicSupport?1:0)+(a.readPermission?1:0)+(a.writePermission?1:0)+(a.imageHandling?1:0)+(a.keyboardShortcuts?1:0))/5;t+=i*r.clipboard;const o=e.tests.dragDropTests,u=((o.basicDragDrop?1:0)+(o.fileHandling?1:0)+(o.multipleFiles?1:0)+(o.imageTypes?1:0)+(o.visualFeedback?1:0))/5;t+=u*r.dragDrop;const l=e.tests.imageProcessingTests,d=((l.canvasManipulation?1:0)+(l.blobProcessing?1:0)+(l.fileReaderAPI?1:0)+(l.imageFormats.length>2?1:0)+(l.performanceOK?1:0))/5;t+=d*r.imageProcessing;const m=e.capabilities.modernFeatures,h=((m.asyncAwait?1:0)+(m.modules?1:0)+(m.fetch?1:0)+(m.promises?1:0))/4;return t+=h*r.modernFeatures,Math.round(t)}determineCompatibilityLevel(e){return e>=90?"excellent":e>=75?"good":e>=50?"limited":"poor"}generateRecommendations(e){const t=[],{capabilities:r,tests:a}=e;return a.clipboardTests.basicSupport||t.push("Implement drag-and-drop as primary input method due to limited clipboard support"),a.clipboardTests.imageHandling||t.push("Provide visual feedback for clipboard operations due to limited image handling"),a.dragDropTests.basicDragDrop||t.push("Implement file upload button as fallback for drag-and-drop"),a.dragDropTests.visualFeedback||t.push("Add custom visual feedback for drag operations"),a.imageProcessingTests.performanceOK||t.push("Consider client-side image optimization before processing"),r.browser==="Safari"&&t.push("Test clipboard functionality thoroughly in Safari due to stricter security policies"),r.browser==="Firefox"&&t.push("Implement additional clipboard permission handling for Firefox"),t}identifyFallbacksNeeded(e){const t=[],{tests:r}=e;return r.clipboardTests.basicSupport||t.push("File upload button for clipboard-unsupported browsers"),r.clipboardTests.keyboardShortcuts||t.push("Visual paste button for keyboard shortcut issues"),r.dragDropTests.basicDragDrop||t.push("Traditional file input element"),r.imageProcessingTests.canvasManipulation||t.push("Server-side image processing for canvas-limited browsers"),t}getLatestResults(){return this.testResults}exportResults(){return this.testResults?JSON.stringify(this.testResults,null,2):"No test results available"}}const Gn=new qn,cs=class cs{constructor(){Le(this,"compatibilityResult",null);Le(this,"fallbackStrategies",null);Le(this,"config",{clipboardFallback:!0,dragDropFallback:!0,performanceFallback:!0,formatFallback:!0,notificationFallback:!0})}static getInstance(){return cs.instance||(cs.instance=new cs),cs.instance}async initialize(){this.compatibilityResult=await Gn.runFullCompatibilityTest(),this.fallbackStrategies=this.generateFallbackStrategies(),console.log("Graceful degradation initialized:",{compatibility:this.compatibilityResult.overallCompatibility,score:this.compatibilityResult.score,fallbacks:this.fallbackStrategies})}getClipboardFallback(){return this.fallbackStrategies?this.fallbackStrategies.clipboard:this.getDefaultClipboardFallback()}getDragDropFallback(){return this.fallbackStrategies?this.fallbackStrategies.dragDrop:this.getDefaultDragDropFallback()}getImageProcessingFallback(){return this.fallbackStrategies?this.fallbackStrategies.imageProcessing:this.getDefaultImageProcessingFallback()}isClipboardSupported(){if(!this.compatibilityResult)return!1;const e=this.compatibilityResult.tests.clipboardTests;return e.basicSupport&&e.imageHandling}isDragDropSupported(){if(!this.compatibilityResult)return!1;const e=this.compatibilityResult.tests.dragDropTests;return e.basicDragDrop&&e.fileHandling}getCompatibilityMessage(){if(!this.compatibilityResult)return"Checking browser compatibility...";const{overallCompatibility:e,score:t}=this.compatibilityResult;switch(e){case"excellent":return"All features supported! You can use drag-and-drop, clipboard paste, and all shortcuts.";case"good":return"Most features supported! Some advanced features may have fallbacks.";case"limited":return"Basic features supported. Some functionality will use alternative methods.";case"poor":return"Limited browser support detected. Using compatibility mode for best experience.";default:return"Browser compatibility unknown."}}generateFallbackStrategies(){if(!this.compatibilityResult)return this.getDefaultFallbackStrategies();const{tests:e,capabilities:t}=this.compatibilityResult;return{clipboard:this.generateClipboardFallback(e.clipboardTests,t.browser),dragDrop:this.generateDragDropFallback(e.dragDropTests,t.browser),imageProcessing:this.generateImageProcessingFallback(e.imageProcessingTests),notifications:this.generateNotificationFallback(t.browser)}}generateClipboardFallback(e,t){return e.basicSupport&&e.imageHandling?{strategy:"manual-upload",showPasteButton:!0,showInstructions:!1,manualUploadPrompt:"Paste or upload your image"}:e.basicSupport?{strategy:"show-instructions",showPasteButton:!0,showInstructions:!0,manualUploadPrompt:"Your browser supports text paste. For images, please use the upload button."}:{strategy:"manual-upload",showPasteButton:!1,showInstructions:!0,manualUploadPrompt:"Please use the upload button to select your image file."}}generateDragDropFallback(e,t){return e.basicDragDrop&&e.fileHandling?{strategy:"enhanced-upload",showUploadButton:!0,showDropZone:!0,visualEnhancements:e.visualFeedback}:e.basicDragDrop?{strategy:"file-input",showUploadButton:!0,showDropZone:!0,visualEnhancements:!1}:{strategy:"file-input",showUploadButton:!0,showDropZone:!1,visualEnhancements:!1}}generateImageProcessingFallback(e){const t=e.imageFormats||["jpeg","png"];return e.canvasManipulation&&e.performanceOK?{strategy:"compress-client",maxFileSize:10*1024*1024,supportedFormats:t,compressionQuality:.8}:e.canvasManipulation?{strategy:"format-conversion",maxFileSize:5*1024*1024,supportedFormats:t,compressionQuality:.9}:{strategy:"server-processing",maxFileSize:10*1024*1024,supportedFormats:["jpeg","png"],compressionQuality:1}}generateNotificationFallback(e){return e==="Safari"||e==="Unknown"?{strategy:"modal",duration:4e3,position:"center"}:{strategy:"toast",duration:3e3,position:"top"}}getDefaultFallbackStrategies(){return{clipboard:this.getDefaultClipboardFallback(),dragDrop:this.getDefaultDragDropFallback(),imageProcessing:this.getDefaultImageProcessingFallback(),notifications:{strategy:"toast",duration:3e3,position:"top"}}}getDefaultClipboardFallback(){return{strategy:"manual-upload",showPasteButton:!0,showInstructions:!1,manualUploadPrompt:"Upload or paste your image"}}getDefaultDragDropFallback(){return{strategy:"enhanced-upload",showUploadButton:!0,showDropZone:!0,visualEnhancements:!0}}getDefaultImageProcessingFallback(){return{strategy:"compress-client",maxFileSize:10*1024*1024,supportedFormats:["jpeg","png","webp"],compressionQuality:.8}}async handleClipboardFallback(){switch(this.getClipboardFallback().strategy){case"manual-upload":return this.promptForFileUpload();case"show-instructions":return this.showClipboardInstructions(),null;case"disable-feature":return null;default:return this.promptForFileUpload()}}handleDragDropFallback(e){switch(this.getDragDropFallback().strategy){case"enhanced-upload":return this.processFilesWithEnhancements(e);case"file-input":return this.processFilesBasic(e);case"disable-feature":return Promise.resolve([]);default:return this.processFilesBasic(e)}}promptForFileUpload(){return new Promise(e=>{const t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=r=>{var o;const i=((o=r.target.files)==null?void 0:o[0])||null;e(i)},t.click()})}showClipboardInstructions(){console.log("Clipboard paste not fully supported. Please use the upload button.")}async processFilesWithEnhancements(e){const t=this.getImageProcessingFallback(),r=[];for(let a=0;a<e.length;a++){const i=e[a];if(i.size>t.maxFileSize){console.warn(`File ${i.name} exceeds size limit`);continue}const o=i.type.replace("image/","");if(!t.supportedFormats.includes(o)){console.warn(`File format ${o} not supported`);continue}r.push(i)}return r}async processFilesBasic(e){return Array.from(e).filter(t=>t.type.startsWith("image/")&&t.size<=10*1024*1024)}getCompatibilityScore(){var e;return((e=this.compatibilityResult)==null?void 0:e.score)||0}getBrowserInfo(){return this.compatibilityResult?{name:this.compatibilityResult.capabilities.browser,version:this.compatibilityResult.capabilities.version}:{name:"Unknown",version:"unknown"}}shouldShowFeature(e){if(!this.compatibilityResult)return!0;const t=this.compatibilityResult.score;switch(e){case"clipboard":return t>=50;case"dragdrop":return t>=30;case"advanced":return t>=75;default:return!0}}getComponentConfig(e){if(!this.fallbackStrategies)return{};switch(e){case"input":return{showPasteButton:this.fallbackStrategies.clipboard.showPasteButton,showDropZone:this.fallbackStrategies.dragDrop.showDropZone,showUploadButton:this.fallbackStrategies.dragDrop.showUploadButton,showInstructions:this.fallbackStrategies.clipboard.showInstructions};case"processor":return{compressionQuality:this.fallbackStrategies.imageProcessing.compressionQuality,maxFileSize:this.fallbackStrategies.imageProcessing.maxFileSize};case"download":return{supportedFormats:this.fallbackStrategies.imageProcessing.supportedFormats};default:return{}}}};Le(cs,"instance");let za=cs;const ns=za.getInstance(),Pi=10*1024*1024,Cr=4096,Ir=32,Wn=new Set(["image/jpeg","image/jpg","image/png","image/webp","image/bmp","image/tiff"]);async function Yn(s){const e=[],t=[];try{s.size>Pi&&e.push(`File size (${Ti(s.size)}) exceeds maximum allowed size of ${Ti(Pi)}`),Wn.has(s.type.toLowerCase())||e.push(`Unsupported file type: ${s.type}. Supported formats: JPEG, PNG, WebP, BMP, TIFF`);const r=await Jn(s);if(!r.valid)return e.push("Invalid or corrupted image file"),{isValid:!1,error:e.join(". ")};const{width:a,height:i}=r;(a<Ir||i<Ir)&&e.push(`Image dimensions (${a}×${i}) are too small. Minimum: ${Ir}×${Ir}px`),(a>Cr||i>Cr)&&e.push(`Image dimensions (${a}×${i}) are too large. Maximum: ${Cr}×${Cr}px`),a*i>2048*2048&&t.push("Large images may take longer to process");const u=a/i;return(u>10||u<.1)&&t.push("Unusual aspect ratio may affect processing quality"),await Xn(s)&&t.push("Animated images will be processed as static images"),{isValid:e.length===0,error:e.length>0?e.join(". "):void 0,warnings:t.length>0?t:void 0}}catch(r){return{isValid:!1,error:`Validation failed: ${r instanceof Error?r.message:"Unknown error"}`}}}async function Kn(s){const e=await Zn(s),t=await Qn(s);return{file:s,preview:e,size:s.size,dimensions:t,format:s.type}}function Jn(s){return new Promise(e=>{const t=new Image;t.onload=()=>{e({valid:!0,width:t.naturalWidth,height:t.naturalHeight})},t.onerror=()=>{e({valid:!1,width:0,height:0})},t.src=URL.createObjectURL(s)})}function Qn(s){return new Promise((e,t)=>{const r=new Image;r.onload=()=>{e({width:r.naturalWidth,height:r.naturalHeight}),URL.revokeObjectURL(r.src)},r.onerror=()=>{t(new Error("Failed to load image")),URL.revokeObjectURL(r.src)},r.src=URL.createObjectURL(s)})}function Zn(s){return new Promise((e,t)=>{const r=new FileReader;r.onload=a=>{var i;e((i=a.target)==null?void 0:i.result)},r.onerror=()=>{t(new Error("Failed to create image preview"))},r.readAsDataURL(s)})}async function Xn(s){try{if(s.type==="image/gif"){const e=await s.arrayBuffer(),t=new Uint8Array(e);let r=0;for(let a=0;a<t.length-1;a++)if(t[a]===33&&t[a+1]===249&&(r++,r>1))return!0}return!1}catch{return!1}}function Ti(s){const e=["B","KB","MB","GB"];let t=s,r=0;for(;t>=1024&&r<e.length-1;)t/=1024,r++;return`${t.toFixed(1)} ${e[r]}`}function $n(s){const e=s.size>5242880,t=s.type==="image/jpeg";return{shouldCompress:e&&t,quality:e?.8:.9}}async function el(s){const e=$n(s);if(!e.shouldCompress)return s;try{const t=document.createElement("canvas"),r=t.getContext("2d"),a=new Image;return new Promise((i,o)=>{a.onload=()=>{t.width=a.naturalWidth,t.height=a.naturalHeight,r==null||r.drawImage(a,0,0),t.toBlob(u=>{if(u){const l=new File([u],s.name,{type:"image/jpeg",lastModified:Date.now()});i(l)}else i(s)},"image/jpeg",e.quality)},a.onerror=()=>i(s),a.src=URL.createObjectURL(s)})}catch{return s}}function Mi(s){let e,t,r,a,i,o;return{c(){e=g("button"),t=Te("svg"),r=Te("path"),a=N(`
              Paste`),this.h()},l(u){e=p(u,"BUTTON",{class:!0});var l=v(e);t=Me(l,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var d=v(t);r=Me(d,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(r).forEach(f),d.forEach(f),a=z(l,`
              Paste`),l.forEach(f),this.h()},h(){c(r,"stroke-linecap","round"),c(r,"stroke-linejoin","round"),c(r,"stroke-width","2"),c(r,"d","M9 5H7a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"),c(t,"class","w-5 h-5 mr-2"),c(t,"fill","none"),c(t,"stroke","currentColor"),c(t,"viewBox","0 0 24 24"),c(e,"class","btn btn-outline border-magic-400 text-magic-400 hover:bg-magic-400 hover:text-white flex-1 py-3 px-6 rounded-lg font-medium transition-all duration-200"),e.disabled=s[0]},m(u,l){q(u,e,l),n(e,t),n(t,r),n(e,a),i||(o=ce(e,"click",s[17]),i=!0)},p(u,l){l&1&&(e.disabled=u[0])},d(u){u&&f(e),i=!1,o()}}}function Ri(s){let e;return{c(){e=N("Drag & drop,")},l(t){e=z(t,"Drag & drop,")},m(t,r){q(t,e,r)},d(t){t&&f(e)}}}function Ai(s){let e,t,r="⌘",a,i,o="V";return{c(){e=N(`, or 
              `),t=g("kbd"),t.textContent=r,a=I(),i=g("kbd"),i.textContent=o,this.h()},l(u){e=z(u,`, or 
              `),t=p(u,"KBD",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-s3feji"&&(t.textContent=r),a=x(u),i=p(u,"KBD",{class:!0,"data-svelte-h":!0}),Z(i)!=="svelte-1qj8pkc"&&(i.textContent=o),this.h()},h(){c(t,"class","kbd kbd-xs bg-dark-elevated text-magic-400 svelte-1yokvc6"),c(i,"class","kbd kbd-xs bg-dark-elevated text-magic-400 svelte-1yokvc6")},m(u,l){q(u,e,l),q(u,t,l),q(u,a,l),q(u,i,l)},d(u){u&&(f(e),f(t),f(a),f(i))}}}function Fi(s){let e,t,r="Browser Compatibility Note",a,i,o=ns.getCompatibilityMessage()+"",u;return{c(){e=g("div"),t=g("p"),t.textContent=r,a=I(),i=g("p"),u=N(o),this.h()},l(l){e=p(l,"DIV",{class:!0});var d=v(e);t=p(d,"P",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-14statl"&&(t.textContent=r),a=x(d),i=p(d,"P",{class:!0});var m=v(i);u=z(m,o),m.forEach(f),d.forEach(f),this.h()},h(){c(t,"class","text-blue-400 text-xs font-medium mb-1"),c(i,"class","text-blue-300 text-xs"),c(e,"class","mt-3 p-3 bg-blue-400/10 border border-blue-400/30 rounded-lg")},m(l,d){q(l,e,d),n(e,t),n(e,a),n(e,i),n(i,u)},d(l){l&&f(e)}}}function Vi(s){let e,t='<div class="text-center"><div class="w-16 h-16 mx-auto mb-4 rounded-full bg-magic-400/20 flex items-center justify-center"><svg class="w-8 h-8 text-magic-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg></div> <p class="text-xl font-semibold text-magic-400">Drop to process</p> <p class="text-magic-300">Release to start the magic</p></div>';return{c(){e=g("div"),e.innerHTML=t,this.h()},l(r){e=p(r,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1rgb4wq"&&(e.innerHTML=t),this.h()},h(){c(e,"class","absolute inset-0 bg-magic-400/20 border-2 border-magic-400 rounded-lg flex items-center justify-center z-20")},m(r,a){q(r,e,a)},d(r){r&&f(e)}}}function tl(s){let e,t,r,a,i,o='<svg class="w-12 h-12 text-magic-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>',u,l,d='<h2 class="text-2xl font-semibold text-magic-gradient mb-2">Place Character Here</h2> <p class="text-dark-text-secondary text-lg">Watch backgrounds disappear like magic</p>',m,h,b,_,w,y,T,M,E,A,V,F,W,R="Supports JPEG, PNG, WebP • Max 10MB • Up to 4K resolution",D,S,k,L,B,P=s[3].showPasteButton&&s[5]&&Mi(s),C=s[3].showDropZone&&Ri(),H=s[3].showPasteButton&&s[5]&&s[1]&&Ai(),ee=s[3].showInstructions&&Fi(),re=s[6]&&Vi();return{c(){e=g("div"),t=g("div"),r=I(),a=g("div"),i=g("div"),i.innerHTML=o,u=I(),l=g("div"),l.innerHTML=d,m=I(),h=g("div"),b=g("button"),_=Te("svg"),w=Te("path"),y=N(`
            Choose Image`),T=I(),P&&P.c(),M=I(),E=g("div"),A=g("p"),C&&C.c(),V=N(`
            choose file`),H&&H.c(),F=I(),W=g("p"),W.textContent=R,D=I(),ee&&ee.c(),S=I(),re&&re.c(),this.h()},l(Y){e=p(Y,"DIV",{class:!0});var X=v(e);t=p(X,"DIV",{class:!0}),v(t).forEach(f),r=x(X),a=p(X,"DIV",{class:!0});var U=v(a);i=p(U,"DIV",{class:!0,"data-svelte-h":!0}),Z(i)!=="svelte-zpjsso"&&(i.innerHTML=o),u=x(U),l=p(U,"DIV",{class:!0,"data-svelte-h":!0}),Z(l)!=="svelte-1noa2ng"&&(l.innerHTML=d),m=x(U),h=p(U,"DIV",{class:!0});var J=v(h);b=p(J,"BUTTON",{class:!0});var Q=v(b);_=Me(Q,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var K=v(_);w=Me(K,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(w).forEach(f),K.forEach(f),y=z(Q,`
            Choose Image`),Q.forEach(f),T=x(J),P&&P.l(J),J.forEach(f),M=x(U),E=p(U,"DIV",{class:!0});var G=v(E);A=p(G,"P",{});var O=v(A);C&&C.l(O),V=z(O,`
            choose file`),H&&H.l(O),O.forEach(f),F=x(G),W=p(G,"P",{class:!0,"data-svelte-h":!0}),Z(W)!=="svelte-oom6db"&&(W.textContent=R),D=x(G),ee&&ee.l(G),G.forEach(f),U.forEach(f),S=x(X),re&&re.l(X),X.forEach(f),this.h()},h(){c(t,"class","character-guide absolute inset-0 pointer-events-none opacity-20 svelte-1yokvc6"),c(i,"class","w-24 h-24 rounded-full bg-magic-400/10 flex items-center justify-center"),c(l,"class","text-center"),c(w,"stroke-linecap","round"),c(w,"stroke-linejoin","round"),c(w,"stroke-width","2"),c(w,"d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"),c(_,"class","w-5 h-5 mr-2"),c(_,"fill","none"),c(_,"stroke","currentColor"),c(_,"viewBox","0 0 24 24"),c(b,"class","btn btn-magic flex-1 py-3 px-6 rounded-lg font-medium transition-all duration-200"),b.disabled=s[0],c(h,"class","flex flex-col sm:flex-row gap-4 w-full max-w-md"),c(W,"class","opacity-75"),c(E,"class","text-center text-sm text-dark-text-muted space-y-1"),c(a,"class","flex flex-col items-center justify-center space-y-6 relative z-10"),c(e,"class",k="dropzone "+(s[6]?"dropzone-active":"")+" "+(s[0]?"opacity-50 cursor-not-allowed":"cursor-pointer")+" svelte-1yokvc6"),be(e,"animate-pulse-glow",s[6])},m(Y,X){q(Y,e,X),n(e,t),n(e,r),n(e,a),n(a,i),n(a,u),n(a,l),n(a,m),n(a,h),n(h,b),n(b,_),n(_,w),n(b,y),n(h,T),P&&P.m(h,null),n(a,M),n(a,E),n(E,A),C&&C.m(A,null),n(A,V),H&&H.m(A,null),n(E,F),n(E,W),n(E,D),ee&&ee.m(E,null),n(e,S),re&&re.m(e,null),L||(B=ce(b,"click",s[13]),L=!0)},p(Y,X){X&1&&(b.disabled=Y[0]),Y[3].showPasteButton&&Y[5]?P?P.p(Y,X):(P=Mi(Y),P.c(),P.m(h,null)):P&&(P.d(1),P=null),Y[3].showDropZone?C||(C=Ri(),C.c(),C.m(A,V)):C&&(C.d(1),C=null),Y[3].showPasteButton&&Y[5]&&Y[1]?H||(H=Ai(),H.c(),H.m(A,null)):H&&(H.d(1),H=null),Y[3].showInstructions?ee||(ee=Fi(),ee.c(),ee.m(E,null)):ee&&(ee.d(1),ee=null),Y[6]?re||(re=Vi(),re.c(),re.m(e,null)):re&&(re.d(1),re=null),X&65&&k!==(k="dropzone "+(Y[6]?"dropzone-active":"")+" "+(Y[0]?"opacity-50 cursor-not-allowed":"cursor-pointer")+" svelte-1yokvc6")&&c(e,"class",k),X&65&&be(e,"animate-pulse-glow",Y[6])},d(Y){Y&&f(e),P&&P.d(),C&&C.d(),H&&H.d(),ee&&ee.d(),re&&re.d(),L=!1,B()}}}function sl(s){let e,t,r,a,i,o,u;return a=new zn({props:{accept:"image/*",multiple:!1,disableDefaultStyles:!0,containerClasses:"dropzone-container",disabled:s[0]||!s[2].canAcceptInput,noClick:!0,$$slots:{default:[tl]},$$scope:{ctx:s}}}),a.$on("drop",s[10]),a.$on("dragenter",s[7]),a.$on("dragleave",s[8]),a.$on("dragover",s[9]),{c(){e=g("div"),t=g("input"),r=I(),ht(a.$$.fragment),this.h()},l(l){e=p(l,"DIV",{class:!0});var d=v(e);t=p(d,"INPUT",{type:!0,accept:!0,class:!0}),r=x(d),vt(a.$$.fragment,d),d.forEach(f),this.h()},h(){c(t,"type","file"),c(t,"accept","image/jpeg,image/jpg,image/png,image/webp,image/bmp,image/tiff"),c(t,"class","hidden"),t.disabled=s[0],c(e,"class","unified-input-container svelte-1yokvc6")},m(l,d){q(l,e,d),n(e,t),s[16](t),n(e,r),bt(a,e,null),i=!0,o||(u=ce(t,"change",s[11]),o=!0)},p(l,[d]){(!i||d&1)&&(t.disabled=l[0]);const m={};d&5&&(m.disabled=l[0]||!l[2].canAcceptInput),d&4194411&&(m.$$scope={dirty:d,ctx:l}),a.$set(m)},i(l){i||(Se(a.$$.fragment,l),i=!0)},o(l){Fe(a.$$.fragment,l),i=!1},d(l){l&&f(e),s[16](null),_t(a),o=!1,u()}}}function rl(s,e,t){let r,a,i,o,u;ze(s,Un,D=>t(14,o=D)),ze(s,qe,D=>t(15,u=D));let{disabled:l=!1}=e,{showPasteHint:d=!0}=e;const m=zt();let h={showPasteButton:!0,showDropZone:!0,showInstructions:!1},b,_=null;Ut(async()=>{await ns.initialize(),t(3,h=ns.getComponentConfig("input"));const D=ns.isClipboardSupported();me.setClipboardReady(D),Ae.setClipboardSupported(D),D&&(_=Na.setupKeyboardListener(V))}),Mr(()=>{_&&_()});async function w(D){if(l||D.length===0)return;const S=D[0];try{const k=await Yn(S);if(!k.isValid){m("error",{message:k.error||"Invalid image file"});return}k.warnings&&k.warnings.length>0&&console.warn("Image validation warnings:",k.warnings);const L=await el(S),B=await Kn(L);Ae.setCurrentImage(B),m("imageSelected",{image:B})}catch(k){const L=k instanceof Error?k.message:"Failed to process image";m("error",{message:L})}}function y(){!l&&r.canAcceptInput&&(me.dragEnter(),Ae.setDropzoneActive(!0))}function T(){l||(me.dragLeave(),Ae.setDropzoneActive(!1))}function M(){!l&&r.canAcceptInput&&me.dragOver()}async function E(D){if(!l&&D.detail.acceptedFiles.length>0){me.drop(D.detail.acceptedFiles),Ae.setDropzoneActive(!1);const S=D.detail.acceptedFiles,k=await ns.handleDragDropFallback(S);k.length>0?w(k):m("error",{message:"No supported files found in drop"})}else me.dragLeave(),Ae.setDropzoneActive(!1)}function A(){b.files&&b.files.length>0&&(me.uploadSelected(b.files[0]),w(b.files),t(4,b.value="",b))}async function V(D){if(!(l||!r.canAcceptInput))try{let S=null;if(D)S=D;else if(ns.isClipboardSupported()){me.pasteReady();const k=await Na.readImage();if(!k.success){me.errorProcessing(k.error||"Failed to read clipboard"),m("error",{message:k.error||"Failed to read clipboard"});return}S=k.file}else S=await ns.handleClipboardFallback();S&&(me.paste(),await w([S]))}catch(S){const k=S instanceof Error?S.message:"Failed to paste image";me.errorProcessing(k),m("error",{message:k})}}function F(){!l&&r.canAcceptInput&&(me.uploadClick(),b.click())}function W(D){Fs[D?"unshift":"push"](()=>{b=D,t(4,b)})}const R=()=>V();return s.$$set=D=>{"disabled"in D&&t(0,l=D.disabled),"showPasteHint"in D&&t(1,d=D.showPasteHint)},s.$$.update=()=>{s.$$.dirty&32768&&t(2,r=u),s.$$.dirty&16384,s.$$.dirty&4&&t(6,a=r.isDragActive),s.$$.dirty&4&&t(5,i=r.isClipboardReady)},[l,d,r,h,b,i,a,y,T,M,E,A,V,F,o,u,W,R]}class al extends lt{constructor(e){super(),ct(this,e,rl,sl,nt,{disabled:0,showPasteHint:1})}}function Bi(s){return Object.prototype.toString.call(s)==="[object Date]"}function Pr(s){const e=s-1;return e*e*e+1}function il(s){return Math.sin(-13*(s+1)*Math.PI/2)*Math.pow(2,-10*s)+1}function Nt(s){return--s*s*s*s*s+1}function Ua(s,e){if(s===e||s!==s)return()=>s;const t=typeof s;if(t!==typeof e||Array.isArray(s)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(s)){const r=e.map((a,i)=>Ua(s[i],a));return a=>r.map(i=>i(a))}if(t==="object"){if(!s||!e)throw new Error("Object cannot be null");if(Bi(s)&&Bi(e)){s=s.getTime(),e=e.getTime();const i=e-s;return o=>new Date(s+o*i)}const r=Object.keys(e),a={};return r.forEach(i=>{a[i]=Ua(s[i],e[i])}),i=>{const o={};return r.forEach(u=>{o[u]=a[u](i)}),o}}if(t==="number"){const r=e-s;return a=>s+a*r}throw new Error(`Cannot interpolate ${t} values`)}function We(s,e={}){const t=Rr(s);let r,a=s;function i(o,u){if(s==null)return t.set(s=o),Promise.resolve();a=o;let l=r,d=!1,{delay:m=0,duration:h=400,easing:b=on,interpolate:_=Ua}=Ws(Ws({},e),u);if(h===0)return l&&(l.abort(),l=null),t.set(s=a),Promise.resolve();const w=un()+m;let y;return r=dn(T=>{if(T<w)return!0;d||(y=_(s,o),typeof h=="function"&&(h=h(s,o)),d=!0),l&&(l.abort(),l=null);const M=T-w;return M>h?(t.set(s=o),!1):(t.set(s=y(b(M/h))),!0)}),r.promise}return{set:i,update:(o,u)=>i(o(a,s),u),subscribe:t.subscribe}}function Oi(s){let e,t,r,a,i,o,u,l=Math.round(s[1])+"",d,m,h,b,_,w,y,T,M='<div class="w-2 h-2 rounded-full bg-magic-400 animate-pulse svelte-1c664co"></div> <span class="text-xs text-dark-text-muted">Magic scanline active...</span>';return{c(){e=g("div"),t=g("div"),r=g("div"),a=g("span"),i=N(s[2]),o=I(),u=g("span"),d=N(l),m=N("%"),h=I(),b=g("div"),_=g("div"),w=g("div"),y=I(),T=g("div"),T.innerHTML=M,this.h()},l(E){e=p(E,"DIV",{class:!0});var A=v(e);t=p(A,"DIV",{class:!0});var V=v(t);r=p(V,"DIV",{class:!0});var F=v(r);a=p(F,"SPAN",{class:!0});var W=v(a);i=z(W,s[2]),W.forEach(f),o=x(F),u=p(F,"SPAN",{class:!0});var R=v(u);d=z(R,l),m=z(R,"%"),R.forEach(f),F.forEach(f),h=x(V),b=p(V,"DIV",{class:!0});var D=v(b);_=p(D,"DIV",{class:!0,style:!0});var S=v(_);w=p(S,"DIV",{class:!0}),v(w).forEach(f),S.forEach(f),D.forEach(f),y=x(V),T=p(V,"DIV",{class:!0,"data-svelte-h":!0}),Z(T)!=="svelte-55sbsw"&&(T.innerHTML=M),V.forEach(f),A.forEach(f),this.h()},h(){c(a,"class","text-sm text-magic-400 font-medium"),c(u,"class","text-xs text-dark-text-secondary"),c(r,"class","flex items-center justify-between mb-2"),c(w,"class","h-full w-full bg-white/20 animate-pulse svelte-1c664co"),c(_,"class","h-full bg-gradient-to-r from-magic-400 to-magic-300 transition-all duration-500 ease-out"),ne(_,"width",s[1]+"%"),c(b,"class","h-1 bg-dark-base rounded-full overflow-hidden"),c(T,"class","mt-2 flex items-center space-x-2"),c(t,"class","bg-dark-elevated/90 backdrop-blur-sm rounded-lg px-4 py-3 border border-magic-400/20"),c(e,"class","absolute bottom-4 left-4 right-4 z-30")},m(E,A){q(E,e,A),n(e,t),n(t,r),n(r,a),n(a,i),n(r,o),n(r,u),n(u,d),n(u,m),n(t,h),n(t,b),n(b,_),n(_,w),n(t,y),n(t,T)},p(E,A){A[0]&4&&de(i,E[2]),A[0]&2&&l!==(l=Math.round(E[1])+"")&&de(d,l),A[0]&2&&ne(_,"width",E[1]+"%")},d(E){E&&f(e)}}}function ji(s){let e;return{c(){e=g("div"),this.h()},l(t){e=p(t,"DIV",{class:!0,style:!0}),v(e).forEach(f),this.h()},h(){c(e,"class","absolute inset-0 pointer-events-none z-5"),ne(e,"background","radial-gradient(circle at center, rgba(0, 255, 136, "+s[5]*.1+") 0%, transparent 70%)"),ne(e,"box-shadow","inset 0 0 100px rgba(0, 255, 136, "+s[5]*.2+")")},m(t,r){q(t,e,r)},p(t,r){r[0]&32&&ne(e,"background","radial-gradient(circle at center, rgba(0, 255, 136, "+t[5]*.1+") 0%, transparent 70%)"),r[0]&32&&ne(e,"box-shadow","inset 0 0 100px rgba(0, 255, 136, "+t[5]*.2+")")},d(t){t&&f(e)}}}function ol(s){let e,t,r,a,i,o,u=s[0]&&Oi(s),l=s[0]&&ji(s);return{c(){e=g("div"),t=g("canvas"),r=I(),a=g("canvas"),i=I(),u&&u.c(),o=I(),l&&l.c(),this.h()},l(d){e=p(d,"DIV",{class:!0});var m=v(e);t=p(m,"CANVAS",{class:!0,style:!0}),v(t).forEach(f),r=x(m),a=p(m,"CANVAS",{class:!0,style:!0}),v(a).forEach(f),i=x(m),u&&u.l(m),o=x(m),l&&l.l(m),m.forEach(f),this.h()},h(){c(t,"class","absolute inset-0 w-full h-full object-contain z-10 svelte-1c664co"),ne(t,"opacity",s[6]),c(a,"class","absolute inset-0 w-full h-full object-contain z-20 pointer-events-none svelte-1c664co"),ne(a,"mix-blend-mode","screen"),c(e,"class","scanline-processor relative overflow-hidden rounded-lg svelte-1c664co")},m(d,m){q(d,e,m),n(e,t),s[11](t),n(e,r),n(e,a),s[12](a),n(e,i),u&&u.m(e,null),n(e,o),l&&l.m(e,null)},p(d,m){m[0]&64&&ne(t,"opacity",d[6]),d[0]?u?u.p(d,m):(u=Oi(d),u.c(),u.m(e,o)):u&&(u.d(1),u=null),d[0]?l?l.p(d,m):(l=ji(d),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i:Ce,o:Ce,d(d){d&&f(e),s[11](null),s[12](null),u&&u.d(),l&&l.d()}}}const Li=3e3,Ba=1e3,nl=.003,ll=12,cl=5;function ul(s,e,t){let r,a,{image:i}=e,{isProcessing:o=!1}=e,{processingProgress:u=0}=e,{processingMessage:l="Processing..."}=e,{processedResult:d=null}=e;const m=zt();let h,b,_,w=We(0,{duration:3e3,easing:Nt}),y=We(1,{duration:1e3,easing:Pr});ze(s,y,U=>t(6,a=U));let T=We(0,{duration:500,easing:Pr});ze(s,T,U=>t(5,r=U));let M,E,A,V=null;Ut(()=>{h&&b&&(M=h.getContext("2d"),E=b.getContext("2d"),F())}),Mr(()=>{_&&cancelAnimationFrame(_)});async function F(){A=new Image,A.onload=()=>{W(),D()},A.src=i.preview}function W(){const{width:U,height:J}=R();t(3,h.width=U,h),t(3,h.height=J,h),t(4,b.width=U,b),t(4,b.height=J,b),M.imageSmoothingEnabled=!0,M.imageSmoothingQuality="high",E.imageSmoothingEnabled=!0,E.imageSmoothingQuality="high"}function R(){const Q=i.dimensions||{width:600,height:400},K=Q.width/Q.height;let G=Math.min(Q.width,600),O=G/K;return O>400&&(O=400,G=O*K),{width:Math.round(G),height:Math.round(O)}}function D(){const{width:U,height:J}=R();M.clearRect(0,0,U,J),M.drawImage(A,0,0,U,J)}async function S(){w.set(0),T.set(.3),w.set(1),k(),L()}function k(){let U=Date.now();function J(){if(!o)return;const Q=Date.now()-U,K=.3+.4*Math.sin(Q*nl);T.set(K),_=requestAnimationFrame(J)}J()}function L(){const U=Date.now(),{width:J,height:Q}=R();function K(){if(!o)return;const G=Date.now()-U,O=Math.min(G/Li,1);if(E.clearRect(0,0,J,Q),B(O,J,Q),G>Ba){const te=Math.min((G-Ba)/(Li-Ba),1);ee(te,J,Q)}O<1?_=requestAnimationFrame(K):m("scanlineComplete")}K()}function B(U,J,Q){const K=U*Q,G=r,O=Date.now()*.005,te=Math.sin(O*2)*cl,$=K+te,ae=E.createLinearGradient(0,$-25,0,$+25);ae.addColorStop(0,"rgba(0, 255, 136, 0)"),ae.addColorStop(.3,`rgba(0, 255, 136, ${G*.6})`),ae.addColorStop(.5,`rgba(0, 255, 136, ${G})`),ae.addColorStop(.7,`rgba(0, 255, 136, ${G*.6})`),ae.addColorStop(1,"rgba(0, 255, 136, 0)"),E.fillStyle=ae,E.fillRect(0,$-25,J,50),P($,J,G,O),C($,J,G);const se=E.createLinearGradient(0,Math.max(0,$-80),0,$);se.addColorStop(0,"rgba(0, 255, 136, 0)"),se.addColorStop(.5,`rgba(0, 255, 136, ${G*.2})`),se.addColorStop(1,`rgba(0, 255, 136, ${G*.4})`),E.fillStyle=se,E.fillRect(0,Math.max(0,$-80),J,80),U>.3&&H($,J,G)}function P(U,J,Q,K){for(let O=0;O<12;O++){const $=O/12*J+Math.sin(K+O*.5)*30,ae=U+Math.sin(K*1.2+O*.8)*8,se=1.5+Math.sin(K*2+O)*.8,ie=(.6+Math.sin(K*1.5+O*.3)*.3)*Q;E.save(),E.globalAlpha=ie;const ge=E.createRadialGradient($,ae,0,$,ae,se*3);ge.addColorStop(0,`rgba(0, 255, 136, ${ie})`),ge.addColorStop(.7,`rgba(0, 255, 136, ${ie*.5})`),ge.addColorStop(1,"rgba(0, 255, 136, 0)"),E.fillStyle=ge,E.beginPath(),E.arc($,ae,se*3,0,Math.PI*2),E.fill(),E.fillStyle=`rgba(255, 255, 255, ${ie*.8})`,E.beginPath(),E.arc($,ae,se,0,Math.PI*2),E.fill(),E.restore()}}function C(U,J,Q,K){const G=Math.floor(ll*Q),O=Date.now()*.01;for(let te=0;te<G;te++){const $=Math.random()*J,ae=U+(Math.random()-.5)*40,se=(Math.sin(O+te)+1)/2;if(se<.1)continue;const ie=(1+Math.random()*2)*se,ge=se*Q*.6;E.save(),E.globalAlpha=ge,E.shadowBlur=6,E.shadowColor=`rgba(0, 255, 136, ${ge})`,E.strokeStyle=`rgba(255, 255, 255, ${ge})`,E.lineWidth=ie,E.lineCap="round",E.beginPath(),E.moveTo($-ie*2,ae),E.lineTo($+ie*2,ae),E.moveTo($,ae-ie*2),E.lineTo($,ae+ie*2),E.stroke(),E.restore()}}function H(U,J,Q,K){const O=U+10,te=E.createLinearGradient(0,O,0,O+30);te.addColorStop(0,`rgba(0, 255, 136, ${Q*.2})`),te.addColorStop(1,"rgba(0, 255, 136, 0)"),E.save(),E.globalAlpha=.4,E.fillStyle=te,E.fillRect(0,O,J,30),E.restore()}function ee(U,J,Q){const K=E.getImageData(0,0,J,Q),G=K.data;for(let O=0;O<G.length;O+=4){const te=O/4%J,$=Math.floor(O/4/J),ae=Math.random()*.5+.5,ie=Math.sqrt(Math.pow(te-J/2,2)+Math.pow($-Q/2,2))/Math.sqrt(J*J+Q*Q);U*(1+ie*.3)*ae>.6&&(G[O]=Math.min(255,G[O]+Math.random()*100),G[O+1]=Math.min(255,G[O+1]+Math.random()*255),G[O+2]=Math.min(255,G[O+2]+Math.random()*150),G[O+3]=Math.max(0,G[O+3]-Math.random()*100))}E.putImageData(K,0,0)}async function re(){d&&(V=new Image,V.onload=()=>{_&&cancelAnimationFrame(_),E.clearRect(0,0,b.width,b.height);const{width:U,height:J}=R();M.clearRect(0,0,U,J),M.drawImage(V,0,0,U,J),y.set(0).then(()=>{y.set(1),m("animationComplete")})},V.src=d)}function Y(U){Fs[U?"unshift":"push"](()=>{h=U,t(3,h)})}function X(U){Fs[U?"unshift":"push"](()=>{b=U,t(4,b)})}return s.$$set=U=>{"image"in U&&t(9,i=U.image),"isProcessing"in U&&t(0,o=U.isProcessing),"processingProgress"in U&&t(1,u=U.processingProgress),"processingMessage"in U&&t(2,l=U.processingMessage),"processedResult"in U&&t(10,d=U.processedResult)},s.$$.update=()=>{s.$$.dirty[0]&9&&o&&h&&S(),s.$$.dirty[0]&1025&&d&&!o&&re()},[o,u,l,h,b,r,a,y,T,i,d,Y,X]}class dl extends lt{constructor(e){super(),ct(this,e,ul,ol,nt,{image:9,isProcessing:0,processingProgress:1,processingMessage:2,processedResult:10},null,[-1,-1])}}const us=class us{constructor(){}static getInstance(){return us.instance||(us.instance=new us),us.instance}async downloadImage(e,t={format:"png"},r){try{const a=await fetch(e);if(!a.ok)throw new Error(`Failed to fetch image: ${a.status}`);const i=await a.blob(),{blob:o,filename:u}=await this.processImageBlob(i,t,r),l=URL.createObjectURL(o),d=document.createElement("a");return d.href=l,d.download=u,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(l),!0}catch(a){return console.error("Download failed:",a),!1}}async downloadBatch(e,t={format:"png"}){let r=0,a=0;for(let i=0;i<e.length;i++){const{url:o,metadata:u}=e[i],l={...t,filename:t.filename||`character_batch_${i+1}.${t.format}`};await this.downloadImage(o,l,u)?r++:a++,await this.delay(200)}return{successful:r,failed:a}}async getDownloadPreview(e,t){try{const r=await fetch(e,{method:"HEAD"}),a=parseInt(r.headers.get("content-length")||"0");let i=a;return t.format==="jpeg"?i=Math.floor(a*.6):t.format==="webp"&&(i=Math.floor(a*.7)),{estimatedSize:this.formatFileSize(i),format:t.format.toUpperCase(),filename:this.generateFilename(t),dimensions:await this.getImageDimensions(e)}}catch{return{estimatedSize:"Unknown",format:t.format.toUpperCase(),filename:this.generateFilename(t)}}}async processImageBlob(e,t,r){const a=this.generateFilename(t,r);return t.format==="png"&&!t.includeMetadata?{blob:e,filename:a}:{blob:await this.convertImageFormat(e,t),filename:a}}async convertImageFormat(e,t){return new Promise(r=>{const a=new Image,i=document.createElement("canvas"),o=i.getContext("2d");a.onload=()=>{i.width=a.width,i.height=a.height,o.drawImage(a,0,0),i.toBlob(u=>{r(u||e)},this.getMimeType(t.format),t.quality||.9)},a.onerror=()=>r(e),a.src=URL.createObjectURL(e)})}generateFilename(e,t){var i;if(e.filename)return this.ensureExtension(e.filename,e.format);const r=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-");return`character_${((i=t==null?void 0:t.processingId)==null?void 0:i.slice(-8))||"unknown"}_${r}.${e.format}`}ensureExtension(e,t){const r=`.${t}`;if(e.toLowerCase().endsWith(r))return e;const a=e.lastIndexOf(".");return a>0&&(e=e.substring(0,a)),e+r}getMimeType(e){return{png:"image/png",jpeg:"image/jpeg",webp:"image/webp"}[e]||"image/png"}formatFileSize(e){if(e===0)return"0 B";const t=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,a)).toFixed(1))+" "+r[a]}async getImageDimensions(e){return new Promise(t=>{const r=new Image;r.onload=()=>t({width:r.width,height:r.height}),r.onerror=()=>t(void 0),r.src=e})}delay(e){return new Promise(t=>setTimeout(t,e))}supportsFormat(e){const t=document.createElement("canvas");if(!["png","jpeg","webp"].includes(e))return!1;try{return t.toBlob(()=>{},this.getMimeType(e)),!0}catch{return!1}}getRecommendedFormat(e="development"){const t=this.supportsFormat("webp");switch(e){case"web":return t?"webp":"png";case"print":return"png";case"development":default:return"png"}}};Le(us,"instance");let Ha=us;const fl=Ha.getInstance();function Ni(s){let e,t,r,a,i,o="Before",u,l,d,m,h,b,_="After",w,y,T,M,E='<div class="w-8 h-8 bg-magic-400 rounded-full shadow-lg flex items-center justify-center cursor-grab active:cursor-grabbing svelte-1pkr20b"><svg class="w-4 h-4 text-white svelte-1pkr20b" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l4-4 4 4M8 15l4 4 4-4" class="svelte-1pkr20b"></path></svg></div>',A,V,F,W,R,D;return{c(){e=g("div"),t=g("img"),a=I(),i=g("div"),i.textContent=o,u=I(),l=g("div"),d=g("img"),h=I(),b=g("div"),b.textContent=_,w=I(),y=g("div"),T=g("div"),M=g("div"),M.innerHTML=E,A=I(),V=g("div"),F=g("div"),W=g("div"),this.h()},l(S){e=p(S,"DIV",{class:!0});var k=v(e);t=p(k,"IMG",{src:!0,alt:!0,class:!0}),a=x(k),i=p(k,"DIV",{class:!0,"data-svelte-h":!0}),Z(i)!=="svelte-1708kdh"&&(i.textContent=o),k.forEach(f),u=x(S),l=p(S,"DIV",{class:!0,style:!0});var L=v(l);d=p(L,"IMG",{src:!0,alt:!0,class:!0}),h=x(L),b=p(L,"DIV",{class:!0,"data-svelte-h":!0}),Z(b)!=="svelte-1c3bdub"&&(b.textContent=_),L.forEach(f),w=x(S),y=p(S,"DIV",{class:!0});var B=v(y);T=p(B,"DIV",{class:!0,style:!0});var P=v(T);M=p(P,"DIV",{class:!0,"data-svelte-h":!0}),Z(M)!=="svelte-4z4yto"&&(M.innerHTML=E),P.forEach(f),B.forEach(f),A=x(S),V=p(S,"DIV",{class:!0});var C=v(V);F=p(C,"DIV",{class:!0});var H=v(F);W=p(H,"DIV",{class:!0,style:!0}),v(W).forEach(f),H.forEach(f),C.forEach(f),this.h()},h(){wr(t.src,r=s[0].preview)||c(t,"src",r),c(t,"alt","Original character with background"),c(t,"class","w-full h-full object-contain svelte-1pkr20b"),c(i,"class","absolute bottom-2 left-2 px-2 py-1 bg-dark-elevated/90 rounded text-xs text-dark-text-secondary svelte-1pkr20b"),c(e,"class","comparison-image absolute inset-0 svelte-1pkr20b"),wr(d.src,m=s[9])||c(d,"src",m),c(d,"alt","Character with background removed"),c(d,"class","w-full h-full object-contain processed-image svelte-1pkr20b"),c(b,"class","absolute bottom-2 right-2 px-2 py-1 bg-magic-400/20 backdrop-blur-sm rounded text-xs text-magic-400 svelte-1pkr20b"),c(l,"class","comparison-image absolute inset-0 transition-all duration-300 ease-out svelte-1pkr20b"),ne(l,"clip-path","inset(0 "+(100-s[7])+"% 0 0)"),c(M,"class","slider-handle absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 svelte-1pkr20b"),c(T,"class","slider-line absolute top-0 bottom-0 w-0.5 bg-magic-400 shadow-lg svelte-1pkr20b"),ne(T,"left",s[7]+"%"),c(y,"class","slider-container absolute inset-0 cursor-ew-resize svelte-1pkr20b"),c(W,"class","h-full bg-gradient-to-r from-magic-400 to-magic-300 transition-all duration-1000 ease-out svelte-1pkr20b"),ne(W,"width",s[12]*100+"%"),c(F,"class","h-1 bg-dark-elevated rounded-full overflow-hidden svelte-1pkr20b"),c(V,"class","absolute top-2 left-2 right-2 svelte-1pkr20b")},m(S,k){q(S,e,k),n(e,t),n(e,a),n(e,i),q(S,u,k),q(S,l,k),n(l,d),n(l,h),n(l,b),q(S,w,k),q(S,y,k),n(y,T),n(T,M),q(S,A,k),q(S,V,k),n(V,F),n(F,W),R||(D=[ce(y,"mousedown",s[20]),ce(y,"touchstart",s[20],{passive:!0})],R=!0)},p(S,k){k[0]&1&&!wr(t.src,r=S[0].preview)&&c(t,"src",r),k[0]&512&&!wr(d.src,m=S[9])&&c(d,"src",m),k[0]&128&&ne(l,"clip-path","inset(0 "+(100-S[7])+"% 0 0)"),k[0]&128&&ne(T,"left",S[7]+"%"),k[0]&4096&&ne(W,"width",S[12]*100+"%")},d(S){S&&(f(e),f(u),f(l),f(w),f(y),f(A),f(V)),R=!1,Qe(D)}}}function zi(s){let e,t,r,a,i,o,u,l,d,m,h,b,_,w,y="Perfect for batch processing workflow",T,M,E,A="Download",V,F,W="Stay Here",R,D,S,k,L;return{c(){e=g("div"),t=g("div"),r=g("div"),a=g("div"),i=g("span"),o=N(s[6]),u=I(),l=g("div"),d=g("p"),m=N("Continuing to process another image in "),h=N(s[6]),b=N("s"),_=I(),w=g("p"),w.textContent=y,T=I(),M=g("div"),E=g("button"),E.textContent=A,V=I(),F=g("button"),F.textContent=W,R=I(),D=g("div"),S=g("div"),this.h()},l(B){e=p(B,"DIV",{class:!0});var P=v(e);t=p(P,"DIV",{class:!0});var C=v(t);r=p(C,"DIV",{class:!0});var H=v(r);a=p(H,"DIV",{class:!0});var ee=v(a);i=p(ee,"SPAN",{class:!0});var re=v(i);o=z(re,s[6]),re.forEach(f),ee.forEach(f),u=x(H),l=p(H,"DIV",{class:!0});var Y=v(l);d=p(Y,"P",{class:!0});var X=v(d);m=z(X,"Continuing to process another image in "),h=z(X,s[6]),b=z(X,"s"),X.forEach(f),_=x(Y),w=p(Y,"P",{class:!0,"data-svelte-h":!0}),Z(w)!=="svelte-1j2dwwu"&&(w.textContent=y),Y.forEach(f),H.forEach(f),T=x(C),M=p(C,"DIV",{class:!0});var U=v(M);E=p(U,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(E)!=="svelte-1ifzh58"&&(E.textContent=A),V=x(U),F=p(U,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(F)!=="svelte-1klg6xy"&&(F.textContent=W),U.forEach(f),C.forEach(f),R=x(P),D=p(P,"DIV",{class:!0});var J=v(D);S=p(J,"DIV",{class:!0,style:!0}),v(S).forEach(f),J.forEach(f),P.forEach(f),this.h()},h(){c(i,"class","text-sm font-mono text-magic-400 svelte-1pkr20b"),c(a,"class","w-8 h-8 rounded-full bg-magic-400/20 flex items-center justify-center svelte-1pkr20b"),c(d,"class","text-sm text-dark-text svelte-1pkr20b"),c(w,"class","text-xs text-dark-text-muted svelte-1pkr20b"),c(l,"class","svelte-1pkr20b"),c(r,"class","flex items-center space-x-3 svelte-1pkr20b"),c(E,"class","btn btn-outline border-magic-400 text-magic-400 hover:bg-magic-400 hover:text-white px-4 py-2 rounded text-sm svelte-1pkr20b"),c(F,"class","btn btn-outline border-gray-500 text-gray-400 hover:bg-gray-500 hover:text-white px-4 py-2 rounded text-sm svelte-1pkr20b"),c(M,"class","flex space-x-2 svelte-1pkr20b"),c(t,"class","flex items-center justify-between svelte-1pkr20b"),c(S,"class","h-full bg-magic-400 transition-all duration-1000 ease-linear svelte-1pkr20b"),ne(S,"width",(Math.floor(s[2]/1e3)-s[6])/Math.floor(s[2]/1e3)*100+"%"),c(D,"class","mt-3 h-1 bg-dark-base rounded-full overflow-hidden svelte-1pkr20b"),c(e,"class","mt-6 p-4 bg-dark-elevated/50 backdrop-blur-sm rounded-lg border border-magic-400/20 svelte-1pkr20b")},m(B,P){q(B,e,P),n(e,t),n(t,r),n(r,a),n(a,i),n(i,o),n(r,u),n(r,l),n(l,d),n(d,m),n(d,h),n(d,b),n(l,_),n(l,w),n(t,T),n(t,M),n(M,E),n(M,V),n(M,F),n(e,R),n(e,D),n(D,S),k||(L=[ce(E,"click",s[18]),ce(F,"click",s[17])],k=!0)},p(B,P){P[0]&64&&de(o,B[6]),P[0]&64&&de(h,B[6]),P[0]&68&&ne(S,"width",(Math.floor(B[2]/1e3)-B[6])/Math.floor(B[2]/1e3)*100+"%")},d(B){B&&f(e),k=!1,Qe(L)}}}function Ui(s){let e,t,r=`<svg class="w-5 h-5 mr-2 svelte-1pkr20b" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-4-4m4 4l4-4m-4-4V3" class="svelte-1pkr20b"></path></svg>
        Download PNG`,a,i,o=`<svg class="w-5 h-5 mr-2 svelte-1pkr20b" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-1pkr20b"></path></svg>
        Process Another`,u,l;return{c(){e=g("div"),t=g("button"),t.innerHTML=r,a=I(),i=g("button"),i.innerHTML=o,this.h()},l(d){e=p(d,"DIV",{class:!0});var m=v(e);t=p(m,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-7he9qg"&&(t.innerHTML=r),a=x(m),i=p(m,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(i)!=="svelte-gzt153"&&(i.innerHTML=o),m.forEach(f),this.h()},h(){c(t,"class","btn btn-magic py-3 px-6 rounded-lg font-medium svelte-1pkr20b"),c(i,"class","btn btn-outline border-magic-400 text-magic-400 hover:bg-magic-400 hover:text-white py-3 px-6 rounded-lg font-medium svelte-1pkr20b"),c(e,"class","mt-6 flex flex-col sm:flex-row gap-4 justify-center svelte-1pkr20b")},m(d,m){q(d,e,m),n(e,t),n(e,a),n(e,i),u||(l=[ce(t,"click",s[18]),ce(i,"click",s[24])],u=!0)},p:Ce,d(d){d&&f(e),u=!1,Qe(l)}}}function ml(s){let e,t,r,a="Perfect Reveal Complete!",i,o,u,l=s[8].toFixed(2)+"",d,m,h,b,_,w,y,T,M=s[3]&&Ni(s),E=s[5]&&s[1]&&zi(s),A=(!s[1]||!s[5])&&Ui(s);return{c(){e=g("div"),t=g("div"),r=g("h3"),r.textContent=a,i=I(),o=g("p"),u=N("Background removed in "),d=N(l),m=N("s • Auto-copied to clipboard"),h=I(),b=g("div"),M&&M.c(),_=I(),E&&E.c(),w=I(),A&&A.c(),this.h()},l(V){e=p(V,"DIV",{class:!0,style:!0});var F=v(e);t=p(F,"DIV",{class:!0});var W=v(t);r=p(W,"H3",{class:!0,"data-svelte-h":!0}),Z(r)!=="svelte-1t3kgd4"&&(r.textContent=a),i=x(W),o=p(W,"P",{class:!0});var R=v(o);u=z(R,"Background removed in "),d=z(R,l),m=z(R,"s • Auto-copied to clipboard"),R.forEach(f),W.forEach(f),h=x(F),b=p(F,"DIV",{class:!0,style:!0});var D=v(b);M&&M.l(D),D.forEach(f),_=x(F),E&&E.l(F),w=x(F),A&&A.l(F),F.forEach(f),this.h()},h(){c(r,"class","text-2xl font-semibold text-magic-gradient mb-2 svelte-1pkr20b"),c(o,"class","text-dark-text-secondary svelte-1pkr20b"),c(t,"class","mb-6 text-center svelte-1pkr20b"),c(b,"class","comparison-container relative overflow-hidden rounded-xl border border-magic-400/20 svelte-1pkr20b"),ne(b,"transform","translateY("+s[11]+"px)"),c(e,"class","before-after-preview svelte-1pkr20b"),ne(e,"opacity",s[10])},m(V,F){q(V,e,F),n(e,t),n(t,r),n(t,i),n(t,o),n(o,u),n(o,d),n(o,m),n(e,h),n(e,b),M&&M.m(b,null),s[23](b),n(e,_),E&&E.m(e,null),n(e,w),A&&A.m(e,null),y||(T=[ce(window,"mousemove",s[19]),ce(window,"mouseup",s[21]),ce(window,"touchmove",s[19]),ce(window,"touchend",s[21])],y=!0)},p(V,F){F[0]&256&&l!==(l=V[8].toFixed(2)+"")&&de(d,l),V[3]?M?M.p(V,F):(M=Ni(V),M.c(),M.m(b,null)):M&&(M.d(1),M=null),F[0]&2048&&ne(b,"transform","translateY("+V[11]+"px)"),V[5]&&V[1]?E?E.p(V,F):(E=zi(V),E.c(),E.m(e,w)):E&&(E.d(1),E=null),!V[1]||!V[5]?A?A.p(V,F):(A=Ui(V),A.c(),A.m(e,null)):A&&(A.d(1),A=null),F[0]&1024&&ne(e,"opacity",V[10])},i:Ce,o:Ce,d(V){V&&f(e),M&&M.d(),s[23](null),E&&E.d(),A&&A.d(),y=!1,Qe(T)}}}function gl(s,e,t){let r,a,i,o,u,{originalImage:l}=e,{processedResult:d}=e,{autoProceeds:m=!0}=e,{autoProceedDelay:h=2e3}=e;const b=zt();let _=!1,w=We(0,{duration:1500,easing:Nt});ze(s,w,X=>t(12,u=X));let y=We(100,{duration:800,easing:Pr});ze(s,y,X=>t(11,o=X));let T=We(0,{duration:600,easing:Pr});ze(s,T,X=>t(10,i=X));let M,E,A=!1,V=Math.floor(h/1e3),F;Ut(()=>{W()});async function W(){T.set(1),setTimeout(()=>{t(3,_=!0),y.set(0),w.set(1)},300),setTimeout(()=>{m&&(t(5,A=!0),R())},2e3)}function R(){F=setInterval(()=>{t(6,V--,V),V<=0&&(clearInterval(F),D())},1e3),E=setTimeout(()=>{D()},h)}function D(){L(),b("proceed",{action:"continue"})}function S(){L(),t(5,A=!1),b("stay")}async function k(){L(),b("proceed",{action:"download"})}function L(){E&&clearTimeout(E),F&&clearInterval(F)}let B=50,P=!1;function C(X){if(!P)return;const U=M.getBoundingClientRect(),Q=(("touches"in X?X.touches[0].clientX:X.clientX)-U.left)/U.width*100;t(7,B=Math.max(0,Math.min(100,Q)))}function H(){P=!0,L()}function ee(){P=!1}function re(X){Fs[X?"unshift":"push"](()=>{M=X,t(4,M)})}const Y=()=>b("proceed",{action:"continue"});return s.$$set=X=>{"originalImage"in X&&t(0,l=X.originalImage),"processedResult"in X&&t(22,d=X.processedResult),"autoProceeds"in X&&t(1,m=X.autoProceeds),"autoProceedDelay"in X&&t(2,h=X.autoProceedDelay)},s.$$.update=()=>{s.$$.dirty[0]&4194304&&t(9,r=d.download_url),s.$$.dirty[0]&4194304&&t(8,a=d.processing_time||0)},[l,m,h,_,M,A,V,B,a,r,i,o,u,b,w,y,T,S,k,C,H,ee,d,re,Y]}class pl extends lt{constructor(e){super(),ct(this,e,gl,ml,nt,{originalImage:0,processedResult:22,autoProceeds:1,autoProceedDelay:2},null,[-1,-1])}}function hl(s,e,t){const r=s.slice();return r[21]=e[t],r[23]=t,r}function Hi(s){let e,t,r,a=Tr(s[5])+"",i,o=s[3]>1&&qi(s);return{c(){e=g("div"),o&&o.c(),t=I(),r=g("span"),i=N(a),this.h()},l(u){e=p(u,"DIV",{class:!0});var l=v(e);o&&o.l(l),t=x(l),r=p(l,"SPAN",{});var d=v(r);i=z(d,a),d.forEach(f),l.forEach(f),this.h()},h(){c(e,"class","flex items-center space-x-2 text-xs text-dark-text-muted")},m(u,l){q(u,e,l),o&&o.m(e,null),n(e,t),n(e,r),n(r,i)},p(u,l){u[3]>1?o?o.p(u,l):(o=qi(u),o.c(),o.m(e,t)):o&&(o.d(1),o=null),l&32&&a!==(a=Tr(u[5])+"")&&de(i,a)},d(u){u&&f(e),o&&o.d()}}}function qi(s){let e,t,r;return{c(){e=g("span"),t=N("Attempt "),r=N(s[3]),this.h()},l(a){e=p(a,"SPAN",{class:!0});var i=v(e);t=z(i,"Attempt "),r=z(i,s[3]),i.forEach(f),this.h()},h(){c(e,"class","px-2 py-1 bg-yellow-400/20 text-yellow-400 rounded")},m(a,i){q(a,e,i),n(e,t),n(e,r)},p(a,i){i&8&&de(r,a[3])},d(a){a&&f(e)}}}function Gi(s){let e,t,r=Tr(s[4]*1e3)+"",a;return{c(){e=g("span"),t=N("Completed in "),a=N(r),this.h()},l(i){e=p(i,"SPAN",{class:!0});var o=v(e);t=z(o,"Completed in "),a=z(o,r),o.forEach(f),this.h()},h(){c(e,"class","text-xs text-green-400")},m(i,o){q(i,e,o),n(e,t),n(e,a)},p(i,o){o&16&&r!==(r=Tr(i[4]*1e3)+"")&&de(a,r)},d(i){i&&f(e)}}}function Wi(s){let e,t,r,a="Progress",i,o,u=Math.round(s[9])+"",l,d,m,h,b,_,w;return{c(){e=g("div"),t=g("div"),r=g("span"),r.textContent=a,i=I(),o=g("span"),l=N(u),d=N("%"),h=I(),b=g("div"),_=g("div"),w=g("div"),this.h()},l(y){e=p(y,"DIV",{class:!0});var T=v(e);t=p(T,"DIV",{class:!0});var M=v(t);r=p(M,"SPAN",{class:!0,"data-svelte-h":!0}),Z(r)!=="svelte-nbdke7"&&(r.textContent=a),i=x(M),o=p(M,"SPAN",{class:!0});var E=v(o);l=z(E,u),d=z(E,"%"),E.forEach(f),M.forEach(f),h=x(T),b=p(T,"DIV",{class:!0});var A=v(b);_=p(A,"DIV",{class:!0,style:!0});var V=v(_);w=p(V,"DIV",{class:!0}),v(w).forEach(f),V.forEach(f),A.forEach(f),T.forEach(f),this.h()},h(){c(r,"class","text-xs text-dark-text-muted"),c(o,"class",m="text-xs "+s[6].color+" svelte-vxne92"),c(t,"class","flex items-center justify-between mb-1"),c(w,"class","absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-shimmer svelte-vxne92"),c(_,"class","h-full transition-all duration-300 ease-out relative"),ne(_,"width",s[9]+"%"),be(_,"bg-blue-400",s[1]==="uploading"),be(_,"bg-magic-400",s[1]==="processing"),c(b,"class","h-2 bg-dark-base rounded-full overflow-hidden"),c(e,"class","mt-2")},m(y,T){q(y,e,T),n(e,t),n(t,r),n(t,i),n(t,o),n(o,l),n(o,d),n(e,h),n(e,b),n(b,_),n(_,w)},p(y,T){T&512&&u!==(u=Math.round(y[9])+"")&&de(l,u),T&64&&m!==(m="text-xs "+y[6].color+" svelte-vxne92")&&c(o,"class",m),T&512&&ne(_,"width",y[9]+"%"),T&2&&be(_,"bg-blue-400",y[1]==="uploading"),T&2&&be(_,"bg-magic-400",y[1]==="processing")},d(y){y&&f(e)}}}function Yi(s){let e,t='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>',r,a;return{c(){e=g("button"),e.innerHTML=t,this.h()},l(i){e=p(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-h4m568"&&(e.innerHTML=t),this.h()},h(){c(e,"class","flex-shrink-0 p-1 text-dark-text-muted hover:text-dark-text transition-colors")},m(i,o){q(i,e,o),r||(a=ce(e,"click",s[14]),r=!0)},p:Ce,d(i){i&&f(e),r=!1,a()}}}function Ki(s){let e,t='<div class="success-checkmark svelte-vxne92"><svg class="w-16 h-16 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" class="checkmark-path svelte-vxne92"></path></svg></div>';return{c(){e=g("div"),e.innerHTML=t,this.h()},l(r){e=p(r,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-cpexd1"&&(e.innerHTML=t),this.h()},h(){c(e,"class","mt-4 flex items-center justify-center")},m(r,a){q(r,e,a)},d(r){r&&f(e)}}}function Ji(s){let e,t=Je(Array(6)),r=[];for(let a=0;a<t.length;a+=1)r[a]=vl(hl(s,t,a));return{c(){e=g("div");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=p(a,"DIV",{class:!0});var i=v(e);for(let o=0;o<r.length;o+=1)r[o].l(i);i.forEach(f),this.h()},h(){c(e,"class","processing-particles absolute inset-0 pointer-events-none overflow-hidden rounded-lg")},m(a,i){q(a,e,i);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null)},p:Ce,d(a){a&&f(e),Vs(r,a)}}}function vl(s){let e;return{c(){e=g("div"),this.h()},l(t){e=p(t,"DIV",{class:!0,style:!0}),v(e).forEach(f),this.h()},h(){c(e,"class","particle absolute w-1 h-1 bg-magic-400 rounded-full opacity-60 svelte-vxne92"),ne(e,"left",10+s[23]*15+"%"),ne(e,"animation","float "+(2+s[23]*.3)+"s ease-in-out infinite"),ne(e,"animation-delay",s[23]*.2+"s")},m(t,r){q(t,e,r)},p:Ce,d(t){t&&f(e)}}}function bl(s){let e,t,r,a,i,o,u,l,d,m,h,b,_=(s[2]||"Ready")+"",w,y,T,M,E,A,V,F,W,R=s[1]==="processing"&&Hi(s),D=s[1]==="success"&&s[4]>0&&Gi(s),S=(s[1]==="uploading"||s[1]==="processing")&&Wi(s),k=s[0]&&(s[1]==="processing"||s[1]==="error")&&Yi(s),L=s[1]==="success"&&Ki(),B=s[1]==="processing"&&Ji(s);return{c(){e=g("div"),t=g("div"),r=g("div"),a=Te("svg"),i=Te("path"),d=I(),m=g("div"),h=g("div"),b=g("span"),w=N(_),T=I(),R&&R.c(),M=I(),D&&D.c(),E=I(),S&&S.c(),A=I(),k&&k.c(),V=I(),L&&L.c(),F=I(),B&&B.c(),this.h()},l(P){e=p(P,"DIV",{class:!0,style:!0});var C=v(e);t=p(C,"DIV",{class:!0});var H=v(t);r=p(H,"DIV",{class:!0,style:!0});var ee=v(r);a=Me(ee,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var re=v(a);i=Me(re,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(i).forEach(f),re.forEach(f),ee.forEach(f),d=x(H),m=p(H,"DIV",{class:!0});var Y=v(m);h=p(Y,"DIV",{class:!0});var X=v(h);b=p(X,"SPAN",{class:!0});var U=v(b);w=z(U,_),U.forEach(f),T=x(X),R&&R.l(X),M=x(X),D&&D.l(X),X.forEach(f),E=x(Y),S&&S.l(Y),Y.forEach(f),A=x(H),k&&k.l(H),H.forEach(f),V=x(C),L&&L.l(C),F=x(C),B&&B.l(C),C.forEach(f),this.h()},h(){c(i,"stroke-linecap","round"),c(i,"stroke-linejoin","round"),c(i,"stroke-width","2"),c(i,"d",o=Qi(s[6].icon)),c(a,"class",u="w-5 h-5 "+s[6].color+" svelte-vxne92"),c(a,"fill","none"),c(a,"stroke","currentColor"),c(a,"viewBox","0 0 24 24"),be(a,"animate-spin",s[1]==="processing"&&s[6].icon==="cog"),c(r,"class",l="flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center "+s[6].bgColor+" svelte-vxne92"),ne(r,"box-shadow","0 0 "+s[8]*20+"px rgba(0, 255, 136, "+s[8]*.4+")"),c(b,"class",y="text-sm font-medium "+s[6].color+" svelte-vxne92"),c(h,"class","flex items-center justify-between"),c(m,"class","flex-grow"),c(t,"class","flex items-center space-x-4 svelte-vxne92"),c(e,"class",W="processing-feedback transition-all duration-300 "+s[6].bgColor+" "+s[6].borderColor+" border rounded-lg p-4 svelte-vxne92"),ne(e,"transform","scale("+s[7]+")")},m(P,C){q(P,e,C),n(e,t),n(t,r),n(r,a),n(a,i),n(t,d),n(t,m),n(m,h),n(h,b),n(b,w),n(h,T),R&&R.m(h,null),n(h,M),D&&D.m(h,null),n(m,E),S&&S.m(m,null),n(t,A),k&&k.m(t,null),n(e,V),L&&L.m(e,null),n(e,F),B&&B.m(e,null)},p(P,[C]){C&64&&o!==(o=Qi(P[6].icon))&&c(i,"d",o),C&64&&u!==(u="w-5 h-5 "+P[6].color+" svelte-vxne92")&&c(a,"class",u),C&66&&be(a,"animate-spin",P[1]==="processing"&&P[6].icon==="cog"),C&64&&l!==(l="flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center "+P[6].bgColor+" svelte-vxne92")&&c(r,"class",l),C&256&&ne(r,"box-shadow","0 0 "+P[8]*20+"px rgba(0, 255, 136, "+P[8]*.4+")"),C&4&&_!==(_=(P[2]||"Ready")+"")&&de(w,_),C&64&&y!==(y="text-sm font-medium "+P[6].color+" svelte-vxne92")&&c(b,"class",y),P[1]==="processing"?R?R.p(P,C):(R=Hi(P),R.c(),R.m(h,M)):R&&(R.d(1),R=null),P[1]==="success"&&P[4]>0?D?D.p(P,C):(D=Gi(P),D.c(),D.m(h,null)):D&&(D.d(1),D=null),P[1]==="uploading"||P[1]==="processing"?S?S.p(P,C):(S=Wi(P),S.c(),S.m(m,null)):S&&(S.d(1),S=null),P[0]&&(P[1]==="processing"||P[1]==="error")?k?k.p(P,C):(k=Yi(P),k.c(),k.m(t,null)):k&&(k.d(1),k=null),P[1]==="success"?L||(L=Ki(),L.c(),L.m(e,F)):L&&(L.d(1),L=null),P[1]==="processing"?B?B.p(P,C):(B=Ji(P),B.c(),B.m(e,null)):B&&(B.d(1),B=null),C&64&&W!==(W="processing-feedback transition-all duration-300 "+P[6].bgColor+" "+P[6].borderColor+" border rounded-lg p-4 svelte-vxne92")&&c(e,"class",W),C&128&&ne(e,"transform","scale("+P[7]+")")},i:Ce,o:Ce,d(P){P&&f(e),R&&R.d(),D&&D.d(),S&&S.d(),k&&k.d(),L&&L.d(),B&&B.d()}}}function Tr(s){const e=Math.floor(s/1e3),t=Math.floor(e/60),r=e%60;return t>0?`${t}:${r.toString().padStart(2,"0")}`:`${e}s`}function Qi(s){const e={upload:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12","upload-cloud":"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10",cog:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z","check-circle":"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z","exclamation-circle":"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"};return e[s]||e.upload}function _l(s,e,t){let r,a,i,o,{status:u="idle"}=e,{progress:l=0}=e,{message:d=""}=e,{attemptNumber:m=1}=e,{processingTime:h=0}=e,{showDetails:b=!1}=e,_=We(0,{duration:300,easing:Nt});ze(s,_,D=>t(9,o=D));let w=We(1,{duration:800,easing:il});ze(s,w,D=>t(7,a=D));let y=We(0,{duration:500,easing:Nt});ze(s,y,D=>t(8,i=D));let T,M=0,E=0;Ut(()=>{u==="processing"&&(M=Date.now(),F())}),Mr(()=>{V(),T&&cancelAnimationFrame(T)});function A(){let D;function S(k){D||(D=k);const L=k-D,B=1+.1*Math.sin(L*.003);w.set(B),u==="processing"&&(T=requestAnimationFrame(S))}T=requestAnimationFrame(S)}function V(){T&&cancelAnimationFrame(T),w.set(1)}function F(){function D(){u==="processing"&&(t(5,E=Date.now()-M),T=requestAnimationFrame(D))}u==="processing"&&(T=requestAnimationFrame(D))}const W={idle:{icon:"upload",color:"text-dark-text-muted",bgColor:"bg-dark-elevated",borderColor:"border-gray-600"},uploading:{icon:"upload-cloud",color:"text-blue-400",bgColor:"bg-blue-400/10",borderColor:"border-blue-400/30"},processing:{icon:"cog",color:"text-magic-400",bgColor:"bg-magic-400/10",borderColor:"border-magic-400/30"},success:{icon:"check-circle",color:"text-green-400",bgColor:"bg-green-400/10",borderColor:"border-green-400/30"},error:{icon:"exclamation-circle",color:"text-red-400",bgColor:"bg-red-400/10",borderColor:"border-red-400/30"}},R=()=>t(0,b=!b);return s.$$set=D=>{"status"in D&&t(1,u=D.status),"progress"in D&&t(13,l=D.progress),"message"in D&&t(2,d=D.message),"attemptNumber"in D&&t(3,m=D.attemptNumber),"processingTime"in D&&t(4,h=D.processingTime),"showDetails"in D&&t(0,b=D.showDetails)},s.$$.update=()=>{s.$$.dirty&8192&&_.set(l),s.$$.dirty&2&&(u==="processing"?(A(),y.set(.8)):(V(),y.set(0))),s.$$.dirty&2&&t(6,r=W[u])},[b,u,d,m,h,E,r,a,i,o,_,w,y,l,R]}class yl extends lt{constructor(e){super(),ct(this,e,_l,bl,nt,{status:1,progress:13,message:2,attemptNumber:3,processingTime:4,showDetails:0})}}const ds=class ds{constructor(){}static getInstance(){return ds.instance||(ds.instance=new ds),ds.instance}classifyError(e,t){const r=typeof e=="string"?e:e.message,a=typeof e=="string"?"":e.stack||"";return this.isNetworkError(r,a)?this.createNetworkErrorClassification(r,t):this.isFileValidationError(r)?this.createFileValidationErrorClassification(r,t):this.isProcessingFailure(r)?this.createProcessingFailureClassification(r,t):this.isBrowserCompatibilityError(r,t==null?void 0:t.userAgent)?this.createBrowserCompatibilityClassification(r,t):this.isQuotaError(r)?this.createQuotaErrorClassification(r,t):this.isServerError(r)?this.createServerErrorClassification(r,t):this.createUnknownErrorClassification(r,t)}isNetworkError(e,t){return[/network/i,/connection/i,/timeout/i,/fetch.*failed/i,/cors/i,/net::/i,/ERR_INTERNET_DISCONNECTED/i,/ERR_NETWORK_CHANGED/i].some(a=>a.test(e)||a.test(t))}isFileValidationError(e){return[/invalid.*file/i,/unsupported.*format/i,/file.*too.*large/i,/file.*size/i,/corrupted.*file/i,/invalid.*image/i].some(r=>r.test(e))}isProcessingFailure(e){return[/processing.*failed/i,/background.*removal.*failed/i,/model.*error/i,/segmentation.*failed/i,/rembg.*error/i].some(r=>r.test(e))}isBrowserCompatibilityError(e,t){const a=[/clipboard.*not.*supported/i,/file.*api.*not.*supported/i,/canvas.*not.*supported/i,/webp.*not.*supported/i,/drag.*drop.*not.*supported/i].some(o=>o.test(e)),i=t&&(/MSIE|Trident/i.test(t)||/Chrome\/[4-6]\d/i.test(t)||/Firefox\/[3-5]\d/i.test(t));return a||!!i}isQuotaError(e){return[/quota.*exceeded/i,/rate.*limit/i,/too.*many.*requests/i,/429/,/storage.*full/i].some(r=>r.test(e))}isServerError(e){return[/5\d\d/,/server.*error/i,/internal.*error/i,/service.*unavailable/i,/gateway.*timeout/i].some(r=>r.test(e))}createNetworkErrorClassification(e,t){return{category:"network",severity:"medium",userMessage:"Connection issue detected. Please check your internet connection.",technicalMessage:e,recoverable:!0,suggestedActions:["Check your internet connection","Try again in a moment","Reload the page if the issue persists"],recommendedStrategy:"retry_original",displayDuration:5e3}}createFileValidationErrorClassification(e,t){const r=(t==null?void 0:t.fileSize)&&t.fileSize>10485760;return{category:"file_validation",severity:"low",userMessage:r?"Image file is too large. Please use a smaller image (under 10MB).":"This image format isn't supported. Please try a different image.",technicalMessage:e,recoverable:!0,suggestedActions:r?["Use an image under 10MB","Try compressing your image first"]:["Use JPG, PNG, or WebP format","Try a different image"],recommendedStrategy:r?"compress_image":"convert_format",displayDuration:6e3}}createProcessingFailureClassification(e,t){const r=(t==null?void 0:t.attempt)&&t.attempt>1;return{category:"processing_failure",severity:r?"high":"medium",userMessage:r?"We're having trouble processing this image. The AI model might be struggling with this particular image.":"Processing failed. This sometimes happens with complex images.",technicalMessage:e,recoverable:!r,suggestedActions:r?["Try a different image","Simplify the background if possible"]:["We'll try different processing methods","Please wait while we attempt recovery"],recommendedStrategy:r?"contact_support":"compress_image",displayDuration:r?8e3:4e3}}createBrowserCompatibilityClassification(e,t){return{category:"browser_compatibility",severity:"medium",userMessage:"Your browser doesn't support all the features needed. Please update your browser or try a different one.",technicalMessage:e,recoverable:!1,suggestedActions:["Update to the latest version of your browser","Try Chrome, Firefox, Safari, or Edge","Enable JavaScript if disabled"],recommendedStrategy:"try_different_browser",displayDuration:1e4}}createQuotaErrorClassification(e,t){return{category:"quota_exceeded",severity:"medium",userMessage:"Service is temporarily busy. Please wait a moment and try again.",technicalMessage:e,recoverable:!0,suggestedActions:["Wait a few minutes and try again","Avoid processing multiple images simultaneously"],recommendedStrategy:"retry_original",displayDuration:7e3}}createServerErrorClassification(e,t){return{category:"server_error",severity:"high",userMessage:"Our servers are experiencing issues. We're working to fix this.",technicalMessage:e,recoverable:!0,suggestedActions:["Try again in a few minutes","Reload the page if the issue persists"],recommendedStrategy:"retry_original",displayDuration:6e3}}createUnknownErrorClassification(e,t){return{category:"unknown",severity:"medium",userMessage:"Something unexpected happened. Please try again.",technicalMessage:e,recoverable:!0,suggestedActions:["Try again with the same image","Try a different image","Reload the page if issues continue"],recommendedStrategy:"retry_original",displayDuration:5e3}}getErrorColor(e){return{low:"text-yellow-400",medium:"text-orange-400",high:"text-red-400",critical:"text-red-500"}[e]}getErrorBackgroundColor(e){return{low:"bg-yellow-400/10",medium:"bg-orange-400/10",high:"bg-red-400/10",critical:"bg-red-500/10"}[e]}getErrorBorderColor(e){return{low:"border-yellow-400/30",medium:"border-orange-400/30",high:"border-red-400/30",critical:"border-red-500/30"}[e]}shouldAutoRetry(e){return e.recoverable&&e.severity!=="critical"&&["network","quota_exceeded","server_error"].includes(e.category)}getRetryDelay(e,t){return({network:1e3,quota_exceeded:3e3,server_error:2e3,processing_failure:1500}[e.category]||1e3)*Math.pow(1.5,t-1)+Math.random()*1e3}};Le(ds,"instance");let qa=ds;const we=qa.getInstance();function Zi(s,e,t){const r=s.slice();return r[18]=e[t],r}function Xi(s){let e,t,r,a,i,o,u,l,d,m,h,b,_,w=uo(s[4].category)+"",y,T,M,E,A,V=s[4].userMessage+"",F,W,R,D,S,k,L,B="Dismiss",P,C,H,ee,re='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',Y,X,U,J,Q,K=(s[0].fileName||s[0].attempt&&s[0].attempt>1)&&$i(s),G=s[4].suggestedActions.length>0&&so(s),O=s[2]&&s[4].recoverable&&ao(s),te=s[1]&&io(s),$=s[1]&&s[5]&&oo(s),ae=s[3]&&s[4].displayDuration&&s[4].severity!=="critical"&&lo(s);return{c(){e=g("div"),t=g("div"),r=g("div"),a=g("div"),i=Te("svg"),o=Te("path"),m=I(),h=g("div"),b=g("div"),_=g("h3"),y=N(w),T=N(" Error"),E=I(),A=g("p"),F=N(V),W=I(),K&&K.c(),R=I(),G&&G.c(),D=I(),S=g("div"),O&&O.c(),k=I(),L=g("button"),L.textContent=B,P=I(),te&&te.c(),C=I(),H=g("div"),ee=g("button"),ee.innerHTML=re,Y=I(),$&&$.c(),X=I(),ae&&ae.c(),this.h()},l(se){e=p(se,"DIV",{class:!0,style:!0});var ie=v(e);t=p(ie,"DIV",{class:!0});var ge=v(t);r=p(ge,"DIV",{class:!0});var j=v(r);a=p(j,"DIV",{class:!0});var _e=v(a);i=Me(_e,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var Ie=v(i);o=Me(Ie,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(o).forEach(f),Ie.forEach(f),_e.forEach(f),j.forEach(f),m=x(ge),h=p(ge,"DIV",{class:!0});var Ee=v(h);b=p(Ee,"DIV",{class:!0});var ye=v(b);_=p(ye,"H3",{class:!0});var Ge=v(_);y=z(Ge,w),T=z(Ge," Error"),Ge.forEach(f),E=x(ye),A=p(ye,"P",{class:!0});var Ye=v(A);F=z(Ye,V),Ye.forEach(f),W=x(ye),K&&K.l(ye),ye.forEach(f),R=x(Ee),G&&G.l(Ee),D=x(Ee),S=p(Ee,"DIV",{class:!0});var Re=v(S);O&&O.l(Re),k=x(Re),L=p(Re,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(L)!=="svelte-904fnz"&&(L.textContent=B),P=x(Re),te&&te.l(Re),Re.forEach(f),Ee.forEach(f),C=x(ge),H=p(ge,"DIV",{class:!0});var He=v(H);ee=p(He,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(ee)!=="svelte-x2bwpo"&&(ee.innerHTML=re),He.forEach(f),ge.forEach(f),Y=x(ie),$&&$.l(ie),X=x(ie),ae&&ae.l(ie),ie.forEach(f),this.h()},h(){c(o,"stroke-linecap","round"),c(o,"stroke-linejoin","round"),c(o,"stroke-width","2"),c(o,"d",u=co(s[4].category)),c(i,"class",l="w-6 h-6 "+we.getErrorColor(s[4].severity)+" svelte-o4la6q"),c(i,"fill","none"),c(i,"stroke","currentColor"),c(i,"viewBox","0 0 24 24"),c(a,"class",d="w-12 h-12 rounded-full "+we.getErrorBackgroundColor(s[4].severity)+" flex items-center justify-center svelte-o4la6q"),c(r,"class","flex-shrink-0"),c(_,"class",M="text-lg font-semibold "+we.getErrorColor(s[4].severity)+" mb-2 svelte-o4la6q"),c(A,"class","text-dark-text mb-3 leading-relaxed"),c(b,"class","mb-4"),c(L,"class","btn btn-outline border-gray-500 text-gray-400 hover:bg-gray-500 hover:text-white px-4 py-2 rounded-lg text-sm font-medium svelte-o4la6q"),c(S,"class","flex flex-wrap gap-3 svelte-o4la6q"),c(h,"class","flex-grow"),c(ee,"class","text-dark-text-muted hover:text-dark-text p-1 rounded svelte-o4la6q"),c(H,"class","flex-shrink-0"),c(t,"class","flex items-start space-x-4"),c(e,"class",U="error-display "+we.getErrorBackgroundColor(s[4].severity)+" "+we.getErrorBorderColor(s[4].severity)+" border rounded-xl p-6 max-w-2xl mx-auto svelte-o4la6q"),ne(e,"opacity",s[7]),ne(e,"transform","translateY("+(1-s[8])*20+"px)")},m(se,ie){q(se,e,ie),n(e,t),n(t,r),n(r,a),n(a,i),n(i,o),n(t,m),n(t,h),n(h,b),n(b,_),n(_,y),n(_,T),n(b,E),n(b,A),n(A,F),n(b,W),K&&K.m(b,null),n(h,R),G&&G.m(h,null),n(h,D),n(h,S),O&&O.m(S,null),n(S,k),n(S,L),n(S,P),te&&te.m(S,null),n(t,C),n(t,H),n(H,ee),n(e,Y),$&&$.m(e,null),n(e,X),ae&&ae.m(e,null),J||(Q=[ce(L,"click",s[12]),ce(ee,"click",s[12])],J=!0)},p(se,ie){ie&16&&u!==(u=co(se[4].category))&&c(o,"d",u),ie&16&&l!==(l="w-6 h-6 "+we.getErrorColor(se[4].severity)+" svelte-o4la6q")&&c(i,"class",l),ie&16&&d!==(d="w-12 h-12 rounded-full "+we.getErrorBackgroundColor(se[4].severity)+" flex items-center justify-center svelte-o4la6q")&&c(a,"class",d),ie&16&&w!==(w=uo(se[4].category)+"")&&de(y,w),ie&16&&M!==(M="text-lg font-semibold "+we.getErrorColor(se[4].severity)+" mb-2 svelte-o4la6q")&&c(_,"class",M),ie&16&&V!==(V=se[4].userMessage+"")&&de(F,V),se[0].fileName||se[0].attempt&&se[0].attempt>1?K?K.p(se,ie):(K=$i(se),K.c(),K.m(b,null)):K&&(K.d(1),K=null),se[4].suggestedActions.length>0?G?G.p(se,ie):(G=so(se),G.c(),G.m(h,D)):G&&(G.d(1),G=null),se[2]&&se[4].recoverable?O?O.p(se,ie):(O=ao(se),O.c(),O.m(S,k)):O&&(O.d(1),O=null),se[1]?te?te.p(se,ie):(te=io(se),te.c(),te.m(S,null)):te&&(te.d(1),te=null),se[1]&&se[5]?$?$.p(se,ie):($=oo(se),$.c(),$.m(e,X)):$&&($.d(1),$=null),se[3]&&se[4].displayDuration&&se[4].severity!=="critical"?ae?ae.p(se,ie):(ae=lo(se),ae.c(),ae.m(e,null)):ae&&(ae.d(1),ae=null),ie&16&&U!==(U="error-display "+we.getErrorBackgroundColor(se[4].severity)+" "+we.getErrorBorderColor(se[4].severity)+" border rounded-xl p-6 max-w-2xl mx-auto svelte-o4la6q")&&c(e,"class",U),ie&128&&ne(e,"opacity",se[7]),ie&256&&ne(e,"transform","translateY("+(1-se[8])*20+"px)")},d(se){se&&f(e),K&&K.d(),G&&G.d(),O&&O.d(),te&&te.d(),$&&$.d(),ae&&ae.d(),J=!1,Qe(Q)}}}function $i(s){let e,t,r=s[0].fileName&&eo(s),a=s[0].attempt&&s[0].attempt>1&&to(s);return{c(){e=g("div"),r&&r.c(),t=I(),a&&a.c(),this.h()},l(i){e=p(i,"DIV",{class:!0});var o=v(e);r&&r.l(o),t=x(o),a&&a.l(o),o.forEach(f),this.h()},h(){c(e,"class","text-sm text-dark-text-muted space-y-1")},m(i,o){q(i,e,o),r&&r.m(e,null),n(e,t),a&&a.m(e,null)},p(i,o){i[0].fileName?r?r.p(i,o):(r=eo(i),r.c(),r.m(e,t)):r&&(r.d(1),r=null),i[0].attempt&&i[0].attempt>1?a?a.p(i,o):(a=to(i),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(i){i&&f(e),r&&r.d(),a&&a.d()}}}function eo(s){let e,t,r="File:",a,i,o=s[0].fileName+"",u;return{c(){e=g("div"),t=g("span"),t.textContent=r,a=I(),i=g("span"),u=N(o),this.h()},l(l){e=p(l,"DIV",{class:!0});var d=v(e);t=p(d,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-g4vdly"&&(t.textContent=r),a=x(d),i=p(d,"SPAN",{class:!0});var m=v(i);u=z(m,o),m.forEach(f),d.forEach(f),this.h()},h(){c(i,"class","font-mono bg-dark-elevated px-2 py-1 rounded text-xs"),c(e,"class","flex items-center space-x-2")},m(l,d){q(l,e,d),n(e,t),n(e,a),n(e,i),n(i,u)},p(l,d){d&1&&o!==(o=l[0].fileName+"")&&de(u,o)},d(l){l&&f(e)}}}function to(s){let e,t,r="Attempt:",a,i,o=s[0].attempt+"",u;return{c(){e=g("div"),t=g("span"),t.textContent=r,a=I(),i=g("span"),u=N(o),this.h()},l(l){e=p(l,"DIV",{class:!0});var d=v(e);t=p(d,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-c9sg9r"&&(t.textContent=r),a=x(d),i=p(d,"SPAN",{class:!0});var m=v(i);u=z(m,o),m.forEach(f),d.forEach(f),this.h()},h(){c(i,"class","font-mono bg-dark-elevated px-2 py-1 rounded text-xs"),c(e,"class","flex items-center space-x-2")},m(l,d){q(l,e,d),n(e,t),n(e,a),n(e,i),n(i,u)},p(l,d){d&1&&o!==(o=l[0].attempt+"")&&de(u,o)},d(l){l&&f(e)}}}function so(s){let e,t,r="What you can do:",a,i,o=Je(s[4].suggestedActions),u=[];for(let l=0;l<o.length;l+=1)u[l]=ro(Zi(s,o,l));return{c(){e=g("div"),t=g("h4"),t.textContent=r,a=I(),i=g("ul");for(let l=0;l<u.length;l+=1)u[l].c();this.h()},l(l){e=p(l,"DIV",{class:!0});var d=v(e);t=p(d,"H4",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-x4n314"&&(t.textContent=r),a=x(d),i=p(d,"UL",{class:!0});var m=v(i);for(let h=0;h<u.length;h+=1)u[h].l(m);m.forEach(f),d.forEach(f),this.h()},h(){c(t,"class","text-sm font-medium text-dark-text mb-2"),c(i,"class","space-y-1"),c(e,"class","mb-4")},m(l,d){q(l,e,d),n(e,t),n(e,a),n(e,i);for(let m=0;m<u.length;m+=1)u[m]&&u[m].m(i,null)},p(l,d){if(d&16){o=Je(l[4].suggestedActions);let m;for(m=0;m<o.length;m+=1){const h=Zi(l,o,m);u[m]?u[m].p(h,d):(u[m]=ro(h),u[m].c(),u[m].m(i,null))}for(;m<u.length;m+=1)u[m].d(1);u.length=o.length}},d(l){l&&f(e),Vs(u,l)}}}function ro(s){let e,t,r,a,i,o=s[18]+"",u,l;return{c(){e=g("li"),t=Te("svg"),r=Te("path"),a=I(),i=g("span"),u=N(o),l=I(),this.h()},l(d){e=p(d,"LI",{class:!0});var m=v(e);t=Me(m,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var h=v(t);r=Me(h,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(r).forEach(f),h.forEach(f),a=x(m),i=p(m,"SPAN",{});var b=v(i);u=z(b,o),b.forEach(f),l=x(m),m.forEach(f),this.h()},h(){c(r,"stroke-linecap","round"),c(r,"stroke-linejoin","round"),c(r,"stroke-width","2"),c(r,"d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"),c(t,"class","w-4 h-4 text-magic-400 mt-0.5 flex-shrink-0"),c(t,"fill","none"),c(t,"stroke","currentColor"),c(t,"viewBox","0 0 24 24"),c(e,"class","flex items-start space-x-2 text-sm text-dark-text-secondary")},m(d,m){q(d,e,m),n(e,t),n(t,r),n(e,a),n(e,i),n(i,u),n(e,l)},p(d,m){m&16&&o!==(o=d[18]+"")&&de(u,o)},d(d){d&&f(e)}}}function ao(s){let e,t,r,a,i,o,u;return{c(){e=g("button"),t=Te("svg"),r=Te("path"),a=N(`
              Try Again`),this.h()},l(l){e=p(l,"BUTTON",{class:!0});var d=v(e);t=Me(d,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var m=v(t);r=Me(m,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(r).forEach(f),m.forEach(f),a=z(d,`
              Try Again`),d.forEach(f),this.h()},h(){c(r,"stroke-linecap","round"),c(r,"stroke-linejoin","round"),c(r,"stroke-width","2"),c(r,"d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"),c(t,"class","w-4 h-4 mr-2"),c(t,"fill","none"),c(t,"stroke","currentColor"),c(t,"viewBox","0 0 24 24"),c(e,"class",i="btn btn-outline "+we.getErrorBorderColor(s[4].severity)+" "+we.getErrorColor(s[4].severity)+" hover:"+we.getErrorBackgroundColor(s[4].severity)+" px-4 py-2 rounded-lg text-sm font-medium svelte-o4la6q")},m(l,d){q(l,e,d),n(e,t),n(t,r),n(e,a),o||(u=ce(e,"click",s[11]),o=!0)},p(l,d){d&16&&i!==(i="btn btn-outline "+we.getErrorBorderColor(l[4].severity)+" "+we.getErrorColor(l[4].severity)+" hover:"+we.getErrorBackgroundColor(l[4].severity)+" px-4 py-2 rounded-lg text-sm font-medium svelte-o4la6q")&&c(e,"class",i)},d(l){l&&f(e),o=!1,u()}}}function io(s){let e,t,r,a,i=s[5]?"Hide":"Show",o,u,l,d;return{c(){e=g("button"),t=Te("svg"),r=Te("path"),a=I(),o=N(i),u=N(" Details"),this.h()},l(m){e=p(m,"BUTTON",{class:!0});var h=v(e);t=Me(h,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var b=v(t);r=Me(b,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(r).forEach(f),b.forEach(f),a=x(h),o=z(h,i),u=z(h," Details"),h.forEach(f),this.h()},h(){c(r,"stroke-linecap","round"),c(r,"stroke-linejoin","round"),c(r,"stroke-width","2"),c(r,"d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),c(t,"class","w-4 h-4 mr-2"),c(t,"fill","none"),c(t,"stroke","currentColor"),c(t,"viewBox","0 0 24 24"),c(e,"class","btn btn-text text-dark-text-muted hover:text-dark-text px-4 py-2 rounded-lg text-sm svelte-o4la6q")},m(m,h){q(m,e,h),n(e,t),n(t,r),n(e,a),n(e,o),n(e,u),l||(d=ce(e,"click",s[13]),l=!0)},p(m,h){h&32&&i!==(i=m[5]?"Hide":"Show")&&de(o,i)},d(m){m&&f(e),l=!1,d()}}}function oo(s){let e,t,r,a="Technical Information",i,o,u,l,d="Category:",m,h=s[4].category+"",b,_,w,y,T="Severity:",M,E=s[4].severity+"",A,V,F,W,R="Recoverable:",D,S=s[4].recoverable?"Yes":"No",k,L,B,P,C,H="Technical Message:",ee,re,Y=s[4].technicalMessage+"",X,U=s[4].recommendedStrategy&&no(s);return{c(){e=g("div"),t=g("details"),r=g("summary"),r.textContent=a,i=I(),o=g("div"),u=g("div"),l=g("strong"),l.textContent=d,m=I(),b=N(h),_=I(),w=g("div"),y=g("strong"),y.textContent=T,M=I(),A=N(E),V=I(),F=g("div"),W=g("strong"),W.textContent=R,D=I(),k=N(S),L=I(),U&&U.c(),B=I(),P=g("div"),C=g("strong"),C.textContent=H,ee=I(),re=g("pre"),X=N(Y),this.h()},l(J){e=p(J,"DIV",{class:!0});var Q=v(e);t=p(Q,"DETAILS",{class:!0});var K=v(t);r=p(K,"SUMMARY",{class:!0,"data-svelte-h":!0}),Z(r)!=="svelte-tijuu7"&&(r.textContent=a),i=x(K),o=p(K,"DIV",{class:!0});var G=v(o);u=p(G,"DIV",{});var O=v(u);l=p(O,"STRONG",{"data-svelte-h":!0}),Z(l)!=="svelte-vdh0ps"&&(l.textContent=d),m=x(O),b=z(O,h),O.forEach(f),_=x(G),w=p(G,"DIV",{});var te=v(w);y=p(te,"STRONG",{"data-svelte-h":!0}),Z(y)!=="svelte-1tjye7f"&&(y.textContent=T),M=x(te),A=z(te,E),te.forEach(f),V=x(G),F=p(G,"DIV",{});var $=v(F);W=p($,"STRONG",{"data-svelte-h":!0}),Z(W)!=="svelte-1200pla"&&(W.textContent=R),D=x($),k=z($,S),$.forEach(f),L=x(G),U&&U.l(G),B=x(G),P=p(G,"DIV",{});var ae=v(P);C=p(ae,"STRONG",{"data-svelte-h":!0}),Z(C)!=="svelte-qmiw6"&&(C.textContent=H),ee=x(ae),re=p(ae,"PRE",{class:!0});var se=v(re);X=z(se,Y),se.forEach(f),ae.forEach(f),G.forEach(f),K.forEach(f),Q.forEach(f),this.h()},h(){c(r,"class","text-sm font-medium text-dark-text cursor-pointer hover:text-magic-400 svelte-o4la6q"),c(re,"class","mt-1 p-2 bg-dark-base rounded text-xs overflow-x-auto svelte-o4la6q"),c(o,"class","mt-3 space-y-2 text-xs text-dark-text-muted"),c(t,"class","space-y-3 svelte-o4la6q"),c(e,"class","mt-6 pt-4 border-t border-gray-600")},m(J,Q){q(J,e,Q),n(e,t),n(t,r),n(t,i),n(t,o),n(o,u),n(u,l),n(u,m),n(u,b),n(o,_),n(o,w),n(w,y),n(w,M),n(w,A),n(o,V),n(o,F),n(F,W),n(F,D),n(F,k),n(o,L),U&&U.m(o,null),n(o,B),n(o,P),n(P,C),n(P,ee),n(P,re),n(re,X)},p(J,Q){Q&16&&h!==(h=J[4].category+"")&&de(b,h),Q&16&&E!==(E=J[4].severity+"")&&de(A,E),Q&16&&S!==(S=J[4].recoverable?"Yes":"No")&&de(k,S),J[4].recommendedStrategy?U?U.p(J,Q):(U=no(J),U.c(),U.m(o,B)):U&&(U.d(1),U=null),Q&16&&Y!==(Y=J[4].technicalMessage+"")&&de(X,Y)},d(J){J&&f(e),U&&U.d()}}}function no(s){let e,t,r="Recommended Strategy:",a,i=s[4].recommendedStrategy+"",o;return{c(){e=g("div"),t=g("strong"),t.textContent=r,a=I(),o=N(i)},l(u){e=p(u,"DIV",{});var l=v(e);t=p(l,"STRONG",{"data-svelte-h":!0}),Z(t)!=="svelte-1fjhie8"&&(t.textContent=r),a=x(l),o=z(l,i),l.forEach(f)},m(u,l){q(u,e,l),n(e,t),n(e,a),n(e,o)},p(u,l){l&16&&i!==(i=u[4].recommendedStrategy+"")&&de(o,i)},d(u){u&&f(e)}}}function lo(s){let e,t,r;return{c(){e=g("div"),t=g("div"),this.h()},l(a){e=p(a,"DIV",{class:!0});var i=v(e);t=p(i,"DIV",{class:!0,style:!0}),v(t).forEach(f),i.forEach(f),this.h()},h(){c(t,"class",r="h-full "+we.getErrorBackgroundColor(s[4].severity)+" transition-all ease-linear svelte-o4la6q"),ne(t,"width","100%"),ne(t,"animation","countdown "+s[4].displayDuration+"ms linear"),c(e,"class","mt-4 h-1 bg-dark-base rounded-full overflow-hidden")},m(a,i){q(a,e,i),n(e,t)},p(a,i){i&16&&r!==(r="h-full "+we.getErrorBackgroundColor(a[4].severity)+" transition-all ease-linear svelte-o4la6q")&&c(t,"class",r),i&16&&ne(t,"animation","countdown "+a[4].displayDuration+"ms linear")},d(a){a&&f(e)}}}function wl(s){let e,t=s[6]&&s[4]&&Xi(s);return{c(){t&&t.c(),e=ot()},l(r){t&&t.l(r),e=ot()},m(r,a){t&&t.m(r,a),q(r,e,a)},p(r,[a]){r[6]&&r[4]?t?t.p(r,a):(t=Xi(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ce,o:Ce,d(r){r&&f(e),t&&t.d(r)}}}function co(s){const e={network:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0",file_validation:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",processing_failure:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z",browser_compatibility:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z",quota_exceeded:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z",server_error:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2",unknown:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"};return e[s]||e.unknown}function uo(s){return s.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function kl(s,e,t){let r,a,{error:i}=e,{context:o={}}=e,{showTechnicalDetails:u=!1}=e,{allowRetry:l=!0}=e,{autoHide:d=!0}=e;const m=zt();let h=We(0,{duration:400,easing:Nt});ze(s,h,F=>t(8,a=F));let b=We(1,{duration:300,easing:Nt});ze(s,b,F=>t(7,r=F));let _,w=!1,y,T=!0;Ut(()=>{h.set(1),M()});function M(){y&&clearTimeout(y),d&&(_!=null&&_.displayDuration)&&_.severity!=="critical"&&(y=setTimeout(()=>{A()},_.displayDuration))}function E(){m("retry")}function A(){y&&clearTimeout(y),b.set(0).then(()=>{t(6,T=!1),m("dismiss")})}function V(){t(5,w=!w),w&&m("showTechnical")}return s.$$set=F=>{"error"in F&&t(14,i=F.error),"context"in F&&t(0,o=F.context),"showTechnicalDetails"in F&&t(1,u=F.showTechnicalDetails),"allowRetry"in F&&t(2,l=F.allowRetry),"autoHide"in F&&t(3,d=F.autoHide)},s.$$.update=()=>{s.$$.dirty&16385&&(t(4,_=we.classifyError(i,o)),M())},[o,u,l,d,_,w,T,r,a,h,b,E,A,V,i]}class El extends lt{constructor(e){super(),ct(this,e,kl,wl,nt,{error:14,context:0,showTechnicalDetails:1,allowRetry:2,autoHide:3})}}class Dl{constructor(){Le(this,"isEnabled",!0);Le(this,"sessionHash");Le(this,"sessionStartTime");Le(this,"sessionMetrics");this.sessionHash=this.generateSessionHash(),this.sessionStartTime=Date.now(),this.sessionMetrics={session_hash:this.sessionHash,start_time:this.sessionStartTime,images_processed:0,total_processing_time:0,successful_completions:0,failed_attempts:0,meets_continuity_target:!1,session_duration:0},this.initializeSession()}generateSessionHash(){const e=Date.now().toString(),t=Math.random().toString(36).substring(2),r=`${e}_${t}`;let a=0;for(let i=0;i<r.length;i++){const o=r.charCodeAt(i);a=(a<<5)-a+o,a=a&a}return`session_${Math.abs(a).toString(36)}`}async sendEvent(e){if(this.isEnabled)try{console.log("📊 Analytics Event:",e)}catch(t){console.warn("Analytics event failed:",t)}}async initializeSession(){typeof window>"u"||await this.trackEvent("session_start",{user_agent:navigator.userAgent.substring(0,100),screen_resolution:`${screen.width}x${screen.height}`,viewport_size:`${window.innerWidth}x${window.innerHeight}`,referrer:(typeof document<"u"?document.referrer:"")||"direct",timestamp:new Date().toISOString()})}async trackEvent(e,t){const r={event_type:e,session_hash:this.sessionHash,timestamp:new Date().toISOString(),data:t||{}};await this.sendEvent(r)}async trackUniqueUser(e){await this.trackEvent("unique_session",{referrer:e||(typeof document<"u"?document.referrer:"")||"direct",is_return_user:this.isReturnUser()})}async trackProcessingStart(e,t){this.sessionMetrics.images_processed++,await this.trackEvent("processing_start",{input_method:t,file_size:e.file.size,file_type:e.file.type,image_dimensions:e.dimensions})}async trackTaskCompletion(e,t,r){this.sessionMetrics.total_processing_time+=t,e?this.sessionMetrics.successful_completions++:this.sessionMetrics.failed_attempts++,await this.trackEvent("task_completion",{success:e,processing_time_seconds:t,under_5_seconds:t<5,error_type:r?this.classifyError(r):void 0})}async trackSessionContinuity(){this.sessionMetrics.meets_continuity_target=this.sessionMetrics.images_processed>=2,await this.trackEvent("session_continuity",{images_processed:this.sessionMetrics.images_processed,meets_target:this.sessionMetrics.meets_continuity_target,avg_processing_time:this.sessionMetrics.total_processing_time/Math.max(1,this.sessionMetrics.successful_completions)})}async trackDownload(e,t){await this.trackEvent("download",{format:e,file_size:t,time_to_download:Date.now()-this.sessionStartTime})}async trackProcessAnother(){await this.trackEvent("process_another",{session_images_count:this.sessionMetrics.images_processed,session_duration:Date.now()-this.sessionStartTime})}async trackNPSResponse(e,t){await this.trackEvent("nps_response",{score:e,has_feedback:!!t,feedback_length:(t==null?void 0:t.length)||0,session_images_processed:this.sessionMetrics.images_processed})}async trackFeedbackSubmission(e,t){await this.trackEvent("feedback_submission",{feedback_type:e,content_length:t.length,session_context:{images_processed:this.sessionMetrics.images_processed,successful_completions:this.sessionMetrics.successful_completions,failed_attempts:this.sessionMetrics.failed_attempts}})}async endSession(){this.sessionMetrics.session_duration=Date.now()-this.sessionStartTime,await this.trackEvent("session_end",{session_summary:this.sessionMetrics,completion_rate:this.sessionMetrics.successful_completions/Math.max(1,this.sessionMetrics.images_processed),avg_processing_time:this.sessionMetrics.total_processing_time/Math.max(1,this.sessionMetrics.successful_completions)})}isReturnUser(){return typeof window>"u"?!1:localStorage.getItem("charactercut_visited")?!0:(localStorage.setItem("charactercut_visited","1"),!1)}classifyError(e){const t=e.toLowerCase();return t.includes("network")||t.includes("fetch")?"network":t.includes("size")||t.includes("large")?"file_size":t.includes("format")||t.includes("type")?"file_format":t.includes("timeout")?"timeout":"unknown"}get sessionId(){return this.sessionHash}get metrics(){return{...this.sessionMetrics}}setEnabled(e){this.isEnabled=e}}const Pe=new Dl;typeof window<"u"&&window.addEventListener("beforeunload",()=>{Pe.endSession()});function fo(s,e,t){const r=s.slice();return r[22]=e[t],r[24]=t,r}function mo(s){let e;function t(i,o){return i[5]?Cl:Il}let r=t(s),a=r(s);return{c(){e=g("div"),a.c(),this.h()},l(i){e=p(i,"DIV",{class:!0,style:!0});var o=v(e);a.l(o),o.forEach(f),this.h()},h(){c(e,"class","nps-survey fixed bottom-6 right-6 max-w-sm bg-dark-elevated border border-magic-400/20 rounded-xl p-6 shadow-2xl z-50 svelte-gf0zay"),ne(e,"opacity",s[7]),ne(e,"transform","translateY("+(1-s[8])*20+"px)")},m(i,o){q(i,e,o),a.m(e,null)},p(i,o){r===(r=t(i))&&a?a.p(i,o):(a.d(1),a=r(i),a&&(a.c(),a.m(e,null))),o&128&&ne(e,"opacity",i[7]),o&256&&ne(e,"transform","translateY("+(1-i[8])*20+"px)")},d(i){i&&f(e),a.d()}}}function Cl(s){let e,t,r='<svg class="w-6 h-6 text-green-400 svelte-gf0zay" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" class="svelte-gf0zay"></path></svg>',a,i,o='<h3 class="text-lg font-semibold text-green-400 mb-1 svelte-gf0zay">Thank you!</h3> <p class="text-sm text-dark-text-secondary svelte-gf0zay">Your feedback helps us make CharacterCut better for all developers.</p>',u,l=s[1]!==null&&s[1]>=9&&go();return{c(){e=g("div"),t=g("div"),t.innerHTML=r,a=I(),i=g("div"),i.innerHTML=o,u=I(),l&&l.c(),this.h()},l(d){e=p(d,"DIV",{class:!0});var m=v(e);t=p(m,"DIV",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1bnve69"&&(t.innerHTML=r),a=x(m),i=p(m,"DIV",{class:!0,"data-svelte-h":!0}),Z(i)!=="svelte-czl7e"&&(i.innerHTML=o),u=x(m),l&&l.l(m),m.forEach(f),this.h()},h(){c(t,"class","w-12 h-12 mx-auto rounded-full bg-green-400/20 flex items-center justify-center svelte-gf0zay"),c(i,"class","svelte-gf0zay"),c(e,"class","text-center space-y-3 svelte-gf0zay")},m(d,m){q(d,e,m),n(e,t),n(e,a),n(e,i),n(e,u),l&&l.m(e,null)},p(d,m){d[1]!==null&&d[1]>=9?l||(l=go(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(d){d&&f(e),l&&l.d()}}}function Il(s){let e,t,r,a='<h3 class="text-lg font-semibold text-magic-gradient mb-1 svelte-gf0zay">Quick feedback?</h3> <p class="text-sm text-dark-text-secondary svelte-gf0zay">Help us improve CharacterCut for developers like you</p>',i,o,u='<svg class="w-4 h-4 svelte-gf0zay" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-gf0zay"></path></svg>',l,d,m,h="How likely are you to recommend CharacterCut to other developers?",b,_,w,y,T,M='<span class="svelte-gf0zay">Not likely</span> <span class="svelte-gf0zay">Very likely</span>',E,A,V,F,W=Je(Array(11)),R=[];for(let k=0;k<W.length;k+=1)R[k]=po(fo(s,W,k));let D=s[3]&&s[1]!==null&&ho(s),S=s[1]!==null&&bo(s);return{c(){e=g("div"),t=g("div"),r=g("div"),r.innerHTML=a,i=I(),o=g("button"),o.innerHTML=u,l=I(),d=g("div"),m=g("p"),m.textContent=h,b=I(),_=g("div"),w=g("div");for(let k=0;k<R.length;k+=1)R[k].c();y=I(),T=g("div"),T.innerHTML=M,E=I(),D&&D.c(),A=I(),S&&S.c(),this.h()},l(k){e=p(k,"DIV",{class:!0});var L=v(e);t=p(L,"DIV",{class:!0});var B=v(t);r=p(B,"DIV",{class:!0,"data-svelte-h":!0}),Z(r)!=="svelte-1034g7d"&&(r.innerHTML=a),i=x(B),o=p(B,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(o)!=="svelte-182shzu"&&(o.innerHTML=u),B.forEach(f),l=x(L),d=p(L,"DIV",{class:!0});var P=v(d);m=p(P,"P",{class:!0,"data-svelte-h":!0}),Z(m)!=="svelte-16p3lp3"&&(m.textContent=h),b=x(P),_=p(P,"DIV",{class:!0});var C=v(_);w=p(C,"DIV",{class:!0});var H=v(w);for(let ee=0;ee<R.length;ee+=1)R[ee].l(H);H.forEach(f),y=x(C),T=p(C,"DIV",{class:!0,"data-svelte-h":!0}),Z(T)!=="svelte-qpw09z"&&(T.innerHTML=M),C.forEach(f),P.forEach(f),E=x(L),D&&D.l(L),A=x(L),S&&S.l(L),L.forEach(f),this.h()},h(){c(r,"class","svelte-gf0zay"),c(o,"class","text-dark-text-muted hover:text-dark-text p-1 rounded transition-colors svelte-gf0zay"),c(t,"class","flex items-start justify-between svelte-gf0zay"),c(m,"class","text-sm text-dark-text svelte-gf0zay"),c(w,"class","grid grid-cols-11 gap-1 svelte-gf0zay"),c(T,"class","flex justify-between text-xs text-dark-text-muted svelte-gf0zay"),c(_,"class","space-y-2 svelte-gf0zay"),c(d,"class","space-y-3 svelte-gf0zay"),c(e,"class","space-y-4 svelte-gf0zay")},m(k,L){q(k,e,L),n(e,t),n(t,r),n(t,i),n(t,o),n(e,l),n(e,d),n(d,m),n(d,b),n(d,_),n(_,w);for(let B=0;B<R.length;B+=1)R[B]&&R[B].m(w,null);n(_,y),n(_,T),n(e,E),D&&D.m(e,null),n(e,A),S&&S.m(e,null),V||(F=ce(o,"click",s[13]),V=!0)},p(k,L){if(L&2050){W=Je(Array(11));let B;for(B=0;B<W.length;B+=1){const P=fo(k,W,B);R[B]?R[B].p(P,L):(R[B]=po(P),R[B].c(),R[B].m(w,null))}for(;B<R.length;B+=1)R[B].d(1);R.length=W.length}k[3]&&k[1]!==null?D?D.p(k,L):(D=ho(k),D.c(),D.m(e,A)):D&&(D.d(1),D=null),k[1]!==null?S?S.p(k,L):(S=bo(k),S.c(),S.m(e,null)):S&&(S.d(1),S=null)},d(k){k&&f(e),Vs(R,k),D&&D.d(),S&&S.d(),V=!1,F()}}}function go(s){let e,t="🚀 Consider sharing CharacterCut with your developer community!";return{c(){e=g("div"),e.textContent=t,this.h()},l(r){e=p(r,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-fnbpm1"&&(e.textContent=t),this.h()},h(){c(e,"class","text-xs text-magic-300 svelte-gf0zay")},m(r,a){q(r,e,a)},d(r){r&&f(e)}}}function po(s){let e,t,r,a,i;function o(){return s[17](s[24])}return{c(){e=g("button"),t=N(s[24]),r=I(),this.h()},l(u){e=p(u,"BUTTON",{class:!0});var l=v(e);t=z(l,s[24]),r=x(l),l.forEach(f),this.h()},h(){c(e,"class","score-button w-8 h-8 rounded-md border text-xs font-medium transition-all svelte-gf0zay"),be(e,"selected",s[1]===s[24]),be(e,"hover-effect",s[1]!==s[24]),be(e,"border-magic-400",s[1]===s[24]),be(e,"bg-magic-400",s[1]===s[24]),be(e,"text-white",s[1]===s[24]),be(e,"border-gray-600",s[1]!==s[24]),be(e,"text-dark-text-muted",s[1]!==s[24]),be(e,"hover:border-magic-400",s[1]!==s[24]),be(e,"hover:text-magic-400",s[1]!==s[24])},m(u,l){q(u,e,l),n(e,t),n(e,r),a||(i=ce(e,"click",o),a=!0)},p(u,l){s=u,l&2&&be(e,"selected",s[1]===s[24]),l&2&&be(e,"hover-effect",s[1]!==s[24]),l&2&&be(e,"border-magic-400",s[1]===s[24]),l&2&&be(e,"bg-magic-400",s[1]===s[24]),l&2&&be(e,"text-white",s[1]===s[24]),l&2&&be(e,"border-gray-600",s[1]!==s[24]),l&2&&be(e,"text-dark-text-muted",s[1]!==s[24]),l&2&&be(e,"hover:border-magic-400",s[1]!==s[24]),l&2&&be(e,"hover:text-magic-400",s[1]!==s[24])},d(u){u&&f(e),a=!1,i()}}}function ho(s){let e,t,r,a,i=_o(s[1])+"",o,u,l,d,m,h=s[6]&&vo(s);return{c(){e=g("div"),h&&h.c(),t=I(),r=g("div"),a=g("label"),o=N(i),u=I(),l=g("textarea"),this.h()},l(b){e=p(b,"DIV",{class:!0});var _=v(e);h&&h.l(_),t=x(_),r=p(_,"DIV",{class:!0});var w=v(r);a=p(w,"LABEL",{class:!0});var y=v(a);o=z(y,i),y.forEach(f),u=x(w),l=p(w,"TEXTAREA",{placeholder:!0,class:!0,rows:!0}),v(l).forEach(f),w.forEach(f),_.forEach(f),this.h()},h(){c(a,"class","block text-sm text-dark-text mb-2 svelte-gf0zay"),c(l,"placeholder","Your thoughts help us improve..."),c(l,"class","w-full px-3 py-2 bg-dark-base border border-gray-600 rounded-lg text-dark-text placeholder-dark-text-muted text-sm resize-none focus:border-magic-400 focus:outline-none svelte-gf0zay"),c(l,"rows","3"),c(r,"class","svelte-gf0zay"),c(e,"class","space-y-3 pt-2 border-t border-gray-700 svelte-gf0zay")},m(b,_){q(b,e,_),h&&h.m(e,null),n(e,t),n(e,r),n(r,a),n(a,o),n(r,u),n(r,l),gs(l,s[2]),d||(m=ce(l,"input",s[18]),d=!0)},p(b,_){b[6]?h?h.p(b,_):(h=vo(b),h.c(),h.m(e,t)):h&&(h.d(1),h=null),_&2&&i!==(i=_o(b[1])+"")&&de(o,i),_&4&&gs(l,b[2])},d(b){b&&f(e),h&&h.d(),d=!1,m()}}}function vo(s){let e,t=s[6]==="promoter"?"🎉 Promoter":s[6]==="passive"?"😐 Passive":"😟 Detractor",r,a;return{c(){e=g("div"),r=N(t),this.h()},l(i){e=p(i,"DIV",{class:!0});var o=v(e);r=z(o,t),o.forEach(f),this.h()},h(){c(e,"class",a="text-xs "+s[14][s[6]]+" px-2 py-1 border rounded text-center svelte-gf0zay")},m(i,o){q(i,e,o),n(e,r)},p(i,o){o&64&&t!==(t=i[6]==="promoter"?"🎉 Promoter":i[6]==="passive"?"😐 Passive":"😟 Detractor")&&de(r,t),o&64&&a!==(a="text-xs "+i[14][i[6]]+" px-2 py-1 border rounded text-center svelte-gf0zay")&&c(e,"class",a)},d(i){i&&f(e)}}}function bo(s){let e,t,r,a,i="Skip",o,u;function l(h,b){return h[4]?Sl:xl}let d=l(s),m=d(s);return{c(){e=g("div"),t=g("button"),m.c(),r=I(),a=g("button"),a.textContent=i,this.h()},l(h){e=p(h,"DIV",{class:!0});var b=v(e);t=p(b,"BUTTON",{class:!0});var _=v(t);m.l(_),_.forEach(f),r=x(b),a=p(b,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(a)!=="svelte-1xvqh9h"&&(a.textContent=i),b.forEach(f),this.h()},h(){t.disabled=s[4],c(t,"class","flex-1 btn btn-magic py-2 px-4 rounded-lg text-sm font-medium disabled:opacity-50 svelte-gf0zay"),c(a,"class","px-4 py-2 text-dark-text-muted hover:text-dark-text transition-colors text-sm svelte-gf0zay"),c(e,"class","flex space-x-2 pt-2 svelte-gf0zay")},m(h,b){q(h,e,b),n(e,t),m.m(t,null),n(e,r),n(e,a),o||(u=[ce(t,"click",s[12]),ce(a,"click",s[13])],o=!0)},p(h,b){d!==(d=l(h))&&(m.d(1),m=d(h),m&&(m.c(),m.m(t,null))),b&16&&(t.disabled=h[4])},d(h){h&&f(e),m.d(),o=!1,Qe(u)}}}function xl(s){let e;return{c(){e=N("Submit")},l(t){e=z(t,"Submit")},m(t,r){q(t,e,r)},d(t){t&&f(e)}}}function Sl(s){let e,t,r;return{c(){e=Te("svg"),t=Te("path"),r=N(`
                Submitting...`),this.h()},l(a){e=Me(a,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var i=v(e);t=Me(i,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0,class:!0}),v(t).forEach(f),i.forEach(f),r=z(a,`
                Submitting...`),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"stroke-width","2"),c(t,"d","M12 6v6m0 0v6m0-6h6m-6 0H6"),c(t,"class","svelte-gf0zay"),c(e,"class","w-4 h-4 mr-2 animate-spin svelte-gf0zay"),c(e,"fill","none"),c(e,"stroke","currentColor"),c(e,"viewBox","0 0 24 24")},m(a,i){q(a,e,i),n(e,t),q(a,r,i)},d(a){a&&(f(e),f(r))}}}function Pl(s){let e,t=s[0]&&mo(s);return{c(){t&&t.c(),e=ot()},l(r){t&&t.l(r),e=ot()},m(r,a){t&&t.m(r,a),q(r,e,a)},p(r,[a]){r[0]?t?t.p(r,a):(t=mo(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ce,o:Ce,d(r){r&&f(e),t&&t.d(r)}}}function Tl(s){return s>=9?"promoter":s>=7?"passive":"detractor"}function _o(s){return s>=9?"What did you love most about CharacterCut?":s>=7?"What would make CharacterCut even better?":"What can we improve to make this more useful for you?"}function Ml(s,e,t){let r,a,i,{visible:o=!1}=e,{imagesProcessed:u=0}=e,{autoShowDelay:l=5e3}=e;const d=zt();let m=null,h="",b=!1,_=!1,w=!1,y=We(0,{duration:400,easing:Nt});ze(s,y,R=>t(8,i=R));let T=We(1,{duration:300,easing:Nt});ze(s,T,R=>t(7,a=R)),Ut(()=>{o&&y.set(1)});function M(R){t(1,m=R),t(3,b=!0)}async function E(){if(m!==null){t(4,_=!0);try{await Pe.trackNPSResponse(m,h),d("submit",{score:m,feedback:h.trim()||void 0}),t(5,w=!0),setTimeout(()=>{A()},2e3)}catch(R){console.error("Failed to submit NPS:",R),t(5,w=!0),setTimeout(()=>{A()},2e3)}finally{t(4,_=!1)}}}async function A(){T.set(0).then(()=>{t(0,o=!1),d("dismiss")})}const V={promoter:"text-green-400 border-green-400/30",passive:"text-yellow-400 border-yellow-400/30",detractor:"text-red-400 border-red-400/30"},F=R=>M(R);function W(){h=this.value,t(2,h)}return s.$$set=R=>{"visible"in R&&t(0,o=R.visible),"imagesProcessed"in R&&t(15,u=R.imagesProcessed),"autoShowDelay"in R&&t(16,l=R.autoShowDelay)},s.$$.update=()=>{s.$$.dirty&2&&t(6,r=m!==null?Tl(m):null),s.$$.dirty&1&&o&&y.set(1)},[o,m,h,b,_,w,r,a,i,y,T,M,E,A,V,u,l,F,W]}class Rl extends lt{constructor(e){super(),ct(this,e,Ml,Pl,nt,{visible:0,imagesProcessed:15,autoShowDelay:16})}}function yo(s,e,t){const r=s.slice();return r[23]=e[t][0],r[24]=e[t][1],r}function wo(s){let e,t;function r(o,u){return o[7]?Al:Fl}let a=r(s),i=a(s);return{c(){e=g("div"),t=g("div"),i.c(),this.h()},l(o){e=p(o,"DIV",{class:!0});var u=v(e);t=p(u,"DIV",{class:!0});var l=v(t);i.l(l),l.forEach(f),u.forEach(f),this.h()},h(){c(t,"class","feedback-modal bg-dark-elevated border border-magic-400/20 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto svelte-1adc9lu"),c(e,"class","fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50")},m(o,u){q(o,e,u),n(e,t),i.m(t,null)},p(o,u){a===(a=r(o))&&i?i.p(o,u):(i.d(1),i=a(o),i&&(i.c(),i.m(t,null)))},d(o){o&&f(e),i.d()}}}function Al(s){let e,t,r='<svg class="w-8 h-8 text-green-400 svelte-1adc9lu" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" class="svelte-1adc9lu"></path></svg>',a,i,o,u="Thank you for your feedback!",l,d,m,h,b,_="🚀 Keep an eye out for improvements based on your suggestions!",w=s[4]&&ko();return{c(){e=g("div"),t=g("div"),t.innerHTML=r,a=I(),i=g("div"),o=g("h3"),o.textContent=u,l=I(),d=g("p"),m=N(`Your insights help us make CharacterCut better for developers everywhere.
              `),w&&w.c(),h=I(),b=g("div"),b.textContent=_,this.h()},l(y){e=p(y,"DIV",{class:!0});var T=v(e);t=p(T,"DIV",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-19zowm5"&&(t.innerHTML=r),a=x(T),i=p(T,"DIV",{class:!0});var M=v(i);o=p(M,"H3",{class:!0,"data-svelte-h":!0}),Z(o)!=="svelte-1bd7jer"&&(o.textContent=u),l=x(M),d=p(M,"P",{class:!0});var E=v(d);m=z(E,`Your insights help us make CharacterCut better for developers everywhere.
              `),w&&w.l(E),E.forEach(f),M.forEach(f),h=x(T),b=p(T,"DIV",{class:!0,"data-svelte-h":!0}),Z(b)!=="svelte-1jbg583"&&(b.textContent=_),T.forEach(f),this.h()},h(){c(t,"class","w-16 h-16 mx-auto rounded-full bg-green-400/20 flex items-center justify-center svelte-1adc9lu"),c(o,"class","text-xl font-semibold text-green-400 mb-2 svelte-1adc9lu"),c(d,"class","text-dark-text-secondary svelte-1adc9lu"),c(i,"class","svelte-1adc9lu"),c(b,"class","text-sm text-magic-300 svelte-1adc9lu"),c(e,"class","p-8 text-center space-y-4 svelte-1adc9lu")},m(y,T){q(y,e,T),n(e,t),n(e,a),n(e,i),n(i,o),n(i,l),n(i,d),n(d,m),w&&w.m(d,null),n(e,h),n(e,b)},p(y,T){y[4]?w||(w=ko(),w.c(),w.m(d,null)):w&&(w.d(1),w=null)},d(y){y&&f(e),w&&w.d()}}}function Fl(s){let e,t,r,a='<h3 class="text-xl font-semibold text-magic-gradient mb-2 svelte-1adc9lu">Share Your Feedback</h3> <p class="text-sm text-dark-text-secondary svelte-1adc9lu">Help us make CharacterCut better for developers like you</p>',i,o,u='<svg class="w-5 h-5 svelte-1adc9lu" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-1adc9lu"></path></svg>',l,d,m,h="What type of feedback is this?",b,_,w,y,T,M,E="Your feedback",A,V,F,W,R=s[8]<10?"(minimum 10)":"",D,S,k,L,B,P,C,H,ee="Email (optional)",re,Y,X,U,J="Only provide if you'd like us to follow up. We respect your privacy.",Q,K,G,O,te,$,ae="Include technical context (helps us understand your situation better)",se,ie=s[5]&&Object.keys(s[1]).length>0,ge,j,_e,Ie,Ee,ye,Ge="Cancel",Ye,Re,He=Je(Object.entries(s[11])),xe=[];for(let le=0;le<He.length;le+=1)xe[le]=Eo(yo(s,He,le));let he=s[9].examples.length>0&&Do(s),De=ie&&Co(s);function js(le,fe){return le[6]?Bl:Vl}let yt=js(s),ke=yt(s);return{c(){e=g("div"),t=g("div"),r=g("div"),r.innerHTML=a,i=I(),o=g("button"),o.innerHTML=u,l=I(),d=g("div"),m=g("label"),m.textContent=h,b=I(),_=g("div");for(let le=0;le<xe.length;le+=1)xe[le].c();w=I(),y=g("div"),T=g("div"),M=g("label"),M.textContent=E,A=I(),V=g("span"),F=N(s[8]),W=N(" characters "),D=N(R),S=I(),k=g("textarea"),B=I(),he&&he.c(),P=I(),C=g("div"),H=g("label"),H.textContent=ee,re=I(),Y=g("input"),X=I(),U=g("p"),U.textContent=J,Q=I(),K=g("div"),G=g("label"),O=g("input"),te=I(),$=g("span"),$.textContent=ae,se=I(),De&&De.c(),ge=I(),j=g("div"),_e=g("button"),ke.c(),Ee=I(),ye=g("button"),ye.textContent=Ge,this.h()},l(le){e=p(le,"DIV",{class:!0});var fe=v(e);t=p(fe,"DIV",{class:!0});var pe=v(t);r=p(pe,"DIV",{class:!0,"data-svelte-h":!0}),Z(r)!=="svelte-179tctb"&&(r.innerHTML=a),i=x(pe),o=p(pe,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(o)!=="svelte-1jbsco1"&&(o.innerHTML=u),pe.forEach(f),l=x(fe),d=p(fe,"DIV",{class:!0});var Ze=v(d);m=p(Ze,"LABEL",{class:!0,"data-svelte-h":!0}),Z(m)!=="svelte-p24gya"&&(m.textContent=h),b=x(Ze),_=p(Ze,"DIV",{class:!0});var hs=v(_);for(let $e=0;$e<xe.length;$e+=1)xe[$e].l(hs);hs.forEach(f),Ze.forEach(f),w=x(fe),y=p(fe,"DIV",{class:!0});var Ue=v(y);T=p(Ue,"DIV",{class:!0});var Ht=v(T);M=p(Ht,"LABEL",{class:!0,"data-svelte-h":!0}),Z(M)!=="svelte-103pnj1"&&(M.textContent=E),A=x(Ht),V=p(Ht,"SPAN",{class:!0});var wt=v(V);F=z(wt,s[8]),W=z(wt," characters "),D=z(wt,R),wt.forEach(f),Ht.forEach(f),S=x(Ue),k=p(Ue,"TEXTAREA",{placeholder:!0,class:!0,rows:!0}),v(k).forEach(f),B=x(Ue),he&&he.l(Ue),Ue.forEach(f),P=x(fe),C=p(fe,"DIV",{class:!0});var Xe=v(C);H=p(Xe,"LABEL",{class:!0,"data-svelte-h":!0}),Z(H)!=="svelte-1ywtpsi"&&(H.textContent=ee),re=x(Xe),Y=p(Xe,"INPUT",{type:!0,placeholder:!0,class:!0}),X=x(Xe),U=p(Xe,"P",{class:!0,"data-svelte-h":!0}),Z(U)!=="svelte-va0wj3"&&(U.textContent=J),Xe.forEach(f),Q=x(fe),K=p(fe,"DIV",{class:!0});var qt=v(K);G=p(qt,"LABEL",{class:!0});var kt=v(G);O=p(kt,"INPUT",{type:!0,class:!0}),te=x(kt),$=p(kt,"SPAN",{class:!0,"data-svelte-h":!0}),Z($)!=="svelte-sohnzt"&&($.textContent=ae),kt.forEach(f),se=x(qt),De&&De.l(qt),qt.forEach(f),ge=x(fe),j=p(fe,"DIV",{class:!0});var Et=v(j);_e=p(Et,"BUTTON",{class:!0});var ut=v(_e);ke.l(ut),ut.forEach(f),Ee=x(Et),ye=p(Et,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(ye)!=="svelte-1ibbsx6"&&(ye.textContent=Ge),Et.forEach(f),fe.forEach(f),this.h()},h(){c(r,"class","svelte-1adc9lu"),c(o,"class","text-dark-text-muted hover:text-dark-text p-2 rounded transition-colors svelte-1adc9lu"),c(t,"class","flex items-start justify-between svelte-1adc9lu"),c(m,"class","block text-sm font-medium text-dark-text svelte-1adc9lu"),c(_,"class","grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-1adc9lu"),c(d,"class","space-y-3 svelte-1adc9lu"),c(M,"class","block text-sm font-medium text-dark-text svelte-1adc9lu"),c(V,"class","text-xs text-dark-text-muted svelte-1adc9lu"),c(T,"class","flex items-center justify-between svelte-1adc9lu"),c(k,"placeholder",L=s[9].placeholder),c(k,"class","w-full px-4 py-3 bg-dark-base border border-gray-600 rounded-lg text-dark-text placeholder-dark-text-muted resize-none focus:border-magic-400 focus:outline-none transition-colors svelte-1adc9lu"),c(k,"rows","6"),c(y,"class","space-y-3 svelte-1adc9lu"),c(H,"class","block text-sm font-medium text-dark-text svelte-1adc9lu"),c(Y,"type","email"),c(Y,"placeholder","your.email@example.com"),c(Y,"class","w-full px-4 py-3 bg-dark-base border border-gray-600 rounded-lg text-dark-text placeholder-dark-text-muted focus:border-magic-400 focus:outline-none transition-colors svelte-1adc9lu"),c(U,"class","text-xs text-dark-text-muted svelte-1adc9lu"),c(C,"class","space-y-3 svelte-1adc9lu"),c(O,"type","checkbox"),c(O,"class","w-4 h-4 text-magic-400 border-gray-600 rounded focus:ring-magic-400 svelte-1adc9lu"),c($,"class","text-sm text-dark-text svelte-1adc9lu"),c(G,"class","flex items-center space-x-3 svelte-1adc9lu"),c(K,"class","space-y-3 svelte-1adc9lu"),_e.disabled=Ie=!s[10]||s[6],c(_e,"class","flex-1 btn btn-magic py-3 px-6 rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed svelte-1adc9lu"),c(ye,"class","px-6 py-3 text-dark-text-muted hover:text-dark-text transition-colors font-medium svelte-1adc9lu"),c(j,"class","flex flex-col sm:flex-row gap-3 pt-4 border-t border-gray-700 svelte-1adc9lu"),c(e,"class","p-6 space-y-6 svelte-1adc9lu")},m(le,fe){q(le,e,fe),n(e,t),n(t,r),n(t,i),n(t,o),n(e,l),n(e,d),n(d,m),n(d,b),n(d,_);for(let pe=0;pe<xe.length;pe+=1)xe[pe]&&xe[pe].m(_,null);n(e,w),n(e,y),n(y,T),n(T,M),n(T,A),n(T,V),n(V,F),n(V,W),n(V,D),n(y,S),n(y,k),gs(k,s[3]),n(y,B),he&&he.m(y,null),n(e,P),n(e,C),n(C,H),n(C,re),n(C,Y),gs(Y,s[4]),n(C,X),n(C,U),n(e,Q),n(e,K),n(K,G),n(G,O),O.checked=s[5],n(G,te),n(G,$),n(K,se),De&&De.m(K,null),n(e,ge),n(e,j),n(j,_e),ke.m(_e,null),n(j,Ee),n(j,ye),Ye||(Re=[ce(o,"click",s[13]),ce(k,"input",s[19]),ce(Y,"input",s[20]),ce(O,"change",s[21]),ce(_e,"click",s[12]),ce(ye,"click",s[13])],Ye=!0)},p(le,fe){if(fe&18436){He=Je(Object.entries(le[11]));let pe;for(pe=0;pe<He.length;pe+=1){const Ze=yo(le,He,pe);xe[pe]?xe[pe].p(Ze,fe):(xe[pe]=Eo(Ze),xe[pe].c(),xe[pe].m(_,null))}for(;pe<xe.length;pe+=1)xe[pe].d(1);xe.length=He.length}fe&256&&de(F,le[8]),fe&256&&R!==(R=le[8]<10?"(minimum 10)":"")&&de(D,R),fe&512&&L!==(L=le[9].placeholder)&&c(k,"placeholder",L),fe&8&&gs(k,le[3]),le[9].examples.length>0?he?he.p(le,fe):(he=Do(le),he.c(),he.m(y,null)):he&&(he.d(1),he=null),fe&16&&Y.value!==le[4]&&gs(Y,le[4]),fe&32&&(O.checked=le[5]),fe&34&&(ie=le[5]&&Object.keys(le[1]).length>0),ie?De?De.p(le,fe):(De=Co(le),De.c(),De.m(K,null)):De&&(De.d(1),De=null),yt!==(yt=js(le))&&(ke.d(1),ke=yt(le),ke&&(ke.c(),ke.m(_e,null))),fe&1088&&Ie!==(Ie=!le[10]||le[6])&&(_e.disabled=Ie)},d(le){le&&f(e),Vs(xe,le),he&&he.d(),De&&De.d(),ke.d(),Ye=!1,Qe(Re)}}}function ko(s){let e;return{c(){e=N("We'll follow up if we need any clarification.")},l(t){e=z(t,"We'll follow up if we need any clarification.")},m(t,r){q(t,e,r)},d(t){t&&f(e)}}}function Eo(s){let e,t,r,a,i,o,u=s[24].icon+"",l,d,m,h,b=s[24].label+"",_,w,y,T=s[24].examples.slice(0,2).join(", ")+"",M,E,A,V,F;function W(){return s[18](s[23])}return A=nn(s[17][0]),{c(){e=g("label"),t=g("input"),r=I(),a=g("div"),i=g("div"),o=g("span"),l=N(u),d=I(),m=g("div"),h=g("div"),_=N(b),w=I(),y=g("div"),M=N(T),E=I(),this.h()},l(R){e=p(R,"LABEL",{class:!0});var D=v(e);t=p(D,"INPUT",{type:!0,class:!0}),r=x(D),a=p(D,"DIV",{class:!0});var S=v(a);i=p(S,"DIV",{class:!0});var k=v(i);o=p(k,"SPAN",{class:!0});var L=v(o);l=z(L,u),L.forEach(f),d=x(k),m=p(k,"DIV",{class:!0});var B=v(m);h=p(B,"DIV",{class:!0});var P=v(h);_=z(P,b),P.forEach(f),w=x(B),y=p(B,"DIV",{class:!0});var C=v(y);M=z(C,T),C.forEach(f),B.forEach(f),k.forEach(f),S.forEach(f),E=x(D),D.forEach(f),this.h()},h(){c(t,"type","radio"),t.__value=s[23],gs(t,t.__value),c(t,"class","sr-only svelte-1adc9lu"),c(o,"class","text-2xl svelte-1adc9lu"),c(h,"class","font-medium text-dark-text svelte-1adc9lu"),c(y,"class","text-xs text-dark-text-muted mt-1 svelte-1adc9lu"),c(m,"class","svelte-1adc9lu"),c(i,"class","flex items-center space-x-3 svelte-1adc9lu"),c(a,"class","feedback-type-card p-4 rounded-lg border border-gray-600 hover:border-magic-400 cursor-pointer transition-all svelte-1adc9lu"),c(e,"class","feedback-type-option svelte-1adc9lu"),A.p(t)},m(R,D){q(R,e,D),n(e,t),t.checked=t.__value===s[2],n(e,r),n(e,a),n(a,i),n(i,o),n(o,l),n(i,d),n(i,m),n(m,h),n(h,_),n(m,w),n(m,y),n(y,M),n(e,E),V||(F=[ce(t,"change",s[16]),ce(t,"change",W)],V=!0)},p(R,D){s=R,D&4&&(t.checked=t.__value===s[2])},d(R){R&&f(e),A.r(),V=!1,Qe(F)}}}function Do(s){let e,t,r="Examples:",a,i=s[9].examples.join(" • ")+"",o;return{c(){e=g("div"),t=g("span"),t.textContent=r,a=I(),o=N(i),this.h()},l(u){e=p(u,"DIV",{class:!0});var l=v(e);t=p(l,"SPAN",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-3udf47"&&(t.textContent=r),a=x(l),o=z(l,i),l.forEach(f),this.h()},h(){c(t,"class","font-medium svelte-1adc9lu"),c(e,"class","text-xs text-dark-text-muted svelte-1adc9lu")},m(u,l){q(u,e,l),n(e,t),n(e,a),n(e,o)},p(u,l){l&512&&i!==(i=u[9].examples.join(" • ")+"")&&de(o,i)},d(u){u&&f(e)}}}function Co(s){let e,t,r="Context includes:",a,i,o,u=s[1].images_processed&&Io(s),l=s[1].processing_time&&xo(s);return{c(){e=g("div"),t=g("strong"),t.textContent=r,a=I(),u&&u.c(),i=I(),l&&l.c(),o=N(`
                Browser info, session data`),this.h()},l(d){e=p(d,"DIV",{class:!0});var m=v(e);t=p(m,"STRONG",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1m9jhps"&&(t.textContent=r),a=x(m),u&&u.l(m),i=x(m),l&&l.l(m),o=z(m,`
                Browser info, session data`),m.forEach(f),this.h()},h(){c(t,"class","svelte-1adc9lu"),c(e,"class","text-xs text-dark-text-muted bg-dark-base/50 rounded p-3 svelte-1adc9lu")},m(d,m){q(d,e,m),n(e,t),n(e,a),u&&u.m(e,null),n(e,i),l&&l.m(e,null),n(e,o)},p(d,m){d[1].images_processed?u?u.p(d,m):(u=Io(d),u.c(),u.m(e,i)):u&&(u.d(1),u=null),d[1].processing_time?l?l.p(d,m):(l=xo(d),l.c(),l.m(e,o)):l&&(l.d(1),l=null)},d(d){d&&f(e),u&&u.d(),l&&l.d()}}}function Io(s){let e,t=s[1].images_processed+"",r,a;return{c(){e=N("Images processed: "),r=N(t),a=N(" •")},l(i){e=z(i,"Images processed: "),r=z(i,t),a=z(i," •")},m(i,o){q(i,e,o),q(i,r,o),q(i,a,o)},p(i,o){o&2&&t!==(t=i[1].images_processed+"")&&de(r,t)},d(i){i&&(f(e),f(r),f(a))}}}function xo(s){let e,t=s[1].processing_time.toFixed(1)+"",r,a;return{c(){e=N("Avg processing time: "),r=N(t),a=N("s •")},l(i){e=z(i,"Avg processing time: "),r=z(i,t),a=z(i,"s •")},m(i,o){q(i,e,o),q(i,r,o),q(i,a,o)},p(i,o){o&2&&t!==(t=i[1].processing_time.toFixed(1)+"")&&de(r,t)},d(i){i&&(f(e),f(r),f(a))}}}function Vl(s){let e,t,r;return{c(){e=Te("svg"),t=Te("path"),r=N(`
                Submit Feedback`),this.h()},l(a){e=Me(a,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var i=v(e);t=Me(i,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0,class:!0}),v(t).forEach(f),i.forEach(f),r=z(a,`
                Submit Feedback`),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"stroke-width","2"),c(t,"d","M12 19l9 2-9-18-9 18 9-2zm0 0v-8"),c(t,"class","svelte-1adc9lu"),c(e,"class","w-5 h-5 mr-2 svelte-1adc9lu"),c(e,"fill","none"),c(e,"stroke","currentColor"),c(e,"viewBox","0 0 24 24")},m(a,i){q(a,e,i),n(e,t),q(a,r,i)},d(a){a&&(f(e),f(r))}}}function Bl(s){let e,t,r;return{c(){e=Te("svg"),t=Te("path"),r=N(`
                Submitting...`),this.h()},l(a){e=Me(a,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var i=v(e);t=Me(i,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0,class:!0}),v(t).forEach(f),i.forEach(f),r=z(a,`
                Submitting...`),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"stroke-width","2"),c(t,"d","M12 6v6m0 0v6m0-6h6m-6 0H6"),c(t,"class","svelte-1adc9lu"),c(e,"class","w-5 h-5 mr-2 animate-spin svelte-1adc9lu"),c(e,"fill","none"),c(e,"stroke","currentColor"),c(e,"viewBox","0 0 24 24")},m(a,i){q(a,e,i),n(e,t),q(a,r,i)},d(a){a&&(f(e),f(r))}}}function Ol(s){let e,t=s[0]&&wo(s);return{c(){t&&t.c(),e=ot()},l(r){t&&t.l(r),e=ot()},m(r,a){t&&t.m(r,a),q(r,e,a)},p(r,[a]){r[0]?t?t.p(r,a):(t=wo(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ce,o:Ce,d(r){r&&f(e),t&&t.d(r)}}}function jl(s,e,t){let r,a,{visible:i=!1}=e,{feedbackType:o="general"}=e,{contextData:u={}}=e;const l=zt();let d=o,m="",h="",b=!0,_=!1,w=!1,y=0;const T={feature_request:{label:"Feature Request",placeholder:"Describe the feature you'd like to see in CharacterCut. How would it improve your developer workflow?",icon:"💡",examples:["Batch processing multiple images","API integration","Browser extension"]},bug_report:{label:"Bug Report",placeholder:"Describe the issue you encountered. What were you trying to do, and what happened instead?",icon:"🐛",examples:["Processing failed unexpectedly","Image quality issues","Interface not responding"]},improvement:{label:"Improvement Suggestion",placeholder:"How can we make CharacterCut better for your specific use case?",icon:"⚡",examples:["Faster processing","Better edge detection","More format support"]},general:{label:"General Feedback",placeholder:"Share your thoughts, suggestions, or experiences with CharacterCut.",icon:"💬",examples:["Overall experience","Interface feedback","Workflow suggestions"]}};async function M(){if(r){t(6,_=!0);try{await Pe.trackFeedbackSubmission(d,m);const k={type:d,content:m.trim(),email:h.trim()||void 0,context:b?{...u,timestamp:new Date().toISOString(),user_agent:navigator.userAgent,session_id:Pe.sessionId}:void 0};console.log("📝 Feedback Submission:",k),l("submit",k),t(7,w=!0),setTimeout(()=>{E()},3e3)}catch(k){console.error("Failed to submit feedback:",k),t(7,w=!0),setTimeout(()=>{E()},3e3)}finally{t(6,_=!1)}}}function E(){t(0,i=!1),l("dismiss")}function A(k){t(2,d=k),t(3,m="")}const V=[[]];function F(){d=this.__value,t(2,d)}const W=k=>A(k);function R(){m=this.value,t(3,m)}function D(){h=this.value,t(4,h)}function S(){b=this.checked,t(5,b)}return s.$$set=k=>{"visible"in k&&t(0,i=k.visible),"feedbackType"in k&&t(15,o=k.feedbackType),"contextData"in k&&t(1,u=k.contextData)},s.$$.update=()=>{s.$$.dirty&8&&t(8,y=m.length),s.$$.dirty&8&&t(10,r=m.trim().length>=10),s.$$.dirty&4&&t(9,a=T[d])},[i,u,d,m,h,b,_,w,y,a,r,T,M,E,A,o,F,V,W,R,D,S]}class Ll extends lt{constructor(e){super(),ct(this,e,jl,Ol,nt,{visible:0,feedbackType:15,contextData:1})}}function So(s,e,t){const r=s.slice();return r[12]=e[t][0],r[13]=e[t][1],r}function Po(s,e,t){const r=s.slice();return r[16]=e[t],r}function To(s){let e,t,r,a,i,o='<h2 class="text-2xl font-bold text-magic-gradient mb-2">CharacterCut Analytics Dashboard</h2> <p class="text-sm text-dark-text-secondary">Phase 5 Success Metrics Tracking • Dev Mode</p>',u,l,d,m="Export Data",h,b,_='<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',w,y,T,M="Current Session",E,A,V,F,W=s[2].images_processed+"",R,D,S,k="Images Processed",L,B,P,C=s[2].meets_continuity_target?"✅":"⏳",H,ee,re,Y,X="Continuity Target",U,J,Q,K=Math.round(s[2].session_duration/1e3)+"",G,O,te,$,ae="Session Duration",se,ie,ge,j=s[2].successful_completions+"",_e,Ie,Ee=s[2].successful_completions+s[2].failed_attempts+"",ye,Ge,Ye,Re,He="Success Rate",xe,he,De,js="Phase 5 KPIs Progress",yt,ke,le,fe,pe,Ze="Unique Active Users",hs,Ue,Ht=s[8].uniqueActiveUsers+"",wt,Xe,qt=s[7].uniqueActiveUsers+"",kt,Et,ut,$e,Ar,Gt,Ka=(s[8].uniqueActiveUsers/s[7].uniqueActiveUsers*100).toFixed(1)+"",Fr,Vr,Br,et,Dt,Wt,Ja="Task Completion Rate",Or,Ct,Ls=s[5].toFixed(1)+"",Ks,jr,Js,Lr,vs,Yt,Nr,It,zr,Qa=s[7].taskCompletionRate+"",Ur,Hr,qr,tt,xt,Kt,Za="Avg Processing Time",Gr,Jt,Xa=s[8].avgProcessingTime.toFixed(2)+"",Wr,Yr,Kr,bs,_s,Jr,st,Qr,$a=s[7].avgProcessingTime+"",Zr,Xr,ei=s[8].under5SecondRate.toFixed(1)+"",$r,ea,ta,rt,St,Qt,ti="Session Continuity",sa,Pt,Ns=s[4].toFixed(1)+"",Qs,ra,Zs,aa,ys,Zt,ia,Xt,si=s[8].sessionContinuityCount+"",oa,na,la,at,Tt,$t,ri="NPS Score",ca,Mt,zs=s[3]>0?"+":"",Xs,Us=s[3].toFixed(1)+"",$s,er,ua,ws,es,da,ts,ai=s[8].npsResponses.length+"",fa,ma,ga,it,Rt,ss,ii="Feedback Submissions",pa,At,oi=s[8].feedbackSubmissions+"",ha,va,ni=s[7].feedbackSubmissions+"",ba,_a,ks,Es,ya,rs,li="Detailed qualitative feedback",wa,Ft,Vt,as,ci="Top Referrers",ka,dt,Ea,Bt,is,ui="Error Categories",Da,ft,Ca,di,mt=Je(s[8].topReferrers.slice(0,5)),Ve=[];for(let oe=0;oe<mt.length;oe+=1)Ve[oe]=Ro(Po(s,mt,oe));let Be=null;mt.length||(Be=Mo());let gt=Je(Object.entries(s[8].errorCategories).slice(0,5)),Oe=[];for(let oe=0;oe<gt.length;oe+=1)Oe[oe]=Fo(So(s,gt,oe));let je=null;return gt.length||(je=Ao()),{c(){e=g("div"),t=g("div"),r=g("div"),a=g("div"),i=g("div"),i.innerHTML=o,u=I(),l=g("div"),d=g("button"),d.textContent=m,h=I(),b=g("button"),b.innerHTML=_,w=I(),y=g("div"),T=g("h3"),T.textContent=M,E=I(),A=g("div"),V=g("div"),F=g("div"),R=N(W),D=I(),S=g("div"),S.textContent=k,L=I(),B=g("div"),P=g("div"),H=N(C),re=I(),Y=g("div"),Y.textContent=X,U=I(),J=g("div"),Q=g("div"),G=N(K),O=N("s"),te=I(),$=g("div"),$.textContent=ae,se=I(),ie=g("div"),ge=g("div"),_e=N(j),Ie=N("/"),ye=N(Ee),Ye=I(),Re=g("div"),Re.textContent=He,xe=I(),he=g("div"),De=g("h3"),De.textContent=js,yt=I(),ke=g("div"),le=g("div"),fe=g("div"),pe=g("h4"),pe.textContent=Ze,hs=I(),Ue=g("span"),wt=N(Ht),Xe=N("/"),kt=N(qt),Et=I(),ut=g("div"),$e=g("div"),Ar=I(),Gt=g("div"),Fr=N(Ka),Vr=N("% of target"),Br=I(),et=g("div"),Dt=g("div"),Wt=g("h4"),Wt.textContent=Ja,Or=I(),Ct=g("span"),Ks=N(Ls),jr=N("%"),Lr=I(),vs=g("div"),Yt=g("div"),Nr=I(),It=g("div"),zr=N("Target: "),Ur=N(Qa),Hr=N("%"),qr=I(),tt=g("div"),xt=g("div"),Kt=g("h4"),Kt.textContent=Za,Gr=I(),Jt=g("span"),Wr=N(Xa),Yr=N("s"),Kr=I(),bs=g("div"),_s=g("div"),Jr=I(),st=g("div"),Qr=N("Target: <"),Zr=N($a),Xr=N("s • "),$r=N(ei),ea=N("% under 5s"),ta=I(),rt=g("div"),St=g("div"),Qt=g("h4"),Qt.textContent=ti,sa=I(),Pt=g("span"),Qs=N(Ns),ra=N("%"),aa=I(),ys=g("div"),Zt=g("div"),ia=I(),Xt=g("div"),oa=N(si),na=N(" sessions with 2+ images"),la=I(),at=g("div"),Tt=g("div"),$t=g("h4"),$t.textContent=ri,ca=I(),Mt=g("span"),Xs=N(zs),$s=N(Us),ua=I(),ws=g("div"),es=g("div"),da=I(),ts=g("div"),fa=N(ai),ma=N(" responses • Target: positive"),ga=I(),it=g("div"),Rt=g("div"),ss=g("h4"),ss.textContent=ii,pa=I(),At=g("span"),ha=N(oi),va=N("/"),ba=N(ni),_a=I(),ks=g("div"),Es=g("div"),ya=I(),rs=g("div"),rs.textContent=li,wa=I(),Ft=g("div"),Vt=g("div"),as=g("h4"),as.textContent=ci,ka=I(),dt=g("div");for(let oe=0;oe<Ve.length;oe+=1)Ve[oe].c();Be&&Be.c(),Ea=I(),Bt=g("div"),is=g("h4"),is.textContent=ui,Da=I(),ft=g("div");for(let oe=0;oe<Oe.length;oe+=1)Oe[oe].c();je&&je.c(),this.h()},l(oe){e=p(oe,"DIV",{class:!0});var ve=v(e);t=p(ve,"DIV",{class:!0});var ue=v(t);r=p(ue,"DIV",{class:!0});var Ot=v(r);a=p(Ot,"DIV",{class:!0});var tr=v(a);i=p(tr,"DIV",{"data-svelte-h":!0}),Z(i)!=="svelte-1ryvpqg"&&(i.innerHTML=o),u=x(tr),l=p(tr,"DIV",{class:!0});var sr=v(l);d=p(sr,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(d)!=="svelte-1hzqfkc"&&(d.textContent=m),h=x(sr),b=p(sr,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(b)!=="svelte-9m0buy"&&(b.innerHTML=_),sr.forEach(f),tr.forEach(f),Ot.forEach(f),w=x(ue),y=p(ue,"DIV",{class:!0});var rr=v(y);T=p(rr,"H3",{class:!0,"data-svelte-h":!0}),Z(T)!=="svelte-1y0f3ps"&&(T.textContent=M),E=x(rr),A=p(rr,"DIV",{class:!0});var jt=v(A);V=p(jt,"DIV",{class:!0});var ar=v(V);F=p(ar,"DIV",{class:!0});var fi=v(F);R=z(fi,W),fi.forEach(f),D=x(ar),S=p(ar,"DIV",{class:!0,"data-svelte-h":!0}),Z(S)!=="svelte-ehd65n"&&(S.textContent=k),ar.forEach(f),L=x(jt),B=p(jt,"DIV",{class:!0});var ir=v(B);P=p(ir,"DIV",{class:!0});var mi=v(P);H=z(mi,C),mi.forEach(f),re=x(ir),Y=p(ir,"DIV",{class:!0,"data-svelte-h":!0}),Z(Y)!=="svelte-158k1ee"&&(Y.textContent=X),ir.forEach(f),U=x(jt),J=p(jt,"DIV",{class:!0});var or=v(J);Q=p(or,"DIV",{class:!0});var Ia=v(Q);G=z(Ia,K),O=z(Ia,"s"),Ia.forEach(f),te=x(or),$=p(or,"DIV",{class:!0,"data-svelte-h":!0}),Z($)!=="svelte-1sdj5gt"&&($.textContent=ae),or.forEach(f),se=x(jt),ie=p(jt,"DIV",{class:!0});var nr=v(ie);ge=p(nr,"DIV",{class:!0});var lr=v(ge);_e=z(lr,j),Ie=z(lr,"/"),ye=z(lr,Ee),lr.forEach(f),Ye=x(nr),Re=p(nr,"DIV",{class:!0,"data-svelte-h":!0}),Z(Re)!=="svelte-s2mmy6"&&(Re.textContent=He),nr.forEach(f),jt.forEach(f),rr.forEach(f),xe=x(ue),he=p(ue,"DIV",{class:!0});var Ds=v(he);De=p(Ds,"H3",{class:!0,"data-svelte-h":!0}),Z(De)!=="svelte-wnxoev"&&(De.textContent=js),yt=x(Ds),ke=p(Ds,"DIV",{class:!0});var Ke=v(ke);le=p(Ke,"DIV",{class:!0});var Cs=v(le);fe=p(Cs,"DIV",{class:!0});var cr=v(fe);pe=p(cr,"H4",{class:!0,"data-svelte-h":!0}),Z(pe)!=="svelte-1p1xeb3"&&(pe.textContent=Ze),hs=x(cr),Ue=p(cr,"SPAN",{class:!0});var ur=v(Ue);wt=z(ur,Ht),Xe=z(ur,"/"),kt=z(ur,qt),ur.forEach(f),cr.forEach(f),Et=x(Cs),ut=p(Cs,"DIV",{class:!0});var gi=v(ut);$e=p(gi,"DIV",{class:!0,style:!0}),v($e).forEach(f),gi.forEach(f),Ar=x(Cs),Gt=p(Cs,"DIV",{class:!0});var xa=v(Gt);Fr=z(xa,Ka),Vr=z(xa,"% of target"),xa.forEach(f),Cs.forEach(f),Br=x(Ke),et=p(Ke,"DIV",{class:!0});var Is=v(et);Dt=p(Is,"DIV",{class:!0});var dr=v(Dt);Wt=p(dr,"H4",{class:!0,"data-svelte-h":!0}),Z(Wt)!=="svelte-tx3wcr"&&(Wt.textContent=Ja),Or=x(dr),Ct=p(dr,"SPAN",{class:!0});var Sa=v(Ct);Ks=z(Sa,Ls),jr=z(Sa,"%"),Sa.forEach(f),dr.forEach(f),Lr=x(Is),vs=p(Is,"DIV",{class:!0});var pi=v(vs);Yt=p(pi,"DIV",{class:!0,style:!0}),v(Yt).forEach(f),pi.forEach(f),Nr=x(Is),It=p(Is,"DIV",{class:!0});var fr=v(It);zr=z(fr,"Target: "),Ur=z(fr,Qa),Hr=z(fr,"%"),fr.forEach(f),Is.forEach(f),qr=x(Ke),tt=p(Ke,"DIV",{class:!0});var xs=v(tt);xt=p(xs,"DIV",{class:!0});var mr=v(xt);Kt=p(mr,"H4",{class:!0,"data-svelte-h":!0}),Z(Kt)!=="svelte-1pjdus8"&&(Kt.textContent=Za),Gr=x(mr),Jt=p(mr,"SPAN",{class:!0});var Pa=v(Jt);Wr=z(Pa,Xa),Yr=z(Pa,"s"),Pa.forEach(f),mr.forEach(f),Kr=x(xs),bs=p(xs,"DIV",{class:!0});var hi=v(bs);_s=p(hi,"DIV",{class:!0,style:!0}),v(_s).forEach(f),hi.forEach(f),Jr=x(xs),st=p(xs,"DIV",{class:!0});var Ss=v(st);Qr=z(Ss,"Target: <"),Zr=z(Ss,$a),Xr=z(Ss,"s • "),$r=z(Ss,ei),ea=z(Ss,"% under 5s"),Ss.forEach(f),xs.forEach(f),ta=x(Ke),rt=p(Ke,"DIV",{class:!0});var Ps=v(rt);St=p(Ps,"DIV",{class:!0});var gr=v(St);Qt=p(gr,"H4",{class:!0,"data-svelte-h":!0}),Z(Qt)!=="svelte-1sx6yj2"&&(Qt.textContent=ti),sa=x(gr),Pt=p(gr,"SPAN",{class:!0});var Ta=v(Pt);Qs=z(Ta,Ns),ra=z(Ta,"%"),Ta.forEach(f),gr.forEach(f),aa=x(Ps),ys=p(Ps,"DIV",{class:!0});var vi=v(ys);Zt=p(vi,"DIV",{class:!0,style:!0}),v(Zt).forEach(f),vi.forEach(f),ia=x(Ps),Xt=p(Ps,"DIV",{class:!0});var Ma=v(Xt);oa=z(Ma,si),na=z(Ma," sessions with 2+ images"),Ma.forEach(f),Ps.forEach(f),la=x(Ke),at=p(Ke,"DIV",{class:!0});var Ts=v(at);Tt=p(Ts,"DIV",{class:!0});var pr=v(Tt);$t=p(pr,"H4",{class:!0,"data-svelte-h":!0}),Z($t)!=="svelte-jzhokp"&&($t.textContent=ri),ca=x(pr),Mt=p(pr,"SPAN",{class:!0});var Ra=v(Mt);Xs=z(Ra,zs),$s=z(Ra,Us),Ra.forEach(f),pr.forEach(f),ua=x(Ts),ws=p(Ts,"DIV",{class:!0});var bi=v(ws);es=p(bi,"DIV",{class:!0,style:!0}),v(es).forEach(f),bi.forEach(f),da=x(Ts),ts=p(Ts,"DIV",{class:!0});var Aa=v(ts);fa=z(Aa,ai),ma=z(Aa," responses • Target: positive"),Aa.forEach(f),Ts.forEach(f),ga=x(Ke),it=p(Ke,"DIV",{class:!0});var Ms=v(it);Rt=p(Ms,"DIV",{class:!0});var hr=v(Rt);ss=p(hr,"H4",{class:!0,"data-svelte-h":!0}),Z(ss)!=="svelte-86cqka"&&(ss.textContent=ii),pa=x(hr),At=p(hr,"SPAN",{class:!0});var vr=v(At);ha=z(vr,oi),va=z(vr,"/"),ba=z(vr,ni),vr.forEach(f),hr.forEach(f),_a=x(Ms),ks=p(Ms,"DIV",{class:!0});var _i=v(ks);Es=p(_i,"DIV",{class:!0,style:!0}),v(Es).forEach(f),_i.forEach(f),ya=x(Ms),rs=p(Ms,"DIV",{class:!0,"data-svelte-h":!0}),Z(rs)!=="svelte-4uopxu"&&(rs.textContent=li),Ms.forEach(f),Ke.forEach(f),wa=x(Ds),Ft=p(Ds,"DIV",{class:!0});var br=v(Ft);Vt=p(br,"DIV",{class:!0});var _r=v(Vt);as=p(_r,"H4",{class:!0,"data-svelte-h":!0}),Z(as)!=="svelte-1q20frz"&&(as.textContent=ci),ka=x(_r),dt=p(_r,"DIV",{class:!0});var Fa=v(dt);for(let os=0;os<Ve.length;os+=1)Ve[os].l(Fa);Be&&Be.l(Fa),Fa.forEach(f),_r.forEach(f),Ea=x(br),Bt=p(br,"DIV",{class:!0});var yr=v(Bt);is=p(yr,"H4",{class:!0,"data-svelte-h":!0}),Z(is)!=="svelte-1ncaf6w"&&(is.textContent=ui),Da=x(yr),ft=p(yr,"DIV",{class:!0});var Va=v(ft);for(let os=0;os<Oe.length;os+=1)Oe[os].l(Va);je&&je.l(Va),Va.forEach(f),yr.forEach(f),br.forEach(f),Ds.forEach(f),ue.forEach(f),ve.forEach(f),this.h()},h(){c(d,"class","btn btn-outline border-magic-400 text-magic-400 hover:bg-magic-400 hover:text-white px-4 py-2 rounded text-sm"),c(b,"class","text-dark-text-muted hover:text-dark-text p-2 rounded transition-colors"),c(l,"class","flex items-center space-x-3"),c(a,"class","flex items-center justify-between"),c(r,"class","p-6 border-b border-gray-700"),c(T,"class","text-lg font-semibold text-dark-text mb-4"),c(F,"class","text-2xl font-bold text-magic-400"),c(S,"class","text-sm text-dark-text-muted"),c(V,"class","metric-card bg-dark-base/50 rounded-lg p-4 svelte-1dl4xtl"),c(P,"class",ee="text-2xl font-bold "+(s[2].meets_continuity_target?"text-green-400":"text-yellow-400")),c(Y,"class","text-sm text-dark-text-muted"),c(B,"class","metric-card bg-dark-base/50 rounded-lg p-4 svelte-1dl4xtl"),c(Q,"class","text-2xl font-bold text-blue-400"),c($,"class","text-sm text-dark-text-muted"),c(J,"class","metric-card bg-dark-base/50 rounded-lg p-4 svelte-1dl4xtl"),c(ge,"class",Ge="text-2xl font-bold "+(s[2].failed_attempts===0?"text-green-400":"text-red-400")),c(Re,"class","text-sm text-dark-text-muted"),c(ie,"class","metric-card bg-dark-base/50 rounded-lg p-4 svelte-1dl4xtl"),c(A,"class","grid grid-cols-2 md:grid-cols-4 gap-4"),c(y,"class","p-6 border-b border-gray-700"),c(De,"class","text-lg font-semibold text-dark-text mb-6"),c(pe,"class","font-medium text-dark-text"),c(Ue,"class",Rs(s[8].uniqueActiveUsers,s[7].uniqueActiveUsers)+" text-sm font-medium svelte-1dl4xtl"),c(fe,"class","flex items-center justify-between mb-4"),c($e,"class","bg-magic-400 h-2 rounded-full transition-all duration-500 svelte-1dl4xtl"),ne($e,"width",Vo(s[8].uniqueActiveUsers,s[7].uniqueActiveUsers)+"%"),c(ut,"class","progress-bar bg-dark-elevated rounded-full h-2 mb-2 svelte-1dl4xtl"),c(Gt,"class","text-xs text-dark-text-muted"),c(le,"class","kpi-card bg-dark-base/30 rounded-lg p-6 border border-gray-700 svelte-1dl4xtl"),c(Wt,"class","font-medium text-dark-text"),c(Ct,"class",Js=Rs(s[5],s[7].taskCompletionRate,!0)+" text-sm font-medium svelte-1dl4xtl"),c(Dt,"class","flex items-center justify-between mb-4"),c(Yt,"class","bg-green-400 h-2 rounded-full transition-all duration-500 svelte-1dl4xtl"),ne(Yt,"width",Math.min(s[5],100)+"%"),c(vs,"class","progress-bar bg-dark-elevated rounded-full h-2 mb-2 svelte-1dl4xtl"),c(It,"class","text-xs text-dark-text-muted"),c(et,"class","kpi-card bg-dark-base/30 rounded-lg p-6 border border-gray-700 svelte-1dl4xtl"),c(Kt,"class","font-medium text-dark-text"),c(Jt,"class",(s[8].avgProcessingTime<=s[7].avgProcessingTime?"text-green-400":"text-red-400")+" text-sm font-medium"),c(xt,"class","flex items-center justify-between mb-4"),c(_s,"class","bg-blue-400 h-2 rounded-full transition-all duration-500 svelte-1dl4xtl"),ne(_s,"width",Math.min(s[7].avgProcessingTime/Math.max(s[8].avgProcessingTime,s[7].avgProcessingTime)*100,100)+"%"),c(bs,"class","progress-bar bg-dark-elevated rounded-full h-2 mb-2 svelte-1dl4xtl"),c(st,"class","text-xs text-dark-text-muted"),c(tt,"class","kpi-card bg-dark-base/30 rounded-lg p-6 border border-gray-700 svelte-1dl4xtl"),c(Qt,"class","font-medium text-dark-text"),c(Pt,"class",Zs=Rs(s[4],s[7].sessionContinuityRate,!0)+" text-sm font-medium svelte-1dl4xtl"),c(St,"class","flex items-center justify-between mb-4"),c(Zt,"class","bg-yellow-400 h-2 rounded-full transition-all duration-500 svelte-1dl4xtl"),ne(Zt,"width",Math.min(s[4],100)+"%"),c(ys,"class","progress-bar bg-dark-elevated rounded-full h-2 mb-2 svelte-1dl4xtl"),c(Xt,"class","text-xs text-dark-text-muted"),c(rt,"class","kpi-card bg-dark-base/30 rounded-lg p-6 border border-gray-700 svelte-1dl4xtl"),c($t,"class","font-medium text-dark-text"),c(Mt,"class",er=(s[3]>=0?"text-green-400":"text-red-400")+" text-sm font-medium"),c(Tt,"class","flex items-center justify-between mb-4"),c(es,"class","bg-purple-400 h-2 rounded-full transition-all duration-500 svelte-1dl4xtl"),ne(es,"width",(s[3]+10)/20*100+"%"),c(ws,"class","progress-bar bg-dark-elevated rounded-full h-2 mb-2 svelte-1dl4xtl"),c(ts,"class","text-xs text-dark-text-muted"),c(at,"class","kpi-card bg-dark-base/30 rounded-lg p-6 border border-gray-700 svelte-1dl4xtl"),c(ss,"class","font-medium text-dark-text"),c(At,"class",Rs(s[8].feedbackSubmissions,s[7].feedbackSubmissions)+" text-sm font-medium svelte-1dl4xtl"),c(Rt,"class","flex items-center justify-between mb-4"),c(Es,"class","bg-orange-400 h-2 rounded-full transition-all duration-500 svelte-1dl4xtl"),ne(Es,"width",Vo(s[8].feedbackSubmissions,s[7].feedbackSubmissions)+"%"),c(ks,"class","progress-bar bg-dark-elevated rounded-full h-2 mb-2 svelte-1dl4xtl"),c(rs,"class","text-xs text-dark-text-muted"),c(it,"class","kpi-card bg-dark-base/30 rounded-lg p-6 border border-gray-700 svelte-1dl4xtl"),c(ke,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"),c(as,"class","font-medium text-dark-text mb-4"),c(dt,"class","space-y-2"),c(Vt,"class","insights-card bg-dark-base/30 rounded-lg p-6 border border-gray-700 svelte-1dl4xtl"),c(is,"class","font-medium text-dark-text mb-4"),c(ft,"class","space-y-2"),c(Bt,"class","insights-card bg-dark-base/30 rounded-lg p-6 border border-gray-700 svelte-1dl4xtl"),c(Ft,"class","mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6"),c(he,"class","p-6"),c(t,"class","analytics-dashboard bg-dark-elevated border border-magic-400/20 rounded-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto svelte-1dl4xtl"),c(e,"class","fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50")},m(oe,ve){q(oe,e,ve),n(e,t),n(t,r),n(r,a),n(a,i),n(a,u),n(a,l),n(l,d),n(l,h),n(l,b),n(t,w),n(t,y),n(y,T),n(y,E),n(y,A),n(A,V),n(V,F),n(F,R),n(V,D),n(V,S),n(A,L),n(A,B),n(B,P),n(P,H),n(B,re),n(B,Y),n(A,U),n(A,J),n(J,Q),n(Q,G),n(Q,O),n(J,te),n(J,$),n(A,se),n(A,ie),n(ie,ge),n(ge,_e),n(ge,Ie),n(ge,ye),n(ie,Ye),n(ie,Re),n(t,xe),n(t,he),n(he,De),n(he,yt),n(he,ke),n(ke,le),n(le,fe),n(fe,pe),n(fe,hs),n(fe,Ue),n(Ue,wt),n(Ue,Xe),n(Ue,kt),n(le,Et),n(le,ut),n(ut,$e),n(le,Ar),n(le,Gt),n(Gt,Fr),n(Gt,Vr),n(ke,Br),n(ke,et),n(et,Dt),n(Dt,Wt),n(Dt,Or),n(Dt,Ct),n(Ct,Ks),n(Ct,jr),n(et,Lr),n(et,vs),n(vs,Yt),n(et,Nr),n(et,It),n(It,zr),n(It,Ur),n(It,Hr),n(ke,qr),n(ke,tt),n(tt,xt),n(xt,Kt),n(xt,Gr),n(xt,Jt),n(Jt,Wr),n(Jt,Yr),n(tt,Kr),n(tt,bs),n(bs,_s),n(tt,Jr),n(tt,st),n(st,Qr),n(st,Zr),n(st,Xr),n(st,$r),n(st,ea),n(ke,ta),n(ke,rt),n(rt,St),n(St,Qt),n(St,sa),n(St,Pt),n(Pt,Qs),n(Pt,ra),n(rt,aa),n(rt,ys),n(ys,Zt),n(rt,ia),n(rt,Xt),n(Xt,oa),n(Xt,na),n(ke,la),n(ke,at),n(at,Tt),n(Tt,$t),n(Tt,ca),n(Tt,Mt),n(Mt,Xs),n(Mt,$s),n(at,ua),n(at,ws),n(ws,es),n(at,da),n(at,ts),n(ts,fa),n(ts,ma),n(ke,ga),n(ke,it),n(it,Rt),n(Rt,ss),n(Rt,pa),n(Rt,At),n(At,ha),n(At,va),n(At,ba),n(it,_a),n(it,ks),n(ks,Es),n(it,ya),n(it,rs),n(he,wa),n(he,Ft),n(Ft,Vt),n(Vt,as),n(Vt,ka),n(Vt,dt);for(let ue=0;ue<Ve.length;ue+=1)Ve[ue]&&Ve[ue].m(dt,null);Be&&Be.m(dt,null),n(Ft,Ea),n(Ft,Bt),n(Bt,is),n(Bt,Da),n(Bt,ft);for(let ue=0;ue<Oe.length;ue+=1)Oe[ue]&&Oe[ue].m(ft,null);je&&je.m(ft,null),Ca||(di=[ce(d,"click",s[9]),ce(b,"click",s[10])],Ca=!0)},p(oe,ve){if(ve&4&&W!==(W=oe[2].images_processed+"")&&de(R,W),ve&4&&C!==(C=oe[2].meets_continuity_target?"✅":"⏳")&&de(H,C),ve&4&&ee!==(ee="text-2xl font-bold "+(oe[2].meets_continuity_target?"text-green-400":"text-yellow-400"))&&c(P,"class",ee),ve&4&&K!==(K=Math.round(oe[2].session_duration/1e3)+"")&&de(G,K),ve&4&&j!==(j=oe[2].successful_completions+"")&&de(_e,j),ve&4&&Ee!==(Ee=oe[2].successful_completions+oe[2].failed_attempts+"")&&de(ye,Ee),ve&4&&Ge!==(Ge="text-2xl font-bold "+(oe[2].failed_attempts===0?"text-green-400":"text-red-400"))&&c(ge,"class",Ge),ve&32&&Ls!==(Ls=oe[5].toFixed(1)+"")&&de(Ks,Ls),ve&32&&Js!==(Js=Rs(oe[5],oe[7].taskCompletionRate,!0)+" text-sm font-medium svelte-1dl4xtl")&&c(Ct,"class",Js),ve&32&&ne(Yt,"width",Math.min(oe[5],100)+"%"),ve&16&&Ns!==(Ns=oe[4].toFixed(1)+"")&&de(Qs,Ns),ve&16&&Zs!==(Zs=Rs(oe[4],oe[7].sessionContinuityRate,!0)+" text-sm font-medium svelte-1dl4xtl")&&c(Pt,"class",Zs),ve&16&&ne(Zt,"width",Math.min(oe[4],100)+"%"),ve&8&&zs!==(zs=oe[3]>0?"+":"")&&de(Xs,zs),ve&8&&Us!==(Us=oe[3].toFixed(1)+"")&&de($s,Us),ve&8&&er!==(er=(oe[3]>=0?"text-green-400":"text-red-400")+" text-sm font-medium")&&c(Mt,"class",er),ve&8&&ne(es,"width",(oe[3]+10)/20*100+"%"),ve&256){mt=Je(oe[8].topReferrers.slice(0,5));let ue;for(ue=0;ue<mt.length;ue+=1){const Ot=Po(oe,mt,ue);Ve[ue]?Ve[ue].p(Ot,ve):(Ve[ue]=Ro(Ot),Ve[ue].c(),Ve[ue].m(dt,null))}for(;ue<Ve.length;ue+=1)Ve[ue].d(1);Ve.length=mt.length,!mt.length&&Be?Be.p(oe,ve):mt.length?Be&&(Be.d(1),Be=null):(Be=Mo(),Be.c(),Be.m(dt,null))}if(ve&256){gt=Je(Object.entries(oe[8].errorCategories).slice(0,5));let ue;for(ue=0;ue<gt.length;ue+=1){const Ot=So(oe,gt,ue);Oe[ue]?Oe[ue].p(Ot,ve):(Oe[ue]=Fo(Ot),Oe[ue].c(),Oe[ue].m(ft,null))}for(;ue<Oe.length;ue+=1)Oe[ue].d(1);Oe.length=gt.length,!gt.length&&je?je.p(oe,ve):gt.length?je&&(je.d(1),je=null):(je=Ao(),je.c(),je.m(ft,null))}},d(oe){oe&&f(e),Vs(Ve,oe),Be&&Be.d(),Vs(Oe,oe),je&&je.d(),Ca=!1,Qe(di)}}}function Mo(s){let e,t="No referrer data available";return{c(){e=g("div"),e.textContent=t,this.h()},l(r){e=p(r,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-vgmp68"&&(e.textContent=t),this.h()},h(){c(e,"class","text-sm text-dark-text-muted")},m(r,a){q(r,e,a)},p:Ce,d(r){r&&f(e)}}}function Ro(s){let e,t,r=s[16].source+"",a,i,o,u=s[16].count+"",l,d;return{c(){e=g("div"),t=g("span"),a=N(r),i=I(),o=g("span"),l=N(u),d=I(),this.h()},l(m){e=p(m,"DIV",{class:!0});var h=v(e);t=p(h,"SPAN",{class:!0});var b=v(t);a=z(b,r),b.forEach(f),i=x(h),o=p(h,"SPAN",{class:!0});var _=v(o);l=z(_,u),_.forEach(f),d=x(h),h.forEach(f),this.h()},h(){c(t,"class","text-dark-text-secondary"),c(o,"class","text-magic-400"),c(e,"class","flex items-center justify-between text-sm")},m(m,h){q(m,e,h),n(e,t),n(t,a),n(e,i),n(e,o),n(o,l),n(e,d)},p:Ce,d(m){m&&f(e)}}}function Ao(s){let e,t="No error data (good!)";return{c(){e=g("div"),e.textContent=t,this.h()},l(r){e=p(r,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-b9oudv"&&(e.textContent=t),this.h()},h(){c(e,"class","text-sm text-dark-text-muted")},m(r,a){q(r,e,a)},p:Ce,d(r){r&&f(e)}}}function Fo(s){let e,t,r=s[12]+"",a,i,o,u=s[13]+"",l,d;return{c(){e=g("div"),t=g("span"),a=N(r),i=I(),o=g("span"),l=N(u),d=I(),this.h()},l(m){e=p(m,"DIV",{class:!0});var h=v(e);t=p(h,"SPAN",{class:!0});var b=v(t);a=z(b,r),b.forEach(f),i=x(h),o=p(h,"SPAN",{class:!0});var _=v(o);l=z(_,u),_.forEach(f),d=x(h),h.forEach(f),this.h()},h(){c(t,"class","text-dark-text-secondary"),c(o,"class","text-red-400"),c(e,"class","flex items-center justify-between text-sm")},m(m,h){q(m,e,h),n(e,t),n(t,a),n(e,i),n(e,o),n(o,l),n(e,d)},p:Ce,d(m){m&&f(e)}}}function Nl(s){let e,t=s[0]&&s[1]&&To(s);return{c(){t&&t.c(),e=ot()},l(r){t&&t.l(r),e=ot()},m(r,a){t&&t.m(r,a),q(r,e,a)},p(r,[a]){r[0]&&r[1]?t?t.p(r,a):(t=To(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ce,o:Ce,d(r){r&&f(e),t&&t.d(r)}}}function Rs(s,e,t=!1){const r=t?s:s/e*100;return r>=90?"text-green-400":r>=70?"text-yellow-400":"text-red-400"}function Vo(s,e){return Math.min(s/e*100,100)}function zl(s,e,t){let r,a,i,{visible:o=!1}=e,{isDevMode:u=!1}=e;const l=zt();let d=Pe.metrics,m;const h={uniqueActiveUsers:250,taskCompletionRate:95,sessionContinuityRate:15,avgProcessingTime:5,npsScore:0,feedbackSubmissions:15};let b={uniqueActiveUsers:0,totalSessions:0,totalImages:0,successfulProcessings:0,failedProcessings:0,avgProcessingTime:0,under5SecondRate:0,sessionContinuityCount:0,npsResponses:[],feedbackSubmissions:0,topReferrers:[],errorCategories:{},hourlyMetrics:[]};Ut(()=>(o&&u&&(m=setInterval(()=>{t(2,d=Pe.metrics)},5e3)),()=>{m&&clearInterval(m)}));function _(){const y={timestamp:new Date().toISOString(),sessionMetrics:d,analyticsData:b,kpiTargets:h},T=new Blob([JSON.stringify(y,null,2)],{type:"application/json"}),M=URL.createObjectURL(T),E=document.createElement("a");E.href=M,E.download=`charactercut-analytics-${Date.now()}.json`,E.click(),URL.revokeObjectURL(M)}const w=()=>l("close");return s.$$set=y=>{"visible"in y&&t(0,o=y.visible),"isDevMode"in y&&t(1,u=y.isDevMode)},t(5,r=b.totalImages>0?b.successfulProcessings/b.totalImages*100:0),t(4,a=b.totalSessions>0?b.sessionContinuityCount/b.totalSessions*100:0),t(3,i=b.npsResponses.length>0?b.npsResponses.reduce((y,T)=>y+T,0)/b.npsResponses.length:0),[o,u,d,i,a,r,l,h,b,_,w]}class Ul extends lt{constructor(e){super(),ct(this,e,zl,Nl,nt,{visible:0,isDevMode:1})}}const pt=Rr({sessionId:Zo(),startTime:Date.now(),imagesProcessed:0,successfulImages:0,totalProcessingTime:0,averageProcessingTime:0,sessionDuration:0,meetsTarget:!1,showProcessAnotherPrompt:!1,history:[]}),Hl=Ya(pt,s=>({isFirstImage:s.imagesProcessed===0,hasProcessedImages:s.imagesProcessed>0,meetsTarget:s.imagesProcessed>=2,shouldShowProcessAnother:s.successfulImages>0,successRate:s.imagesProcessed>0?s.successfulImages/s.imagesProcessed*100:0,isActiveSession:s.sessionDuration<30*60*1e3,performanceGood:s.averageProcessingTime<5e3})),ql=Ya(pt,s=>({sessionDuration:Bo(s.sessionDuration),imagesPerMinute:s.sessionDuration>0?(s.imagesProcessed/(s.sessionDuration/6e4)).toFixed(1):"0",averageProcessingTime:Bo(s.averageProcessingTime),mostUsedInputMethod:Gl(s.history),quickestProcessingTime:Wl(s.history),sessionScore:Yl(s)})),ps={startNewSession(){pt.set({sessionId:Zo(),startTime:Date.now(),imagesProcessed:0,successfulImages:0,totalProcessingTime:0,averageProcessingTime:0,sessionDuration:0,meetsTarget:!1,showProcessAnotherPrompt:!1,history:[]})},recordProcessing(s,e,t,r=0){pt.update(a=>{const i={id:`img_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,timestamp:Date.now(),filename:s,processingTime:e,success:!0,inputMethod:t,recoveryAttempts:r},o=[...a.history,i],u=a.imagesProcessed+1,l=a.successfulImages+1,d=a.totalProcessingTime+e,m=Date.now()-a.startTime;return{...a,imagesProcessed:u,successfulImages:l,totalProcessingTime:d,averageProcessingTime:d/u,sessionDuration:m,meetsTarget:u>=2,showProcessAnotherPrompt:!0,history:o}}),this.trackContinuityEvent("image_processed",{processingTime:e,inputMethod:t,recoveryAttempts:r})},recordFailure(s,e,t=0){pt.update(r=>{const a={id:`fail_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,timestamp:Date.now(),filename:s,processingTime:0,success:!1,inputMethod:e,recoveryAttempts:t},i=[...r.history,a],o=r.imagesProcessed+1,u=Date.now()-r.startTime;return{...r,imagesProcessed:o,sessionDuration:u,history:i}}),this.trackContinuityEvent("image_failed",{inputMethod:e,recoveryAttempts:t})},processAnother(){pt.update(s=>({...s,showProcessAnotherPrompt:!1,sessionDuration:Date.now()-s.startTime})),this.trackContinuityEvent("process_another_clicked")},endSession(){pt.update(s=>{const e=Date.now()-s.startTime;return this.trackContinuityEvent("session_ended",{imagesProcessed:s.imagesProcessed,successfulImages:s.successfulImages,sessionDuration:e,meetsTarget:s.imagesProcessed>=2}),{...s,sessionDuration:e}})},updateSessionDuration(){pt.update(s=>({...s,sessionDuration:Date.now()-s.startTime}))},getSessionSummary(){return new Promise(s=>{const e=pt.subscribe(t=>{e();const r=ql.subscribe(a=>{r(),s({...t,analytics:a})})})})},trackContinuityEvent(s,e){const t={type:s,timestamp:Date.now(),sessionId:null,data:e||{}};console.log("Session continuity event:",t);try{const r=JSON.parse(localStorage.getItem("session_events")||"[]");r.push(t),r.length>100&&r.splice(0,r.length-100),localStorage.setItem("session_events",JSON.stringify(r))}catch{}},clearSession(){ps.startNewSession()}};function Zo(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function Bo(s){return s<1e3?`${s}ms`:s<6e4?`${(s/1e3).toFixed(1)}s`:`${Math.floor(s/6e4)}m ${Math.floor(s%6e4/1e3)}s`}function Gl(s){if(s.length===0)return"none";const e=s.reduce((t,r)=>(t[r.inputMethod]=(t[r.inputMethod]||0)+1,t),{});return Object.entries(e).reduce((t,r)=>e[t[0]]>e[r[0]]?t:r)[0]}function Wl(s){const e=s.filter(t=>t.success&&t.processingTime>0).map(t=>t.processingTime);return e.length>0?Math.min(...e):0}function Yl(s){let e=0;return e+=s.imagesProcessed*20,e+=s.successfulImages*10,s.meetsTarget&&(e+=50),s.averageProcessingTime<5e3&&(e+=20),s.sessionDuration>5*60*1e3&&(e+=30),Math.min(e,100)}typeof window<"u"&&(setInterval(()=>{ps.updateSessionDuration()},3e4),window.addEventListener("beforeunload",()=>{ps.endSession()}));const Gs="http://localhost:8000";class Ne extends Error{constructor(e,t,r){super(e),this.status=t,this.response=r,this.name="APIError"}}const fs=class fs{constructor(){}static getInstance(){return fs.instance||(fs.instance=new fs),fs.instance}async processImage(e){const t=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return this.processImageWithSession(e,t)}async processImageWithSession(e,t,r){const a=Date.now();try{const i=new FormData;i.append("file",e),i.append("session_id",t);const o=new AbortController,u=setTimeout(()=>o.abort(),3e4);r==null||r(10,"Uploading image..."),console.log("🔍 API DEBUG: === API REQUEST START ==="),console.log("🔍 API DEBUG: URL:",`${Gs}/simple-process`),console.log("🔍 API DEBUG: Method: POST"),console.log("🔍 API DEBUG: FormData file:",e.name,e.type,e.size),console.log("🔍 API DEBUG: Session ID:",t);const l=await fetch(`${Gs}/simple-process`,{method:"POST",body:i,signal:o.signal,headers:{}});if(clearTimeout(u),console.log("🔍 API DEBUG: === RESPONSE RECEIVED ==="),console.log("🔍 API DEBUG: Status:",l.status),console.log("🔍 API DEBUG: Status text:",l.statusText),console.log("🔍 API DEBUG: Response OK:",l.ok),console.log("🔍 API DEBUG: Response headers:",Object.fromEntries(l.headers.entries())),console.log("=== API RESPONSE RECEIVED ==="),console.log("Status:",l.status,l.statusText),console.log("Content-Type:",l.headers.get("content-type")),console.log("Content-Length:",l.headers.get("content-length")),console.log("All headers:",Object.fromEntries(l.headers.entries())),!l.ok){console.log("🔍 API DEBUG: === ERROR RESPONSE ==="),console.log("🔍 API DEBUG: Response not OK, status:",l.status);const b=await l.json().catch(w=>(console.log("🔍 API DEBUG: Failed to parse error JSON:",w),{}));console.log("🔍 API DEBUG: Parsed error data:",b);const _=b.detail||`HTTP ${l.status}: ${l.statusText}`;throw console.log("🔍 API DEBUG: Throwing APIError with message:",_),new Ne(_,l.status,b)}r==null||r(90,"Finalizing...");const d=l.headers.get("content-type");if(console.log("=== PARSING RESPONSE ==="),console.log("Content-Type for parsing:",d),!d||!d.includes("application/json")){console.error("Unexpected response content type:",d);const b=await l.text();throw console.log("Response text (first 200 chars):",b.substring(0,200)),new Ne(`Unexpected response type: ${d}`,l.status)}console.log("🔍 API DEBUG: Parsing JSON response...");const m=await l.json().catch(b=>{throw console.log("🔍 API DEBUG: JSON parsing failed:",b),new Error(`Failed to parse JSON response: ${b.message}`)});console.log("🔍 API DEBUG: === JSON PARSED SUCCESSFULLY ==="),console.log("🔍 API DEBUG: Parsed result:",m);const h=Date.now()-a;return this.trackProcessingMetrics(m.processing_id,h,!0),r==null||r(100,"Complete!"),m}catch(i){const o=Date.now()-a;if(console.log("=== API REQUEST FAILED ==="),console.log("Error type:",i.constructor.name),console.log("Error message:",i instanceof Error?i.message:i),console.log("Error stack:",i instanceof Error?i.stack:"No stack"),console.log("Processing time:",o),i instanceof Ne)throw console.log("APIError status:",i.status),console.log("APIError response:",i.response),this.trackProcessingMetrics("failed",o,!1,i.message),i;const u=i instanceof Error?i.message:"Unknown error occurred";throw this.trackProcessingMetrics("failed",o,!1,u),u.includes("abort")?new Ne("Processing timeout. Please try again with a smaller image.",408):new Ne(`Network error: ${u}`,0)}}async getProcessingStatus(e){try{const t=await fetch(`${Gs}/status/${e}`);if(!t.ok)throw new Ne(`Failed to get status: ${t.statusText}`,t.status);return await t.json()}catch(t){throw t instanceof Ne?t:new Ne(`Status check failed: ${t}`,0)}}async downloadImage(e){try{const t=await fetch(`${Gs}/download/${e}`);if(!t.ok)throw t.status===404?new Ne("Image not found or has expired",404):new Ne(`Download failed: ${t.statusText}`,t.status);return await t.blob()}catch(t){throw t instanceof Ne?t:new Ne(`Download error: ${t}`,0)}}async healthCheck(){try{const e=await fetch(`${Gs}/health`);if(!e.ok)throw new Ne(`Health check failed: ${e.statusText}`,e.status);return e.json()}catch(e){throw e instanceof Ne?e:new Ne(`Health check error: ${e}`,0)}}async withRetry(e,t=2,r=1e3){let a;for(let i=0;i<=t;i++)try{return await e()}catch(o){if(a=o,o instanceof Ne&&o.status>=400&&o.status<500&&o.status!==408)throw o;if(i===t)break;const u=r*Math.pow(2,i);await new Promise(l=>setTimeout(l,u))}throw a}trackProcessingMetrics(e,t,r,a){const i={processingId:e,processingTime:t,success:r,error:a,timestamp:new Date().toISOString(),under5Seconds:t<5e3};console.log("Processing metrics:",i);try{const o=JSON.parse(localStorage.getItem("processing_metrics")||"[]");o.push(i),o.length>50&&o.splice(0,o.length-50),localStorage.setItem("processing_metrics",JSON.stringify(o))}catch{}}};Le(fs,"instance");let Ga=fs;const Oo=Ga.getInstance(),ms=class ms{constructor(){Le(this,"config",{maxAttempts:4,strategies:["retry_original","compress_image","convert_format","reduce_quality"],delayMs:500,enableLogging:!0})}static getInstance(){return ms.instance||(ms.instance=new ms),ms.instance}async processWithRecovery(e,t,r){console.log("🔍 ERROR RECOVERY DEBUG: processWithRecovery started"),console.log("🔍 ERROR RECOVERY DEBUG: File:",e.name,e.size,e.type),console.log("🔍 ERROR RECOVERY DEBUG: Session ID:",t);const a=Date.now(),i=[];let o;for(let u=1;u<=this.config.maxAttempts;u++){const l=this.getStrategyForAttempt(u,o);r==null||r(10+(u-1)*20,this.getProgressMessage(l,u),u);try{console.log(`🔍 ERROR RECOVERY DEBUG: Attempt ${u} using strategy: ${l}`);const d=await this.applyRecoveryStrategy(e,l);console.log(`🔍 ERROR RECOVERY DEBUG: Applied recovery strategy, file size: ${d.size}`);const m=Date.now();console.log("🔍 ERROR RECOVERY DEBUG: Calling apiService.processImageWithSession...");const h=await Oo.processImageWithSession(d,t,(_,w)=>r==null?void 0:r(10+(u-1)*20+_*.6,w,u));console.log(`🔍 ERROR RECOVERY DEBUG: API call succeeded on attempt ${u}:`,h);const b={attemptNumber:u,strategy:l,timestamp:m,success:!0};return i.push(b),this.config.enableLogging&&console.log(`Recovery success on attempt ${u} with strategy: ${l}`),{success:!0,result:h,attempts:i,totalTime:Date.now()-a,finalStrategy:l}}catch(d){console.log(`🔍 ERROR RECOVERY DEBUG: Attempt ${u} failed with error:`,d),console.log("🔍 ERROR RECOVERY DEBUG: Error type:",typeof d),console.log("🔍 ERROR RECOVERY DEBUG: Error instanceof Error:",d instanceof Error),d instanceof Error&&(console.log("🔍 ERROR RECOVERY DEBUG: Error message:",d.message),console.log("🔍 ERROR RECOVERY DEBUG: Error stack:",d.stack));const m=d instanceof Error?d.message:String(d);console.log("🔍 ERROR RECOVERY DEBUG: Classifying error message:",m);const h=we.classifyError(m,{fileSize:e.size,fileName:e.name,attempt:u});console.log("🔍 ERROR RECOVERY DEBUG: Error classification:",h);const b={attemptNumber:u,strategy:l,timestamp:Date.now(),success:!1,error:m};if(i.push(b),o=m,this.config.enableLogging&&(console.warn(`Recovery attempt ${u} failed with strategy ${l}:`,m),console.log("Error classification:",h)),!h.recoverable||h.severity==="critical")return{success:!1,error:h.userMessage,attempts:i,totalTime:Date.now()-a};if(u===this.config.maxAttempts)return{success:!1,error:this.getFinalErrorMessage(i),attempts:i,totalTime:Date.now()-a};const _=we.getRetryDelay(h,u);await this.delay(_)}}return{success:!1,error:"Maximum recovery attempts exceeded",attempts:i,totalTime:Date.now()-a}}getStrategyForAttempt(e,t){if(t&&e>1){const a=we.classifyError(t);if(a.recommendedStrategy)return a.recommendedStrategy}const r=Math.min(e-1,this.config.strategies.length-1);return this.config.strategies[r]}async applyRecoveryStrategy(e,t){switch(t){case"retry_original":return e;case"compress_image":return await this.compressImage(e,.8);case"convert_format":return await this.convertToJpeg(e);case"reduce_quality":return await this.compressImage(e,.6);default:return e}}async compressImage(e,t){try{const r=document.createElement("canvas"),a=r.getContext("2d"),i=new Image;return new Promise((o,u)=>{i.onload=()=>{let{width:l,height:d}=i;const m=2048;if(l>m||d>m){const h=Math.min(m/l,m/d);l*=h,d*=h}r.width=l,r.height=d,a==null||a.drawImage(i,0,0,l,d),r.toBlob(h=>{if(h){const b=new File([h],e.name,{type:"image/jpeg",lastModified:Date.now()});o(b)}else o(e)},"image/jpeg",t)},i.onerror=()=>o(e),i.src=URL.createObjectURL(e)})}catch{return e}}async convertToJpeg(e){return e.type==="image/jpeg"?e:this.compressImage(e,.9)}getProgressMessage(e,t){return{retry_original:t===1?"Processing your image...":"Retrying original image...",compress_image:"Optimizing image size...",convert_format:"Converting to compatible format...",reduce_quality:"Reducing image complexity...",fallback_api:"Trying alternative processing method..."}[e]||"Attempting recovery..."}getFinalErrorMessage(e){var a;const t=(a=e[e.length-1])==null?void 0:a.error,r=e.map(i=>i.strategy).join(", ");return`Processing failed after ${e.length} attempts (${r}). ${t||"Please try a different image."}`}delay(e){return new Promise(t=>setTimeout(t,e))}isRecoverableError(e){const t=typeof e=="string"?e:e.message;return[/network/i,/timeout/i,/too large/i,/file size/i,/format/i,/temporary/i,/server error/i,/5\d\d/].some(a=>a.test(t))}getRecommendedStrategy(e){const t=typeof e=="string"?e:e.message;return/too large|file size/i.test(t)?"compress_image":/format|unsupported/i.test(t)?"convert_format":/quality|complex/i.test(t)?"reduce_quality":"retry_original"}configure(e){this.config={...this.config,...e}}getConfig(){return{...this.config}}resetConfig(){this.config={maxAttempts:4,strategies:["retry_original","compress_image","convert_format","reduce_quality"],delayMs:500,enableLogging:!0}}async retryWithErrorClassification(e,t,r,a){const i=we.classifyError(r,{fileSize:e.size,fileName:e.name,attempt:1});if(!i.recoverable)return{success:!1,error:i.userMessage,attempts:[],totalTime:0};if(i.recommendedStrategy){const o=i.recommendedStrategy;return this.retrySingleStrategy(e,t,o,a)}return this.processWithRecovery(e,t,a)}async retrySingleStrategy(e,t,r,a){const i=Date.now();a==null||a(10,this.getProgressMessage(r,1));try{const o=await this.applyRecoveryStrategy(e,r);return{success:!0,result:await Oo.processImageWithSession(o,t,(l,d)=>a==null?void 0:a(10+l*.8,d)),attempts:[{attemptNumber:1,strategy:r,timestamp:i,success:!0}],totalTime:Date.now()-i,finalStrategy:r}}catch(o){const u=o instanceof Error?o.message:"Unknown error";return{success:!1,error:u,attempts:[{attemptNumber:1,strategy:r,timestamp:i,success:!1,error:u}],totalTime:Date.now()-i}}}shouldRetry(e,t){const r=we.classifyError(e,t);return we.shouldAutoRetry(r)}getEstimatedRetryDelay(e,t=1){const r=we.classifyError(e);return we.getRetryDelay(r,t)}};Le(ms,"instance");let Wa=ms;const Oa=Wa.getInstance();function jo(s){let e,t,r;return t=new al({props:{disabled:s[0]}}),t.$on("imageSelected",s[15]),t.$on("error",s[16]),{c(){e=g("div"),ht(t.$$.fragment),this.h()},l(a){e=p(a,"DIV",{class:!0});var i=v(e);vt(t.$$.fragment,i),i.forEach(f),this.h()},h(){c(e,"class","max-w-2xl mx-auto")},m(a,i){q(a,e,i),bt(t,e,null),r=!0},p(a,i){const o={};i[0]&1&&(o.disabled=a[0]),t.$set(o)},i(a){r||(Se(t.$$.fragment,a),r=!0)},o(a){Fe(t.$$.fragment,a),r=!1},d(a){a&&f(e),_t(t)}}}function Lo(s){let e,t,r,a,i,o,u;return r=new dl({props:{image:s[8],isProcessing:s[0],processingProgress:s[6],processingMessage:s[5]||"Processing your character...",processedResult:s[9]}}),r.$on("animationComplete",s[31]),r.$on("scanlineComplete",s[32]),o=new yl({props:{status:"processing",progress:s[6],message:s[5]||"Processing your character...",attemptNumber:s[7],showDetails:s[7]>1}}),{c(){e=g("div"),t=g("div"),ht(r.$$.fragment),a=I(),i=g("div"),ht(o.$$.fragment),this.h()},l(l){e=p(l,"DIV",{class:!0});var d=v(e);t=p(d,"DIV",{class:!0});var m=v(t);vt(r.$$.fragment,m),a=x(m),i=p(m,"DIV",{class:!0});var h=v(i);vt(o.$$.fragment,h),h.forEach(f),m.forEach(f),d.forEach(f),this.h()},h(){c(i,"class","absolute bottom-4 left-4 right-4 z-50"),c(t,"class","processing-container svelte-au32od"),c(e,"class","max-w-4xl mx-auto")},m(l,d){q(l,e,d),n(e,t),bt(r,t,null),n(t,a),n(t,i),bt(o,i,null),u=!0},p(l,d){const m={};d[0]&256&&(m.image=l[8]),d[0]&1&&(m.isProcessing=l[0]),d[0]&64&&(m.processingProgress=l[6]),d[0]&32&&(m.processingMessage=l[5]||"Processing your character..."),d[0]&512&&(m.processedResult=l[9]),r.$set(m);const h={};d[0]&64&&(h.progress=l[6]),d[0]&32&&(h.message=l[5]||"Processing your character..."),d[0]&128&&(h.attemptNumber=l[7]),d[0]&128&&(h.showDetails=l[7]>1),o.$set(h)},i(l){u||(Se(r.$$.fragment,l),Se(o.$$.fragment,l),u=!0)},o(l){Fe(r.$$.fragment,l),Fe(o.$$.fragment,l),u=!1},d(l){l&&f(e),_t(r),_t(o)}}}function No(s){let e,t,r;return t=new pl({props:{originalImage:s[8],processedResult:s[1],autoProceeds:!1,autoProceedDelay:3e3}}),t.$on("proceed",s[18]),t.$on("stay",s[21]),{c(){e=g("div"),ht(t.$$.fragment),this.h()},l(a){e=p(a,"DIV",{class:!0});var i=v(e);vt(t.$$.fragment,i),i.forEach(f),this.h()},h(){c(e,"class","max-w-4xl mx-auto")},m(a,i){q(a,e,i),bt(t,e,null),r=!0},p(a,i){const o={};i[0]&256&&(o.originalImage=a[8]),i[0]&2&&(o.processedResult=a[1]),t.$set(o)},i(a){r||(Se(t.$$.fragment,a),r=!0)},o(a){Fe(t.$$.fragment,a),r=!1},d(a){a&&f(e),_t(t)}}}function zo(s){var C;let e,t,r,a,i='<svg class="w-8 h-8 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>',o,u,l,d="Magic Complete!",m,h,b,_=((C=s[1].processing_time)==null?void 0:C.toFixed(2))+"",w,y,T,M,E="Image automatically copied to clipboard",A,V,F,W,R=`<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-4-4m4 4l4-4m-4-4V3"></path></svg>
                  Download PNG`,D,S,k=`<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                  Process Another`,L,B,P=s[14].hasProcessedImages&&Uo(s);return{c(){e=g("div"),t=g("div"),r=g("div"),a=g("div"),a.innerHTML=i,o=I(),u=g("div"),l=g("h3"),l.textContent=d,m=I(),h=g("p"),b=N("Background removed in "),w=N(_),y=N("s"),T=I(),M=g("p"),M.textContent=E,A=I(),P&&P.c(),V=I(),F=g("div"),W=g("button"),W.innerHTML=R,D=I(),S=g("button"),S.innerHTML=k,this.h()},l(H){e=p(H,"DIV",{class:!0});var ee=v(e);t=p(ee,"DIV",{class:!0});var re=v(t);r=p(re,"DIV",{class:!0});var Y=v(r);a=p(Y,"DIV",{class:!0,"data-svelte-h":!0}),Z(a)!=="svelte-7jb8d9"&&(a.innerHTML=i),o=x(Y),u=p(Y,"DIV",{});var X=v(u);l=p(X,"H3",{class:!0,"data-svelte-h":!0}),Z(l)!=="svelte-qk9ko5"&&(l.textContent=d),m=x(X),h=p(X,"P",{class:!0});var U=v(h);b=z(U,"Background removed in "),w=z(U,_),y=z(U,"s"),U.forEach(f),T=x(X),M=p(X,"P",{class:!0,"data-svelte-h":!0}),Z(M)!=="svelte-whk9x6"&&(M.textContent=E),A=x(X),P&&P.l(X),X.forEach(f),V=x(Y),F=p(Y,"DIV",{class:!0});var J=v(F);W=p(J,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(W)!=="svelte-ryd2av"&&(W.innerHTML=R),D=x(J),S=p(J,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(S)!=="svelte-178t1yh"&&(S.innerHTML=k),J.forEach(f),Y.forEach(f),re.forEach(f),ee.forEach(f),this.h()},h(){c(a,"class","w-16 h-16 mx-auto rounded-full bg-green-400/20 flex items-center justify-center"),c(l,"class","text-2xl font-semibold text-magic-gradient mb-2"),c(h,"class","text-dark-text-secondary mb-1"),c(M,"class","text-sm text-dark-text-muted mb-2"),c(W,"class","btn btn-magic py-3 px-6 rounded-lg font-medium"),c(S,"class","btn btn-outline border-magic-400 text-magic-400 hover:bg-magic-400 hover:text-white py-3 px-6 rounded-lg font-medium"),c(F,"class","flex flex-col sm:flex-row gap-4 justify-center"),c(r,"class","space-y-6"),c(t,"class","success-card glass-card rounded-xl p-8 text-center magic-reveal svelte-au32od"),c(e,"class","max-w-2xl mx-auto")},m(H,ee){q(H,e,ee),n(e,t),n(t,r),n(r,a),n(r,o),n(r,u),n(u,l),n(u,m),n(u,h),n(h,b),n(h,w),n(h,y),n(u,T),n(u,M),n(u,A),P&&P.m(u,null),n(r,V),n(r,F),n(F,W),n(F,D),n(F,S),L||(B=[ce(W,"click",s[22]),ce(S,"click",s[17])],L=!0)},p(H,ee){var re;ee[0]&2&&_!==(_=((re=H[1].processing_time)==null?void 0:re.toFixed(2))+"")&&de(w,_),H[14].hasProcessedImages?P?P.p(H,ee):(P=Uo(H),P.c(),P.m(u,null)):P&&(P.d(1),P=null)},d(H){H&&f(e),P&&P.d(),L=!1,Qe(B)}}}function Uo(s){let e;function t(i,o){return i[14].meetsTarget?Jl:Kl}let r=t(s),a=r(s);return{c(){e=g("div"),a.c(),this.h()},l(i){e=p(i,"DIV",{class:!0});var o=v(e);a.l(o),o.forEach(f),this.h()},h(){c(e,"class","text-xs text-magic-300")},m(i,o){q(i,e,o),a.m(e,null)},p(i,o){r===(r=t(i))&&a?a.p(i,o):(a.d(1),a=r(i),a&&(a.c(),a.m(e,null)))},d(i){i&&f(e),a.d()}}}function Kl(s){let e,t=(s[14].hasProcessedImages?s[14].hasProcessedImages:0)+"",r,a;return{c(){e=N("📈 Session progress: "),r=N(t),a=N("/2 images")},l(i){e=z(i,"📈 Session progress: "),r=z(i,t),a=z(i,"/2 images")},m(i,o){q(i,e,o),q(i,r,o),q(i,a,o)},p(i,o){o[0]&16384&&t!==(t=(i[14].hasProcessedImages?i[14].hasProcessedImages:0)+"")&&de(r,t)},d(i){i&&(f(e),f(r),f(a))}}}function Jl(s){let e,t=(s[14].hasProcessedImages?s[14].hasProcessedImages:0)+"",r,a;return{c(){e=N("🎯 Session target achieved! ("),r=N(t),a=N(" images processed)")},l(i){e=z(i,"🎯 Session target achieved! ("),r=z(i,t),a=z(i," images processed)")},m(i,o){q(i,e,o),q(i,r,o),q(i,a,o)},p(i,o){o[0]&16384&&t!==(t=(i[14].hasProcessedImages?i[14].hasProcessedImages:0)+"")&&de(r,t)},d(i){i&&(f(e),f(r),f(a))}}}function Ho(s){let e,t,r;return t=new El({props:{error:s[2],context:s[10],showTechnicalDetails:!0,allowRetry:!0,autoHide:s[10].attempt===1}}),t.$on("retry",s[19]),t.$on("dismiss",s[20]),{c(){e=g("div"),ht(t.$$.fragment),this.h()},l(a){e=p(a,"DIV",{class:!0});var i=v(e);vt(t.$$.fragment,i),i.forEach(f),this.h()},h(){c(e,"class","max-w-4xl mx-auto")},m(a,i){q(a,e,i),bt(t,e,null),r=!0},p(a,i){const o={};i[0]&4&&(o.error=a[2]),i[0]&1024&&(o.context=a[10]),i[0]&1024&&(o.autoHide=a[10].attempt===1),t.$set(o)},i(a){r||(Se(t.$$.fragment,a),r=!0)},o(a){Fe(t.$$.fragment,a),r=!1},d(a){a&&f(e),_t(t)}}}function qo(s){let e,t='<div class="container"><div class="text-center mb-12"><h2 class="text-3xl font-bold text-dark-text mb-4">Built for Developer Workflow</h2> <p class="text-lg text-dark-text-secondary max-w-2xl mx-auto">Designed for speed and efficiency. Get back to building faster.</p></div> <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto"><div class="feature-card glass-card rounded-xl p-6 text-center svelte-au32od"><div class="w-12 h-12 mx-auto mb-4 rounded-lg bg-magic-400/20 flex items-center justify-center"><svg class="w-6 h-6 text-magic-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div> <h3 class="text-lg font-semibold text-dark-text mb-2">Lightning Fast</h3> <p class="text-sm text-dark-text-secondary">Average processing under 5 seconds. Keep your momentum going.</p></div> <div class="feature-card glass-card rounded-xl p-6 text-center svelte-au32od"><div class="w-12 h-12 mx-auto mb-4 rounded-lg bg-magic-400/20 flex items-center justify-center"><svg class="w-6 h-6 text-magic-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></div> <h3 class="text-lg font-semibold text-dark-text mb-2">Seamless Paste</h3> <p class="text-sm text-dark-text-secondary">Cmd+V from any AI generator. Results auto-copy to clipboard.</p></div> <div class="feature-card glass-card rounded-xl p-6 text-center svelte-au32od"><div class="w-12 h-12 mx-auto mb-4 rounded-lg bg-magic-400/20 flex items-center justify-center"><svg class="w-6 h-6 text-magic-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg></div> <h3 class="text-lg font-semibold text-dark-text mb-2">Privacy First</h3> <p class="text-sm text-dark-text-secondary">Images auto-delete after 1 hour. No tracking, no accounts needed.</p></div></div></div>';return{c(){e=g("section"),e.innerHTML=t,this.h()},l(r){e=p(r,"SECTION",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-6b4rhs"&&(e.innerHTML=t),this.h()},h(){c(e,"class","features py-16 sm:py-24")},m(r,a){q(r,e,a)},d(r){r&&f(e)}}}function Go(s){let e,t='<svg class="w-5 h-5 text-magic-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10m0 0V6a2 2 0 00-2-2H9a2 2 0 00-2 2v2m0 0v10a2 2 0 002 2h8a2 2 0 002-2V8M9 12h6"></path></svg>',r,a;return{c(){e=g("button"),e.innerHTML=t,this.h()},l(i){e=p(i,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),Z(e)!=="svelte-10pz063"&&(e.innerHTML=t),this.h()},h(){c(e,"class","fixed bottom-6 left-6 bg-magic-400/20 hover:bg-magic-400/30 border border-magic-400/40 rounded-full p-3 transition-all duration-200 z-40"),c(e,"title","Send Feedback")},m(i,o){q(i,e,o),r||(a=ce(e,"click",s[27]),r=!0)},p:Ce,d(i){i&&f(e),r=!1,a()}}}function Ql(s){let e,t,r,a,i=`<div class="container text-center"><div class="mb-8"><h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold mb-4"><span class="text-magic-gradient">Transform Characters</span> <br/> <span class="text-dark-text">with Magic</span></h1> <p class="text-xl sm:text-2xl text-dark-text-secondary max-w-2xl mx-auto leading-relaxed">Watch backgrounds disappear effortlessly. Perfect for 
          <span class="text-magic-400 font-medium">AI-generated character assets</span>.</p></div> <div class="flex items-center justify-center space-x-2 mb-12 text-dark-text-muted"><svg class="w-5 h-5 text-magic-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path></svg> <span class="text-sm">Average processing time: &lt;5 seconds</span></div></div>`,o,u,l,d,m,h,b,_,w,y,T,M,E,A,V,F,W,R=!s[0]&&!s[1]&&jo(s),D=s[0]&&s[8]&&Lo(s),S=s[1]&&s[4]&&s[8]&&No(s),k=s[1]&&s[3]&&zo(s),L=s[2]&&Ho(s),B=!s[0]&&!s[1]&&!s[4]&&qo();y=new Rl({props:{visible:s[11],imagesProcessed:Pe.metrics.images_processed}}),y.$on("submit",s[23]),y.$on("dismiss",s[24]),M=new Ll({props:{visible:s[12],contextData:{images_processed:Pe.metrics.images_processed,successful_completions:Pe.metrics.successful_completions,failed_attempts:Pe.metrics.failed_attempts,processing_time:Pe.metrics.total_processing_time/Math.max(1,Pe.metrics.successful_completions),session_duration:Pe.metrics.session_duration}}}),M.$on("submit",s[25]),M.$on("dismiss",s[26]),A=new Ul({props:{visible:s[13],isDevMode:!0}}),A.$on("close",s[28]);let P=!s[0]&&!s[12]&&Go(s);return{c(){e=g("meta"),t=I(),r=g("div"),a=g("section"),a.innerHTML=i,o=I(),u=g("section"),l=g("div"),R&&R.c(),d=I(),D&&D.c(),m=I(),S&&S.c(),h=I(),k&&k.c(),b=I(),L&&L.c(),_=I(),B&&B.c(),w=I(),ht(y.$$.fragment),T=I(),ht(M.$$.fragment),E=I(),ht(A.$$.fragment),V=I(),P&&P.c(),F=ot(),this.h()},l(C){const H=ln("svelte-thm2db",document.head);e=p(H,"META",{name:!0,content:!0}),H.forEach(f),t=x(C),r=p(C,"DIV",{class:!0});var ee=v(r);a=p(ee,"SECTION",{class:!0,"data-svelte-h":!0}),Z(a)!=="svelte-1h6iamq"&&(a.innerHTML=i),o=x(ee),u=p(ee,"SECTION",{class:!0});var re=v(u);l=p(re,"DIV",{class:!0});var Y=v(l);R&&R.l(Y),d=x(Y),D&&D.l(Y),m=x(Y),S&&S.l(Y),h=x(Y),k&&k.l(Y),b=x(Y),L&&L.l(Y),Y.forEach(f),re.forEach(f),_=x(ee),B&&B.l(ee),ee.forEach(f),w=x(C),vt(y.$$.fragment,C),T=x(C),vt(M.$$.fragment,C),E=x(C),vt(A.$$.fragment,C),V=x(C),P&&P.l(C),F=ot(),this.h()},h(){document.title="CharacterCut - Transform Your Characters with Magic",c(e,"name","description"),c(e,"content","Remove backgrounds from AI-generated characters instantly. Drag, drop, or paste - watch backgrounds disappear like magic."),c(a,"class","hero py-12 sm:py-20 svelte-au32od"),c(l,"class","container"),c(u,"class","interface py-8"),c(r,"class","page-container svelte-au32od")},m(C,H){n(document.head,e),q(C,t,H),q(C,r,H),n(r,a),n(r,o),n(r,u),n(u,l),R&&R.m(l,null),n(l,d),D&&D.m(l,null),n(l,m),S&&S.m(l,null),n(l,h),k&&k.m(l,null),n(l,b),L&&L.m(l,null),n(r,_),B&&B.m(r,null),q(C,w,H),bt(y,C,H),q(C,T,H),bt(M,C,H),q(C,E,H),bt(A,C,H),q(C,V,H),P&&P.m(C,H),q(C,F,H),W=!0},p(C,H){!C[0]&&!C[1]?R?(R.p(C,H),H[0]&3&&Se(R,1)):(R=jo(C),R.c(),Se(R,1),R.m(l,d)):R&&(Er(),Fe(R,1,1,()=>{R=null}),kr()),C[0]&&C[8]?D?(D.p(C,H),H[0]&257&&Se(D,1)):(D=Lo(C),D.c(),Se(D,1),D.m(l,m)):D&&(Er(),Fe(D,1,1,()=>{D=null}),kr()),C[1]&&C[4]&&C[8]?S?(S.p(C,H),H[0]&274&&Se(S,1)):(S=No(C),S.c(),Se(S,1),S.m(l,h)):S&&(Er(),Fe(S,1,1,()=>{S=null}),kr()),C[1]&&C[3]?k?k.p(C,H):(k=zo(C),k.c(),k.m(l,b)):k&&(k.d(1),k=null),C[2]?L?(L.p(C,H),H[0]&4&&Se(L,1)):(L=Ho(C),L.c(),Se(L,1),L.m(l,null)):L&&(Er(),Fe(L,1,1,()=>{L=null}),kr()),!C[0]&&!C[1]&&!C[4]?B||(B=qo(),B.c(),B.m(r,null)):B&&(B.d(1),B=null);const ee={};H[0]&2048&&(ee.visible=C[11]),y.$set(ee);const re={};H[0]&4096&&(re.visible=C[12]),M.$set(re);const Y={};H[0]&8192&&(Y.visible=C[13]),A.$set(Y),!C[0]&&!C[12]?P?P.p(C,H):(P=Go(C),P.c(),P.m(F.parentNode,F)):P&&(P.d(1),P=null)},i(C){W||(Se(R),Se(D),Se(S),Se(L),Se(y.$$.fragment,C),Se(M.$$.fragment,C),Se(A.$$.fragment,C),W=!0)},o(C){Fe(R),Fe(D),Fe(S),Fe(L),Fe(y.$$.fragment,C),Fe(M.$$.fragment,C),Fe(A.$$.fragment,C),W=!1},d(C){C&&(f(t),f(r),f(w),f(T),f(E),f(V),f(F)),f(e),R&&R.d(),D&&D.d(),S&&S.d(),k&&k.d(),L&&L.d(),B&&B.d(),_t(y,C),_t(M,C),_t(A,C),P&&P.d(C)}}}function xr(){return"upload"}function Zl(){console.log("Image copied to clipboard for immediate use")}function Xl(s,e,t){let r,a,i;ze(s,Hl,Q=>t(29,a=Q)),ze(s,cn,Q=>t(30,i=Q));let o=!1,u=null,l=null,d=!1,m=!1,h="",b=0,_=1,w=null,y=null,T={},M=!1,E=!1,A=!1,V=!1;Ut(()=>{Ae.reset(),Pe.trackUniqueUser(),window.addEventListener("keydown",Q=>{Q.ctrlKey&&Q.shiftKey&&Q.key==="A"&&t(13,A=!0)})});async function F(Q){var G;console.log("🔍 FRONTEND DEBUG: handleImageSelected called");const{image:K}=Q.detail;console.log("🔍 File details:",K.file.name,K.file.size,K.file.type),t(8,w=K),t(2,l=null),t(1,u=null),t(3,d=!1),t(4,m=!1),t(5,h=""),t(6,b=0),t(7,_=1),t(9,y=null);try{t(0,o=!0),Ae.setProcessingStatus("processing"),me.startProcessing(),await Pe.trackProcessingStart(K,xr());const O=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;console.log("🔍 FRONTEND DEBUG: About to call processWithRecovery"),console.log("🔍 Session ID:",O);const te=await Oa.processWithRecovery(K.file,O,($,ae,se)=>{console.log("🔍 Progress update:",$,ae,se),t(6,b=$),t(5,h=ae),t(7,_=se||1),Ae.updateProgress($,ae)});if(console.log("🔍 FRONTEND DEBUG: processWithRecovery completed"),console.log("🔍 Recovery result:",te),te.success&&te.result)t(1,u=te.result),t(9,y=te.result.download_url),Ae.completeProcessing(te.result.download_url,te.totalTime),me.completeProcessing("Background removed successfully!"),ps.recordProcessing(K.file.name,te.totalTime,xr(),((G=te.attempts)==null?void 0:G.length)||0),t(4,m=!0),await Pe.trackTaskCompletion(!0,te.totalTime),await Pe.trackSessionContinuity(),await R(te.result.download_url);else throw new Error(te.error||"Processing failed after all recovery attempts")}catch(O){console.log("🔍 FRONTEND DEBUG: Caught error in handleImageSelected"),console.log("🔍 Error object:",O),console.log("🔍 Error type:",typeof O),console.log("🔍 Error instanceof Error:",O instanceof Error),O instanceof Error&&(console.log("🔍 Error message:",O.message),console.log("🔍 Error stack:",O.stack));const te=O instanceof Error?O.message:"Processing failed";console.log("🔍 Final error message set to:",te),t(2,l=te),t(10,T={fileSize:K.file.size,fileName:K.file.name,attempt:_,userAgent:navigator.userAgent}),Ae.setError(te),me.errorProcessing(te),await Pe.trackTaskCompletion(!1,0,te),ps.recordFailure(K.file.name,xr(),_)}finally{t(0,o=!1)}}function W(Q){t(2,l=Q.detail.message),t(10,T={userAgent:navigator.userAgent,attempt:1}),Ae.setProcessingStatus("error")}async function R(Q){try{const K=await fetch(Q);if(!K.ok)throw new Error("Failed to fetch processed image");const G=await K.blob();await Na.copyImage(G)?(Zl(),console.log("Image automatically copied to clipboard for immediate use")):console.warn("Clipboard copy failed, download option available")}catch(K){console.warn("Failed to copy to clipboard:",K)}}async function D(){await Pe.trackProcessAnother(),Ae.resetProcessing(),me.processAnother(),ps.processAnother(),t(2,l=null),t(1,u=null),t(3,d=!1),t(4,m=!1),t(0,o=!1),t(5,h=""),t(6,b=0),t(7,_=1),t(8,w=null),t(9,y=null),t(10,T={})}function S(Q){const{action:K}=Q.detail;K==="download"?P():K==="continue"&&D()}async function k(){var Q;if(w){t(2,l=null);const K=l;t(10,T={});try{t(0,o=!0),Ae.setProcessingStatus("processing"),me.startProcessing();const G=`retry_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;let O;if(K?O=await Oa.retryWithErrorClassification(w.file,G,K,(te,$)=>{t(6,b=te),t(5,h=$),Ae.updateProgress(te,$)}):O=await Oa.processWithRecovery(w.file,G,(te,$,ae)=>{t(6,b=te),t(5,h=$),t(7,_=ae||1),Ae.updateProgress(te,$)}),O.success&&O.result)t(1,u=O.result),t(9,y=O.result.download_url),Ae.completeProcessing(O.result.download_url,O.totalTime),me.completeProcessing("Background removed successfully!"),ps.recordProcessing(w.file.name,O.totalTime,xr(),((Q=O.attempts)==null?void 0:Q.length)||0),t(4,m=!0),await R(O.result.download_url);else throw new Error(O.error||"Retry failed after all recovery attempts")}catch(G){const O=G instanceof Error?G.message:"Retry failed";t(2,l=O),t(10,T={fileSize:w.file.size,fileName:w.file.name,attempt:_+1,userAgent:navigator.userAgent,isRetry:!0}),Ae.setError(O),me.errorProcessing(O)}finally{t(0,o=!1)}}else t(2,l=null),t(10,T={})}function L(){t(2,l=null),t(10,T={})}function B(){t(3,d=!0),t(4,m=!1)}async function P(){if(u!=null&&u.download_url)try{if(!await fl.downloadImage(u.download_url,{format:"png"},{processingId:u.processing_id,processingTime:u.processing_time,timestamp:new Date().toISOString(),format:"png"}))throw new Error("Download service failed");await Pe.trackDownload("png")}catch(Q){t(2,l="Download failed. Please try again."),console.error("Download error:",Q)}}function C(Q){const{score:K,feedback:G}=Q.detail;console.log("NPS submitted:",{score:K,feedback:G}),t(11,M=!1)}function H(){t(11,M=!1)}function ee(Q){const{type:K,content:G,email:O}=Q.detail;console.log("Feedback submitted:",{type:K,content:G,email:O}),t(12,E=!1)}function re(){t(12,E=!1)}function Y(){t(12,E=!0)}function X(){t(13,A=!1)}const U=()=>{console.log("Scanline animation completed")},J=()=>{console.log("Scanline processing phase completed")};return s.$$.update=()=>{s.$$.dirty[0]&1073741824&&i.currentImage,s.$$.dirty[0]&1073741824&&i.processingState.status,s.$$.dirty[0]&536870912&&t(14,r=a)},[o,u,l,d,m,h,b,_,w,y,T,M,E,A,r,F,W,D,S,k,L,B,P,C,H,ee,re,Y,X,a,i,U,J]}class ac extends lt{constructor(e){super(),ct(this,e,Xl,Ql,nt,{},null,[-1,-1])}}export{ac as component};
