import{w as o,d as l}from"./index.675a9ea6.js";const f=o(p()),i=o({imagesProcessed:0,startTime:new Date,lastActivity:new Date}),r=o({status:"idle",progress:0,message:"",processingId:null,error:null}),n=o(null),a=o(null),u=o(!1),g=o(!1),d=o(!1);l([i,r],([e,s])=>({shouldShowProcessAnother:e.imagesProcessed>0&&s.status==="completed",meetsTarget:e.imagesProcessed>=2,sessionDuration:Date.now()-e.startTime.getTime()}));l([r,i],([e,s])=>({isUnder5Seconds:e.processingTime?e.processingTime<5e3:null,averageProcessingTime:s.totalProcessingTime?s.totalProcessingTime/s.imagesProcessed:null,successRate:s.imagesProcessed>0?(s.successfulProcesses||0)/s.imagesProcessed:null}));const S=l([r,n,a,g,d],([e,s,t,m,P])=>({processingState:e,currentImage:s,processedImage:t,isDropzoneActive:m,clipboardSupported:P})),c={updateSessionActivity(){i.update(e=>({...e,lastActivity:new Date}))},incrementImagesProcessed(e,s=!0){i.update(t=>({...t,imagesProcessed:t.imagesProcessed+1,totalProcessingTime:(t.totalProcessingTime||0)+e,successfulProcesses:s?(t.successfulProcesses||0)+1:t.successfulProcesses||0,lastActivity:new Date}))},setProcessingState(e){r.update(s=>({...s,...e}))},setProcessingStatus(e){r.update(s=>({...s,status:e}))},reset(){c.resetProcessing(),f.set(p())},startProcessing(e){r.set({status:"processing",progress:0,message:"Initializing background removal...",processingId:e,error:null,startTime:Date.now()})},updateProgress(e,s){r.update(t=>({...t,progress:e,message:s}))},completeProcessing(e,s){r.update(t=>({...t,status:"completed",progress:100,message:"Processing complete!",downloadUrl:e,processingTime:s})),c.incrementImagesProcessed(s,!0)},setError(e){r.update(s=>({...s,status:"error",error:e,message:"Processing failed"})),c.incrementImagesProcessed(0,!1)},resetProcessing(){r.set({status:"idle",progress:0,message:"",processingId:null,error:null}),n.set(null),a.set(null),u.set(!1)},setCurrentImage(e){n.set(e),c.updateSessionActivity()},setProcessedImage(e){a.set(e)},setDropzoneActive(e){g.set(e)},setClipboardSupported(e){d.set(e)},togglePreview(){u.update(e=>!e)}};function p(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function v(){return!!(navigator.clipboard&&navigator.clipboard.read)}typeof window<"u"&&c.setClipboardSupported(v());export{c as a,S as b};
